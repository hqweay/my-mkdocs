<!doctype html><html lang=zh class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=description content="Thinking Drafts"><link href=https://wiki.leay.net/book/OnJava8/docs/book/13-Functional-Programming/ rel=canonical><meta name=author content=hqweay><meta name=lang:clipboard.copy content=复制><meta name=lang:clipboard.copied content=已复制><meta name=lang:search.language content="en, ja"><meta name=lang:search.pipeline.stopwords content=True><meta name=lang:search.pipeline.trimmer content=True><meta name=lang:search.result.none content=没有找到符合条件的结果><meta name=lang:search.result.one content="找到 1 个符合条件的结果"><meta name=lang:search.result.other content="# 个符合条件的结果"><meta name=lang:search.tokenizer content=[\uff0c\u3002]+><link rel="shortcut icon" href=../../../../../img/favicon.ico><meta name=generator content="mkdocs-1.1, mkdocs-material-4.6.3"><title>13 Functional Programming - Hqweay's Wiki</title><link rel=stylesheet href=../../../../../assets/stylesheets/application.adb8469c.css><link rel=stylesheet href=../../../../../assets/stylesheets/application-palette.a8b3c06d.css><meta name=theme-color content=#3f51b5><script src=../../../../../assets/javascripts/modernizr.86422ebf.js></script><link href=https://fonts.gstatic.com rel=preconnect crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Noto+Serif+SC:300,400,400i,700%7CRoboto+Mono&display=fallback"><style>body,input{font-family:"Noto Serif SC","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style><link rel=stylesheet href=../../../../../assets/fonts/material-icons.css><script>
  window.ga = window.ga || function() {
    (ga.q = ga.q || []).push(arguments)
  }
  ga.l = +new Date
  /* Setup integration and send page view */
  ga("create", "UA-105976066-3", "wiki.leay.net")
  ga("set", "anonymizeIp", true)
  ga("send", "pageview")
  /* Register handler to log search on blur */
  document.addEventListener("DOMContentLoaded", () => {
    if (document.forms.search) {
      var query = document.forms.search.query
      query.addEventListener("blur", function() {
        if (this.value) {
          var path = document.location.pathname;
          ga("send", "pageview", path + "?q=" + this.value)
        }
      })
    }
  })
</script><script async src=https://www.google-analytics.com/analytics.js></script></head> <body dir=ltr data-md-color-primary=indigo data-md-color-accent=indigo> <svg class=md-svg> <defs> <svg xmlns=http://www.w3.org/2000/svg width=416 height=448 viewbox="0 0 416 448" id=__github><path fill=currentColor d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg> </defs> </svg> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay data-md-component=overlay for=__drawer></label> <a href=#_1 tabindex=0 class=md-skip> 跳转至 </a> <header class=md-header data-md-component=header> <nav class="md-header-nav md-grid"> <div class=md-flex> <div class="md-flex__cell md-flex__cell--shrink"> <a href=https://wiki.leay.net/ title="Hqweay's Wiki" aria-label="Hqweay's Wiki" class="md-header-nav__button md-logo"> <i class=md-icon></i> </a> </div> <div class="md-flex__cell md-flex__cell--shrink"> <label class="md-icon md-icon--menu md-header-nav__button" for=__drawer></label> </div> <div class="md-flex__cell md-flex__cell--stretch"> <div class="md-flex__ellipsis md-header-nav__title" data-md-component=title> <span class=md-header-nav__topic> Hqweay's Wiki </span> <span class=md-header-nav__topic> 13 Functional Programming </span> </div> </div> <div class="md-flex__cell md-flex__cell--shrink"> <label class="md-icon md-icon--search md-header-nav__button" for=__search></label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input aria-label=search name=query placeholder=搜索 autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=query data-md-state=active> <label class="md-icon md-search__icon" for=__search></label> <button type=reset class="md-icon md-search__icon" data-md-component=reset tabindex=-1> &#xE5CD; </button> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=result> <div class=md-search-result__meta> 键入以开始搜索 </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> </div> <div class="md-flex__cell md-flex__cell--shrink"> <div class=md-header-nav__source> <a href=https://github.com/hqweay/my-mkdocs/ title="前往 Github 仓库" class=md-source data-md-source=github> <div class=md-source__icon> <svg viewbox="0 0 24 24" width=24 height=24> <use xlink:href=#__github width=24 height=24></use> </svg> </div> <div class=md-source__repository> hqweay/my-mkdocs </div> </a> </div> </div> </div> </nav> </header> <div class=md-container> <nav class="md-tabs md-tabs--active" data-md-component=tabs> <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../../../../.. class=md-tabs__link> About </a> </li> <li class=md-tabs__item> <a href=../../../ class="md-tabs__link md-tabs__link--active"> Book </a> </li> <li class=md-tabs__item> <a href=../../../../../doc/ class=md-tabs__link> Doc </a> </li> <li class=md-tabs__item> <a href=../../../../../life/reading/ class=md-tabs__link> Life </a> </li> <li class=md-tabs__item> <a href=../../../../../study/draft/try-wiki/ class=md-tabs__link> Study </a> </li> <li class=md-tabs__item> <a href=../../../../../tech/code/frontend/2017-09-14-easy-web-test/ class=md-tabs__link> Tech </a> </li> </ul> </div> </nav> <main class=md-main role=main> <div class="md-main__inner md-grid" data-md-component=container> <div class="md-sidebar md-sidebar--primary" data-md-component=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" data-md-level=0> <label class="md-nav__title md-nav__title--site" for=__drawer> <a href=https://wiki.leay.net/ title="Hqweay's Wiki" class="md-nav__button md-logo"> <i class=md-icon></i> </a> Hqweay's Wiki </label> <div class=md-nav__source> <a href=https://github.com/hqweay/my-mkdocs/ title="前往 Github 仓库" class=md-source data-md-source=github> <div class=md-source__icon> <svg viewbox="0 0 24 24" width=24 height=24> <use xlink:href=#__github width=24 height=24></use> </svg> </div> <div class=md-source__repository> hqweay/my-mkdocs </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../.. title=About class=md-nav__link> About </a> </li> <li class=md-nav__item> <a href=../../../../../test/ title=特殊语法 class=md-nav__link> 特殊语法 </a> </li> <li class=md-nav__item> <a href=../../../../../web-page/ title=静态文档导航 class=md-nav__link> 静态文档导航 </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-4 type=checkbox id=nav-4 checked> <label class=md-nav__link for=nav-4> Book </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-4> Book </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-4-1 type=checkbox id=nav-4-1 checked> <label class=md-nav__link for=nav-4-1> OnJava8 </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-4-1> OnJava8 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../ title="《On Java 8》中文版" class=md-nav__link> 《On Java 8》中文版 </a> </li> <li class=md-nav__item> <a href=../../../CONTRIBUTING/ title=CONTRIBUTING class=md-nav__link> CONTRIBUTING </a> </li> <li class=md-nav__item> <a href=../../../SUMMARY/ title=Summary class=md-nav__link> Summary </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-4-1-4 type=checkbox id=nav-4-1-4 checked> <label class=md-nav__link for=nav-4-1-4> Docs </label> <nav class=md-nav data-md-component=collapsible data-md-level=3> <label class=md-nav__title for=nav-4-1-4> Docs </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../ title=译者的话 class=md-nav__link> 译者的话 </a> </li> <li class=md-nav__item> <a href=../../_coverpage/ title=coverpage class=md-nav__link> coverpage </a> </li> <li class=md-nav__item> <a href=../../sidebar/ title=Sidebar class=md-nav__link> Sidebar </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-4-1-4-4 type=checkbox id=nav-4-1-4-4> <label class=md-nav__link for=nav-4-1-4-4> style </label> <nav class=md-nav data-md-component=collapsible data-md-level=4> <label class=md-nav__title for=nav-4-1-4-4> style </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-4-1-4-4-1 type=checkbox id=nav-4-1-4-4-1> <label class=md-nav__link for=nav-4-1-4-4-1> Prism master </label> <nav class=md-nav data-md-component=collapsible data-md-level=5> <label class=md-nav__title for=nav-4-1-4-4-1> Prism master </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../_style/prism-master/ title=[Prism](http://prismjs.com/) class=md-nav__link> [Prism](http://prismjs.com/) </a> </li> <li class=md-nav__item> <a href=../../_style/prism-master/CHANGELOG/ title="Prism Changelog" class=md-nav__link> Prism Changelog </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-4-1-4-5 type=checkbox id=nav-4-1-4-5 checked> <label class=md-nav__link for=nav-4-1-4-5> Book </label> <nav class=md-nav data-md-component=collapsible data-md-level=4> <label class=md-nav__title for=nav-4-1-4-5> Book </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../00-Introduction/ title=简介 class=md-nav__link> 简介 </a> </li> <li class=md-nav__item> <a href=../00-On-Java-8/ title="00 On Java 8" class=md-nav__link> 00 On Java 8 </a> </li> <li class=md-nav__item> <a href=../00-Preface/ title=前言 class=md-nav__link> 前言 </a> </li> <li class=md-nav__item> <a href=../01-What-is-an-Object/ title="第一章 对象的概念" class=md-nav__link> 第一章 对象的概念 </a> </li> <li class=md-nav__item> <a href=../02-Installing-Java-and-the-Book-Examples/ title="02 Installing Java and the Book Examples" class=md-nav__link> 02 Installing Java and the Book Examples </a> </li> <li class=md-nav__item> <a href=../03-Objects-Everywhere/ title="03 Objects Everywhere" class=md-nav__link> 03 Objects Everywhere </a> </li> <li class=md-nav__item> <a href=../04-Operators/ title="04 Operators" class=md-nav__link> 04 Operators </a> </li> <li class=md-nav__item> <a href=../05-Control-Flow/ title="05 Control Flow" class=md-nav__link> 05 Control Flow </a> </li> <li class=md-nav__item> <a href=../06-Housekeeping/ title="06 Housekeeping" class=md-nav__link> 06 Housekeeping </a> </li> <li class=md-nav__item> <a href=../07-Implementation-Hiding/ title="07 Implementation Hiding" class=md-nav__link> 07 Implementation Hiding </a> </li> <li class=md-nav__item> <a href=../08-Reuse/ title="08 Reuse" class=md-nav__link> 08 Reuse </a> </li> <li class=md-nav__item> <a href=../09-Polymorphism/ title="09 Polymorphism" class=md-nav__link> 09 Polymorphism </a> </li> <li class=md-nav__item> <a href=../10-Interfaces/ title="10 Interfaces" class=md-nav__link> 10 Interfaces </a> </li> <li class=md-nav__item> <a href=../11-Inner-Classes/ title="11 Inner Classes" class=md-nav__link> 11 Inner Classes </a> </li> <li class=md-nav__item> <a href=../12-Collections/ title="12 Collections" class=md-nav__link> 12 Collections </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-toggle md-nav__toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> 13 Functional Programming </label> <a href=./ title="13 Functional Programming" class="md-nav__link md-nav__link--active"> 13 Functional Programming </a> <nav class="md-nav md-nav--secondary"> <label class=md-nav__title for=__toc>目录</label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=#_2 class=md-nav__link> 新旧对比 </a> </li> <li class=md-nav__item> <a href=#lambda class=md-nav__link> Lambda表达式 </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_3 class=md-nav__link> 递归 </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_4 class=md-nav__link> 方法引用 </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#runnable class=md-nav__link> Runnable接口 </a> </li> <li class=md-nav__item> <a href=#_5 class=md-nav__link> 未绑定的方法引用 </a> </li> <li class=md-nav__item> <a href=#_6 class=md-nav__link> 构造函数引用 </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_7 class=md-nav__link> 函数式接口 </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_8 class=md-nav__link> 多参数函数式接口 </a> </li> <li class=md-nav__item> <a href=#_9 class=md-nav__link> 缺少基本类型的函数 </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_10 class=md-nav__link> 高阶函数 </a> </li> <li class=md-nav__item> <a href=#_11 class=md-nav__link> 闭包 </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_12 class=md-nav__link> 作为闭包的内部类 </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_13 class=md-nav__link> 函数组合 </a> </li> <li class=md-nav__item> <a href=#_14 class=md-nav__link> 柯里化和部分求值 </a> </li> <li class=md-nav__item> <a href=#_15 class=md-nav__link> 纯函数式编程 </a> </li> <li class=md-nav__item> <a href=#_16 class=md-nav__link> 本章小结 </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../14-Streams/ title="14 Streams" class=md-nav__link> 14 Streams </a> </li> <li class=md-nav__item> <a href=../15-Exceptions/ title="15 Exceptions" class=md-nav__link> 15 Exceptions </a> </li> <li class=md-nav__item> <a href=../16-Validating-Your-Code/ title="16 Validating Your Code" class=md-nav__link> 16 Validating Your Code </a> </li> <li class=md-nav__item> <a href=../17-Files/ title="17 Files" class=md-nav__link> 17 Files </a> </li> <li class=md-nav__item> <a href=../18-Strings/ title="18 Strings" class=md-nav__link> 18 Strings </a> </li> <li class=md-nav__item> <a href=../19-Type-Information/ title="19 Type Information" class=md-nav__link> 19 Type Information </a> </li> <li class=md-nav__item> <a href=../20-Generics/ title="20 Generics" class=md-nav__link> 20 Generics </a> </li> <li class=md-nav__item> <a href=../21-Arrays/ title="21 Arrays" class=md-nav__link> 21 Arrays </a> </li> <li class=md-nav__item> <a href=../22-Enumerations/ title="22 Enumerations" class=md-nav__link> 22 Enumerations </a> </li> <li class=md-nav__item> <a href=../23-Annotations/ title="23 Annotations" class=md-nav__link> 23 Annotations </a> </li> <li class=md-nav__item> <a href=../24-Concurrent-Programming/ title="24 Concurrent Programming" class=md-nav__link> 24 Concurrent Programming </a> </li> <li class=md-nav__item> <a href=../25-Patterns/ title="25 Patterns" class=md-nav__link> 25 Patterns </a> </li> <li class=md-nav__item> <a href=../Appendix-Becoming-a-Programmer/ title="Appendix Becoming a Programmer" class=md-nav__link> Appendix Becoming a Programmer </a> </li> <li class=md-nav__item> <a href=../Appendix-Benefits-and-Costs-of-Static-Type-Checking/ title="Appendix Benefits and Costs of Static Type Checking" class=md-nav__link> Appendix Benefits and Costs of Static Type Checking </a> </li> <li class=md-nav__item> <a href=../Appendix-Collection-Topics/ title="Appendix Collection Topics" class=md-nav__link> Appendix Collection Topics </a> </li> <li class=md-nav__item> <a href=../Appendix-Data-Compression/ title="Appendix Data Compression" class=md-nav__link> Appendix Data Compression </a> </li> <li class=md-nav__item> <a href=../Appendix-IO-Streams/ title="Appendix IO Streams" class=md-nav__link> Appendix IO Streams </a> </li> <li class=md-nav__item> <a href=../Appendix-Javadoc/ title="Appendix Javadoc" class=md-nav__link> Appendix Javadoc </a> </li> <li class=md-nav__item> <a href=../Appendix-Low-Level-Concurrency/ title="Appendix Low Level Concurrency" class=md-nav__link> Appendix Low Level Concurrency </a> </li> <li class=md-nav__item> <a href=../Appendix-New-IO/ title="Appendix New IO" class=md-nav__link> Appendix New IO </a> </li> <li class=md-nav__item> <a href=../Appendix-Object-Serialization/ title="Appendix Object Serialization" class=md-nav__link> Appendix Object Serialization </a> </li> <li class=md-nav__item> <a href=../Appendix-Passing-and-Returning-Objects/ title="Appendix Passing and Returning Objects" class=md-nav__link> Appendix Passing and Returning Objects </a> </li> <li class=md-nav__item> <a href=../Appendix-Programming-Guidelines/ title="Appendix Programming Guidelines" class=md-nav__link> Appendix Programming Guidelines </a> </li> <li class=md-nav__item> <a href=../Appendix-Standard-IO/ title="Appendix Standard IO" class=md-nav__link> Appendix Standard IO </a> </li> <li class=md-nav__item> <a href=../Appendix-Supplements/ title="Appendix Supplements" class=md-nav__link> Appendix Supplements </a> </li> <li class=md-nav__item> <a href=../Appendix-The-Positive-Legacy-of-C-plus-plus-and-Java/ title="Appendix The Positive Legacy of C plus plus and Java" class=md-nav__link> Appendix The Positive Legacy of C plus plus and Java </a> </li> <li class=md-nav__item> <a href=../Appendix-Understanding-equals-and-hashCode/ title="Appendix Understanding equals and hashCode" class=md-nav__link> Appendix Understanding equals and hashCode </a> </li> <li class=md-nav__item> <a href=../GLOSSARY/ title=GLOSSARY class=md-nav__link> GLOSSARY </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-5 type=checkbox id=nav-5> <label class=md-nav__link for=nav-5> Doc </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-5> Doc </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../doc/ title=About class=md-nav__link> About </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-5-2 type=checkbox id=nav-5-2> <label class=md-nav__link for=nav-5-2> English </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-5-2> English </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-5-2-1 type=checkbox id=nav-5-2-1> <label class=md-nav__link for=nav-5-2-1> A Programmers Guide to English </label> <nav class=md-nav data-md-component=collapsible data-md-level=3> <label class=md-nav__title for=nav-5-2-1> A Programmers Guide to English </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../doc/english/A-Programmers-Guide-to-English/ title="A Programmer's Guide to English" class=md-nav__link> A Programmer's Guide to English </a> </li> <li class=md-nav__item> <a href=../../../../../doc/english/A-Programmers-Guide-to-English/SUMMARY/ title=Summary class=md-nav__link> Summary </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-5-2-1-3 type=checkbox id=nav-5-2-1-3> <label class=md-nav__link for=nav-5-2-1-3> Essence </label> <nav class=md-nav data-md-component=collapsible data-md-level=4> <label class=md-nav__title for=nav-5-2-1-3> Essence </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../doc/english/A-Programmers-Guide-to-English/essence/ title=语言学习的本质浅析 class=md-nav__link> 语言学习的本质浅析 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-5-2-1-4 type=checkbox id=nav-5-2-1-4> <label class=md-nav__link for=nav-5-2-1-4> Make a program </label> <nav class=md-nav data-md-component=collapsible data-md-level=4> <label class=md-nav__title for=nav-5-2-1-4> Make a program </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../doc/english/A-Programmers-Guide-to-English/make-a-program/ title=如何构建一个识别英语的程序 class=md-nav__link> 如何构建一个识别英语的程序 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-5-2-1-5 type=checkbox id=nav-5-2-1-5> <label class=md-nav__link for=nav-5-2-1-5> Qa </label> <nav class=md-nav data-md-component=collapsible data-md-level=4> <label class=md-nav__title for=nav-5-2-1-5> Qa </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../doc/english/A-Programmers-Guide-to-English/qa/ title="常见问题 QA" class=md-nav__link> 常见问题 QA </a> </li> <li class=md-nav__item> <a href=../../../../../doc/english/A-Programmers-Guide-to-English/qa/WhyPTE/ title="为什么我选择 PTE 考试" class=md-nav__link> 为什么我选择 PTE 考试 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-5-2-1-6 type=checkbox id=nav-5-2-1-6> <label class=md-nav__link for=nav-5-2-1-6> Resources </label> <nav class=md-nav data-md-component=collapsible data-md-level=4> <label class=md-nav__title for=nav-5-2-1-6> Resources </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../doc/english/A-Programmers-Guide-to-English/resources/ title=资料、工具推荐和扩展阅读 class=md-nav__link> 资料、工具推荐和扩展阅读 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-5-2-1-7 type=checkbox id=nav-5-2-1-7> <label class=md-nav__link for=nav-5-2-1-7> Training </label> <nav class=md-nav data-md-component=collapsible data-md-level=4> <label class=md-nav__title for=nav-5-2-1-7> Training </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../doc/english/A-Programmers-Guide-to-English/training/ title=我的训练方法 class=md-nav__link> 我的训练方法 </a> </li> <li class=md-nav__item> <a href=../../../../../doc/english/A-Programmers-Guide-to-English/training/KnowledgeBase/ title=扩充语料库的训练方法 class=md-nav__link> 扩充语料库的训练方法 </a> </li> <li class=md-nav__item> <a href=../../../../../doc/english/A-Programmers-Guide-to-English/training/ListeningandSpeaking/ title=发音和听力训练方法 class=md-nav__link> 发音和听力训练方法 </a> </li> <li class=md-nav__item> <a href=../../../../../doc/english/A-Programmers-Guide-to-English/training/Thinking/ title=英语思维训练 class=md-nav__link> 英语思维训练 </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-5-2-2 type=checkbox id=nav-5-2-2> <label class=md-nav__link for=nav-5-2-2> English level up tips for Chinese </label> <nav class=md-nav data-md-component=collapsible data-md-level=3> <label class=md-nav__title for=nav-5-2-2> English level up tips for Chinese </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../doc/english/English-level-up-tips-for-Chinese/ title=English-level-up-tips-for-Chinese class=md-nav__link> English-level-up-tips-for-Chinese </a> </li> <li class=md-nav__item> <a href=../../../../../doc/english/English-level-up-tips-for-Chinese/SUMMARY/ title=Summary class=md-nav__link> Summary </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-5-2-2-3 type=checkbox id=nav-5-2-2-3> <label class=md-nav__link for=nav-5-2-2-3> Part 1 </label> <nav class=md-nav data-md-component=collapsible data-md-level=4> <label class=md-nav__title for=nav-5-2-2-3> Part 1 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../doc/english/English-level-up-tips-for-Chinese/part-1/1-understanding/ title=认知篇 class=md-nav__link> 认知篇 </a> </li> <li class=md-nav__item> <a href=../../../../../doc/english/English-level-up-tips-for-Chinese/part-1/2-vocabulary/ title=单词篇 class=md-nav__link> 单词篇 </a> </li> <li class=md-nav__item> <a href=../../../../../doc/english/English-level-up-tips-for-Chinese/part-1/3-listening/ title=听力篇 class=md-nav__link> 听力篇 </a> </li> <li class=md-nav__item> <a href=../../../../../doc/english/English-level-up-tips-for-Chinese/part-1/4-reading/ title=阅读篇 class=md-nav__link> 阅读篇 </a> </li> <li class=md-nav__item> <a href=../../../../../doc/english/English-level-up-tips-for-Chinese/part-1/5-speaking/ title="5 speaking" class=md-nav__link> 5 speaking </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-5-2-2-4 type=checkbox id=nav-5-2-2-4> <label class=md-nav__link for=nav-5-2-2-4> Part 2 </label> <nav class=md-nav data-md-component=collapsible data-md-level=4> <label class=md-nav__title for=nav-5-2-2-4> Part 2 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../doc/english/English-level-up-tips-for-Chinese/part-2/x-misc/ title=扯淡篇 class=md-nav__link> 扯淡篇 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-5-2-2-5 type=checkbox id=nav-5-2-2-5> <label class=md-nav__link for=nav-5-2-2-5> Word list </label> <nav class=md-nav data-md-component=collapsible data-md-level=4> <label class=md-nav__title for=nav-5-2-2-5> Word list </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../doc/english/English-level-up-tips-for-Chinese/word-list/Go/ title=Go class=md-nav__link> Go </a> </li> <li class=md-nav__item> <a href=../../../../../doc/english/English-level-up-tips-for-Chinese/word-list/Java/ title=Java class=md-nav__link> Java </a> </li> <li class=md-nav__item> <a href=../../../../../doc/english/English-level-up-tips-for-Chinese/word-list/JavaScript/ title=JavaScript class=md-nav__link> JavaScript </a> </li> <li class=md-nav__item> <a href=../../../../../doc/english/English-level-up-tips-for-Chinese/word-list/PHP/ title=PHP class=md-nav__link> PHP </a> </li> <li class=md-nav__item> <a href=../../../../../doc/english/English-level-up-tips-for-Chinese/word-list/Python/ title=Python class=md-nav__link> Python </a> </li> <li class=md-nav__item> <a href=../../../../../doc/english/English-level-up-tips-for-Chinese/word-list/Swift/ title=Swift class=md-nav__link> Swift </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-5-2-3 type=checkbox id=nav-5-2-3> <label class=md-nav__link for=nav-5-2-3> Everyone can use english </label> <nav class=md-nav data-md-component=collapsible data-md-level=3> <label class=md-nav__title for=nav-5-2-3> Everyone can use english </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../doc/english/everyone-can-use-english/ title=人人都能用英语 class=md-nav__link> 人人都能用英语 </a> </li> <li class=md-nav__item> <a href=../../../../../doc/english/everyone-can-use-english/chapter1/ title="第一章 起点" class=md-nav__link> 第一章 起点 </a> </li> <li class=md-nav__item> <a href=../../../../../doc/english/everyone-can-use-english/chapter2/ title="第二章 口语" class=md-nav__link> 第二章 口语 </a> </li> <li class=md-nav__item> <a href=../../../../../doc/english/everyone-can-use-english/chapter3/ title="第三章 语音" class=md-nav__link> 第三章 语音 </a> </li> <li class=md-nav__item> <a href=../../../../../doc/english/everyone-can-use-english/chapter4/ title="第四章 朗读" class=md-nav__link> 第四章 朗读 </a> </li> <li class=md-nav__item> <a href=../../../../../doc/english/everyone-can-use-english/chapter5/ title="第五章 词典" class=md-nav__link> 第五章 词典 </a> </li> <li class=md-nav__item> <a href=../../../../../doc/english/everyone-can-use-english/chapter6/ title="第六章 语法" class=md-nav__link> 第六章 语法 </a> </li> <li class=md-nav__item> <a href=../../../../../doc/english/everyone-can-use-english/chapter7/ title="第七章 精读" class=md-nav__link> 第七章 精读 </a> </li> <li class=md-nav__item> <a href=../../../../../doc/english/everyone-can-use-english/chapter8/ title="第八章 叮嘱" class=md-nav__link> 第八章 叮嘱 </a> </li> <li class=md-nav__item> <a href=../../../../../doc/english/everyone-can-use-english/end/ title=后记 class=md-nav__link> 后记 </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-5-3 type=checkbox id=nav-5-3> <label class=md-nav__link for=nav-5-3> Writing </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-5-3> Writing </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-5-3-1 type=checkbox id=nav-5-3-1> <label class=md-nav__link for=nav-5-3-1> Chinese copywriting guidelines </label> <nav class=md-nav data-md-component=collapsible data-md-level=3> <label class=md-nav__title for=nav-5-3-1> Chinese copywriting guidelines </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../doc/writing/chinese-copywriting-guidelines/ title=中文文案排版指北 class=md-nav__link> 中文文案排版指北 </a> </li> <li class=md-nav__item> <a href=../../../../../doc/writing/chinese-copywriting-guidelines/CHANGELOG/ title=CHANGELOG class=md-nav__link> CHANGELOG </a> </li> <li class=md-nav__item> <a href=../../../../../doc/writing/chinese-copywriting-guidelines/README.en-US/ title="Chinese Copywriting Guidelines" class=md-nav__link> Chinese Copywriting Guidelines </a> </li> <li class=md-nav__item> <a href=../../../../../doc/writing/chinese-copywriting-guidelines/README.zh-CN/ title=中文文案排版指北 class=md-nav__link> 中文文案排版指北 </a> </li> <li class=md-nav__item> <a href=../../../../../doc/writing/chinese-copywriting-guidelines/README.zh-HK/ title=中文文案排版指北 class=md-nav__link> 中文文案排版指北 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-5-3-2 type=checkbox id=nav-5-3-2> <label class=md-nav__link for=nav-5-3-2> Document style guide </label> <nav class=md-nav data-md-component=collapsible data-md-level=3> <label class=md-nav__title for=nav-5-3-2> Document style guide </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../doc/writing/document-style-guide/ title=Index class=md-nav__link> Index </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-5-3-2-2 type=checkbox id=nav-5-3-2-2> <label class=md-nav__link for=nav-5-3-2-2> Docs </label> <nav class=md-nav data-md-component=collapsible data-md-level=4> <label class=md-nav__title for=nav-5-3-2-2> Docs </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../doc/writing/document-style-guide/docs/marks/ title=标点符号 class=md-nav__link> 标点符号 </a> </li> <li class=md-nav__item> <a href=../../../../../doc/writing/document-style-guide/docs/number/ title=数值 class=md-nav__link> 数值 </a> </li> <li class=md-nav__item> <a href=../../../../../doc/writing/document-style-guide/docs/paragraph/ title=段落 class=md-nav__link> 段落 </a> </li> <li class=md-nav__item> <a href=../../../../../doc/writing/document-style-guide/docs/reference/ title=参考链接 class=md-nav__link> 参考链接 </a> </li> <li class=md-nav__item> <a href=../../../../../doc/writing/document-style-guide/docs/structure/ title=文档体系 class=md-nav__link> 文档体系 </a> </li> <li class=md-nav__item> <a href=../../../../../doc/writing/document-style-guide/docs/text/ title=文本 class=md-nav__link> 文本 </a> </li> <li class=md-nav__item> <a href=../../../../../doc/writing/document-style-guide/docs/title/ title=标题 class=md-nav__link> 标题 </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-6 type=checkbox id=nav-6> <label class=md-nav__link for=nav-6> Life </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-6> Life </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-6-1 type=checkbox id=nav-6-1> <label class=md-nav__link for=nav-6-1> Reading </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-6-1> Reading </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../life/reading/ title=阅读 class=md-nav__link> 阅读 </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-6-1-2 type=checkbox id=nav-6-1-2> <label class=md-nav__link for=nav-6-1-2> Mark </label> <nav class=md-nav data-md-component=collapsible data-md-level=3> <label class=md-nav__title for=nav-6-1-2> Mark </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../life/reading/mark/back-up/ title="2019 暑假备份" class=md-nav__link> 2019 暑假备份 </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/mark/back/ title=例行收集 class=md-nav__link> 例行收集 </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/mark/efficiency-time/ title=效率、时间、鸡汤 class=md-nav__link> 效率、时间、鸡汤 </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/mark/fiction/ title=小说 class=md-nav__link> 小说 </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/mark/films-remark/ title=影评、电影 class=md-nav__link> 影评、电影 </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/mark/fo/ title=佛 class=md-nav__link> 佛 </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/mark/hackers-others/ title=互联网、思维方式 class=md-nav__link> 互联网、思维方式 </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/mark/hooked-media/ title=媒介反思 class=md-nav__link> 媒介反思 </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/mark/isaka-kotaro/ title=伊坂幸太郎 class=md-nav__link> 伊坂幸太郎 </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/mark/knote/ title=整理 class=md-nav__link> 整理 </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/mark/mark-knote/ title=浪费时间 class=md-nav__link> 浪费时间 </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/mark/meaning/ title=思维方式 class=md-nav__link> 思维方式 </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/mark/morimi-tomihiko/ title=森见登美彦的文字好有趣啊! class=md-nav__link> 森见登美彦的文字好有趣啊! </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/mark/murakamo-haruki/ title=村上春树 class=md-nav__link> 村上春树 </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/mark/no-fiction/ title=非虚构类 class=md-nav__link> 非虚构类 </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/mark/paper/ title=论文式总结 class=md-nav__link> 论文式总结 </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/mark/poem/ title=诗歌 class=md-nav__link> 诗歌 </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/mark/sence/ title=哲学相关通俗读物 class=md-nav__link> 哲学相关通俗读物 </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/mark/the-little-prince/ title="The Little Prince" class=md-nav__link> The Little Prince </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/mark/universe/ title=物理科普读物 class=md-nav__link> 物理科普读物 </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/mark/utopia/ title=乌托邦小说世界关于书籍的冷幽默 class=md-nav__link> 乌托邦小说世界关于书籍的冷幽默 </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/mark/western-politics/ title=政哲 class=md-nav__link> 政哲 </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/mark/what-we-talk-about/ title=日本文学 class=md-nav__link> 日本文学 </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/mark/wuxia/ title=武侠 class=md-nav__link> 武侠 </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/mark/xiao-bo/ title=王小波 class=md-nav__link> 王小波 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-6-1-3 type=checkbox id=nav-6-1-3> <label class=md-nav__link for=nav-6-1-3> Note </label> <nav class=md-nav data-md-component=collapsible data-md-level=3> <label class=md-nav__title for=nav-6-1-3> Note </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../life/reading/note/2017-09-02-book-JavaScript-DOM/ title="《JavaScript DOM 编程艺术》" class=md-nav__link> 《JavaScript DOM 编程艺术》 </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/note/2017-09-09-coding-javascript-down/ title="尽量把 JavaScript 代码放到 HTML 网页底部" class=md-nav__link> 尽量把 JavaScript 代码放到 HTML 网页底部 </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/note/2018-05-23-HTTP/ title="《HTTP 图解》" class=md-nav__link> 《HTTP 图解》 </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/note/2018-06-07-computer/ title=计算机系统基础 class=md-nav__link> 计算机系统基础 </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/note/2018-10-09-JVM/ title="JVM 笔记" class=md-nav__link> JVM 笔记 </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/note/2018-11-25-computer/ title=计算机系统概论 class=md-nav__link> 计算机系统概论 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-6-1-4 type=checkbox id=nav-6-1-4> <label class=md-nav__link for=nav-6-1-4> Review </label> <nav class=md-nav data-md-component=collapsible data-md-level=3> <label class=md-nav__title for=nav-6-1-4> Review </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../life/reading/review/2017-09-28-say-something/ title=听你吹牛的闲暇时光 class=md-nav__link> 听你吹牛的闲暇时光 </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/review/2017-09-29-wuxia/ title="《流星 蝴蝶 剑》简记" class=md-nav__link> 《流星 蝴蝶 剑》简记 </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/review/2017-12-30-xiao-bo/ title=波波老师 class=md-nav__link> 波波老师 </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/review/2018-01-17-lai-zi-xin-shi-jie/ title=《来自新世界》 class=md-nav__link> 《来自新世界》 </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/review/2018-10-06-October/ title=科普谈起 class=md-nav__link> 科普谈起 </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/review/2019-09-07-story/ title=从网络小说谈起。 class=md-nav__link> 从网络小说谈起。 </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-6-2 type=checkbox id=nav-6-2> <label class=md-nav__link for=nav-6-2> Watching </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-6-2> Watching </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../life/watching/2017-08-29-watch-movies-rencently/ title=最近看的几部电影 class=md-nav__link> 最近看的几部电影 </a> </li> <li class=md-nav__item> <a href=../../../../../life/watching/2017-10-13-september-movies-record/ title=九月观影记录 class=md-nav__link> 九月观影记录 </a> </li> <li class=md-nav__item> <a href=../../../../../life/watching/2017-11-01-October-summary/ title=十月看片与非专业类阅读 class=md-nav__link> 十月看片与非专业类阅读 </a> </li> <li class=md-nav__item> <a href=../../../../../life/watching/2017-12-01-1112/ title=观影与阅读记录 class=md-nav__link> 观影与阅读记录 </a> </li> <li class=md-nav__item> <a href=../../../../../life/watching/2018-01-10-12/ title=最近看片与阅读 class=md-nav__link> 最近看片与阅读 </a> </li> <li class=md-nav__item> <a href=../../../../../life/watching/2018-02-06-january/ title=一月观影记录 class=md-nav__link> 一月观影记录 </a> </li> <li class=md-nav__item> <a href=../../../../../life/watching/2018-03-08-February/ title=二月至今观影记录 class=md-nav__link> 二月至今观影记录 </a> </li> <li class=md-nav__item> <a href=../../../../../life/watching/2018-03-31-March/ title=三月观影记录 class=md-nav__link> 三月观影记录 </a> </li> <li class=md-nav__item> <a href=../../../../../life/watching/2018-12-26-Smultronst%C3%A4llet/ title=野草莓 class=md-nav__link> 野草莓 </a> </li> <li class=md-nav__item> <a href=../../../../../life/watching/2019-10-10-October/ title=克服本能就是善良吗？（从十月新番胡扯……） class=md-nav__link> 克服本能就是善良吗？（从十月新番胡扯……） </a> </li> <li class=md-nav__item> <a href=../../../../../life/watching/2019-11-04-bgm/ title=无人声环 class=md-nav__link> 无人声环 </a> </li> <li class=md-nav__item> <a href=../../../../../life/watching/2019-11-13-the-end-of-the-world/ title="The End of the Fucking World" class=md-nav__link> The End of the Fucking World </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-7 type=checkbox id=nav-7> <label class=md-nav__link for=nav-7> Study </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-7> Study </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-7-1 type=checkbox id=nav-7-1> <label class=md-nav__link for=nav-7-1> Draft </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-7-1> Draft </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../study/draft/try-wiki/ title="一些 Wiki 工具的尝试" class=md-nav__link> 一些 Wiki 工具的尝试 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-7-2 type=checkbox id=nav-7-2> <label class=md-nav__link for=nav-7-2> Language </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-7-2> Language </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../study/language/%E6%97%A5%E8%AF%AD%E5%85%A5%E9%97%A8/ title=日语入门 class=md-nav__link> 日语入门 </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-8 type=checkbox id=nav-8> <label class=md-nav__link for=nav-8> Tech </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-8> Tech </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-8-1 type=checkbox id=nav-8-1> <label class=md-nav__link for=nav-8-1> Code </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-8-1> Code </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-8-1-1 type=checkbox id=nav-8-1-1> <label class=md-nav__link for=nav-8-1-1> Frontend </label> <nav class=md-nav data-md-component=collapsible data-md-level=3> <label class=md-nav__title for=nav-8-1-1> Frontend </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../tech/code/frontend/2017-09-14-easy-web-test/ title=大表哥的电商网页实战体验 class=md-nav__link> 大表哥的电商网页实战体验 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/code/frontend/2017-09-23-know-nothing/ title=知其然不知其所以然 class=md-nav__link> 知其然不知其所以然 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/code/frontend/2018-06-08-responsive/ title=大表哥的响应式设计 class=md-nav__link> 大表哥的响应式设计 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/code/frontend/zh-javascript-info/ title="现代 JavaScript 教程摘录" class=md-nav__link> 现代 JavaScript 教程摘录 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-8-1-2 type=checkbox id=nav-8-1-2> <label class=md-nav__link for=nav-8-1-2> Go </label> <nav class=md-nav data-md-component=collapsible data-md-level=3> <label class=md-nav__title for=nav-8-1-2> Go </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../tech/code/go/01/ title=01 class=md-nav__link> 01 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-8-1-3 type=checkbox id=nav-8-1-3> <label class=md-nav__link for=nav-8-1-3> Java </label> <nav class=md-nav data-md-component=collapsible data-md-level=3> <label class=md-nav__title for=nav-8-1-3> Java </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../tech/code/java/2017-12-30-Java%20Web/ title="从 url 访问服务器资源讨论 Java Web 中的 Servlet" class=md-nav__link> 从 url 访问服务器资源讨论 Java Web 中的 Servlet </a> </li> <li class=md-nav__item> <a href=../../../../../tech/code/java/2018-11-23-ArrayList/ title=ArrayList class=md-nav__link> ArrayList </a> </li> <li class=md-nav__item> <a href=../../../../../tech/code/java/2019-01-31-HashMap/ title=HashMap class=md-nav__link> HashMap </a> </li> <li class=md-nav__item> <a href=../../../../../tech/code/java/2019-02-01-String/ title="String 分析(栈,堆,字符串常量池)" class=md-nav__link> String 分析(栈,堆,字符串常量池) </a> </li> <li class=md-nav__item> <a href=../../../../../tech/code/java/2019-02-03-String/ title=String、StringBuffer、StingBuilder class=md-nav__link> String、StringBuffer、StingBuilder </a> </li> <li class=md-nav__item> <a href=../../../../../tech/code/java/2019-02-06-Hashtable/ title=Hashtable class=md-nav__link> Hashtable </a> </li> <li class=md-nav__item> <a href=../../../../../tech/code/java/2019-03-22-string-pool/ title=字符串常量池到底保存的是字符串对象还是字符串对象的引用? class=md-nav__link> 字符串常量池到底保存的是字符串对象还是字符串对象的引用? </a> </li> <li class=md-nav__item> <a href=../../../../../tech/code/java/2019-03-23-Java-Thread-pool/ title="Java 线程池" class=md-nav__link> Java 线程池 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/code/java/2019-03-29-Java%20Web/ title="Java Web 启动流程" class=md-nav__link> Java Web 启动流程 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/code/java/2019-04-05-AQS-lock/ title="AQS 与 Java 锁的具体实现" class=md-nav__link> AQS 与 Java 锁的具体实现 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-8-1-4 type=checkbox id=nav-8-1-4> <label class=md-nav__link for=nav-8-1-4> Projects </label> <nav class=md-nav data-md-component=collapsible data-md-level=3> <label class=md-nav__title for=nav-8-1-4> Projects </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../tech/code/projects/2018-05-07-big-data/ title="大数据 Demo （采集、处理、应用）复盘" class=md-nav__link> 大数据 Demo （采集、处理、应用）复盘 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-8-1-5 type=checkbox id=nav-8-1-5> <label class=md-nav__link for=nav-8-1-5> Spring </label> <nav class=md-nav data-md-component=collapsible data-md-level=3> <label class=md-nav__title for=nav-8-1-5> Spring </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../tech/code/spring/2018-09-01-Spring%20Security/ title="Spring Boot 与 Spring Security" class=md-nav__link> Spring Boot 与 Spring Security </a> </li> <li class=md-nav__item> <a href=../../../../../tech/code/spring/2019-03-29-Spring-init/ title="Spring 启动流程与简单源码分析" class=md-nav__link> Spring 启动流程与简单源码分析 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/code/spring/2019-04-06-Spring-MVC/ title="Spring MVC 简单源码分析" class=md-nav__link> Spring MVC 简单源码分析 </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-8-2 type=checkbox id=nav-8-2> <label class=md-nav__link for=nav-8-2> Config </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-8-2> Config </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-8-2-1 type=checkbox id=nav-8-2-1> <label class=md-nav__link for=nav-8-2-1> Git </label> <nav class=md-nav data-md-component=collapsible data-md-level=3> <label class=md-nav__title for=nav-8-2-1> Git </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../tech/config/git/2018-02-01-git/ title="Git 的简单使用" class=md-nav__link> Git 的简单使用 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/config/git/2019-08-10-git-merge/ title="Git 协作管理项目时不可避免的 merge 操作" class=md-nav__link> Git 协作管理项目时不可避免的 merge 操作 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/config/git/submodule/ title=submodule class=md-nav__link> submodule </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-8-2-2 type=checkbox id=nav-8-2-2> <label class=md-nav__link for=nav-8-2-2> Linux </label> <nav class=md-nav data-md-component=collapsible data-md-level=3> <label class=md-nav__title for=nav-8-2-2> Linux </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../tech/config/linux/2019-12-18-manjaro/ title="Manjaro 个人新装配置" class=md-nav__link> Manjaro 个人新装配置 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/config/linux/2020-02-23-archer-s-arch/ title="Archer`s Arch" class=md-nav__link> Archer`s Arch </a> </li> <li class=md-nav__item> <a href=../../../../../tech/config/linux/fontconfig/ title="Arch Emoji fontconfig" class=md-nav__link> Arch Emoji fontconfig </a> </li> <li class=md-nav__item> <a href=../../../../../tech/config/linux/softwares/ title=各种工具 class=md-nav__link> 各种工具 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-8-2-3 type=checkbox id=nav-8-2-3> <label class=md-nav__link for=nav-8-2-3> Tools </label> <nav class=md-nav data-md-component=collapsible data-md-level=3> <label class=md-nav__title for=nav-8-2-3> Tools </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../tech/config/tools/cz-conventional-changelog/ title=cz-conventional-changelog class=md-nav__link> cz-conventional-changelog </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-8-2-4 type=checkbox id=nav-8-2-4> <label class=md-nav__link for=nav-8-2-4> Undefined </label> <nav class=md-nav data-md-component=collapsible data-md-level=3> <label class=md-nav__title for=nav-8-2-4> Undefined </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../tech/config/undefined/2018-03-31-Generator-SpringBoot-Gradle/ title="MyBatis Generator + Spring Boot + Gradle 配置" class=md-nav__link> MyBatis Generator + Spring Boot + Gradle 配置 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/config/undefined/2018-06-25-VS-Code-Python/ title="VS Code 写 Python" class=md-nav__link> VS Code 写 Python </a> </li> <li class=md-nav__item> <a href=../../../../../tech/config/undefined/2018-06-26-linux-kawa/ title="在 Linux 上使用 kawa" class=md-nav__link> 在 Linux 上使用 kawa </a> </li> <li class=md-nav__item> <a href=../../../../../tech/config/undefined/2018-11-25-mysql/ title="【转】在 CentOS 上部署 MySQL 解压版" class=md-nav__link> 【转】在 CentOS 上部署 MySQL 解压版 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/config/undefined/2019-04-03-Redis-lock/ title="Redis 的分布式锁实现" class=md-nav__link> Redis 的分布式锁实现 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/config/undefined/2019-07-28-picGo/ title="Github + picGo ——有图床了" class=md-nav__link> Github + picGo ——有图床了 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/config/undefined/2019-11-18-linux-mount/ title="Linux 挂载分区/磁盘" class=md-nav__link> Linux 挂载分区/磁盘 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/config/undefined/2020-02-03-terminal-wifi/ title=把显卡驱动删了后在终端连热点 class=md-nav__link> 把显卡驱动删了后在终端连热点 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/config/undefined/2020-02-12-css/ title=一个引号引发的惨案 class=md-nav__link> 一个引号引发的惨案 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/config/undefined/2020-02-23-archer-s-arch/ title="Archer`s Arch" class=md-nav__link> Archer`s Arch </a> </li> <li class=md-nav__item> <a href=../../../../../tech/config/undefined/2020-03-12-electron-vue/ title="用 Vue 写 Electron 的一次问题解决" class=md-nav__link> 用 Vue 写 Electron 的一次问题解决 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/config/undefined/2020-03-12-ttrss/ title="部署 TTRSS 遇到的一些有趣的东西" class=md-nav__link> 部署 TTRSS 遇到的一些有趣的东西 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/config/undefined/2020-04-02-hexo-asset-image/ title="hexo-next-theme 开启 lazyload 使用 hexo-asset-image 出问题了" class=md-nav__link> hexo-next-theme 开启 lazyload 使用 hexo-asset-image 出问题了 </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-8-3 type=checkbox id=nav-8-3> <label class=md-nav__link for=nav-8-3> Project </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-8-3> Project </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../tech/project/2017-12-21-xiao-zong-jie/ title=做个小小的总结 class=md-nav__link> 做个小小的总结 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/project/2018-05-07-big-data/ title="大数据 Demo （采集、处理、应用）复盘" class=md-nav__link> 大数据 Demo （采集、处理、应用）复盘 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/project/2018-06-25-tencent-news-spider-py/ title=腾讯新闻爬虫 class=md-nav__link> 腾讯新闻爬虫 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/project/2018-09-13-lite-terminal-home-page/ title=简单的仿终端主页 class=md-nav__link> 简单的仿终端主页 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/project/2019-01-11-tank/ title=花里胡哨的坦克大战 class=md-nav__link> 花里胡哨的坦克大战 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/project/2019-02-05-new-year/ title=大年初一（爬取豆瓣条目及吐槽） class=md-nav__link> 大年初一（爬取豆瓣条目及吐槽） </a> </li> <li class=md-nav__item> <a href=../../../../../tech/project/2019-04-03-blog-project/ title=写博客 class=md-nav__link> 写博客 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/project/2019-06-17-nodejs/ title="MarkAll 导入豆瓣数据 —— NodeJS 写爬虫" class=md-nav__link> MarkAll 导入豆瓣数据 —— NodeJS 写爬虫 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/project/2019-11-15-Autumn-Json/ title="Autumn-From-Spring 自定义 BeanDefinitionReader" class=md-nav__link> Autumn-From-Spring 自定义 BeanDefinitionReader </a> </li> <li class=md-nav__item> <a href=../../../../../tech/project/2019-11-15-bookmarkdown/ title="Chrome 插件——书签转 MarkDown" class=md-nav__link> Chrome 插件——书签转 MarkDown </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-8-4 type=checkbox id=nav-8-4> <label class=md-nav__link for=nav-8-4> Undefined </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-8-4> Undefined </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../tech/undefined/2017-08-10-then-start/ title=那就开始吧 class=md-nav__link> 那就开始吧 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/undefined/2017-08-16-Writing-is%20the-reward-of-writing-itself/ title=写就是写本身的报酬 class=md-nav__link> 写就是写本身的报酬 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/undefined/2017-11-19-change-my-blog/ title=【过时内容】嘿，我转移博客啦！ class=md-nav__link> 【过时内容】嘿，我转移博客啦！ </a> </li> <li class=md-nav__item> <a href=../../../../../tech/undefined/2017-12-08-yao-guai-ji-yu-you-ren-bo/ title=妖怪唧唧与友人波波 class=md-nav__link> 妖怪唧唧与友人波波 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/undefined/2018-01-01-ubuntu/ title="折腾 ubuntu 与 win10 共存" class=md-nav__link> 折腾 ubuntu 与 win10 共存 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/undefined/2018-02-09-pc-system/ title="黑苹果与 Ubuntu 及 PC 折腾系统" class=md-nav__link> 黑苹果与 Ubuntu 及 PC 折腾系统 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/undefined/2018-03-12-install-Vmware-on-linux/ title="deepin 安装 VMware" class=md-nav__link> deepin 安装 VMware </a> </li> <li class=md-nav__item> <a href=../../../../../tech/undefined/2018-03-31-SQL/ title="Spring Boot 开发遇到一些 SQL 问题" class=md-nav__link> Spring Boot 开发遇到一些 SQL 问题 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/undefined/2018-04-06-jquery-confrim/ title="JQuery-Confrim 的一点问题" class=md-nav__link> JQuery-Confrim 的一点问题 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/undefined/2018-04-06-some-plugins/ title="ECharts + PageHelper + Bootstrap Table" class=md-nav__link> ECharts + PageHelper + Bootstrap Table </a> </li> <li class=md-nav__item> <a href=../../../../../tech/undefined/2018-04-09-js-in-thymeleaf/ title="Thymeleaf 里使用 JavaScript 时的注意事项" class=md-nav__link> Thymeleaf 里使用 JavaScript 时的注意事项 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/undefined/2018-04-09-spring-boot-gradle-yml-log4j2/ title="Spring Boot + Gradle + yml 配置 log4j2" class=md-nav__link> Spring Boot + Gradle + yml 配置 log4j2 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/undefined/2018-05-09-softwares/ title="Linux 常用软件" class=md-nav__link> Linux 常用软件 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/undefined/2018-05-30-hexo-image/ title="【可能过时】Hexo 一点问题（生成博文插入本地图片,修改文章路径）" class=md-nav__link> 【可能过时】Hexo 一点问题（生成博文插入本地图片,修改文章路径） </a> </li> <li class=md-nav__item> <a href=../../../../../tech/undefined/2018-05-30-show/ title=如果给文章提供多种渲染方式 class=md-nav__link> 如果给文章提供多种渲染方式 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/undefined/2018-08-30-vue-music/ title="简单的单页应用(Vue CLI2 的简单使用)" class=md-nav__link> 简单的单页应用(Vue CLI2 的简单使用) </a> </li> <li class=md-nav__item> <a href=../../../../../tech/undefined/2018-09-23-word-count/ title="WordCount 项目总结" class=md-nav__link> WordCount 项目总结 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/undefined/2020-02-06-markall-douban-backup/ title=豆瓣标记数据备份插件 class=md-nav__link> 豆瓣标记数据备份插件 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/undefined/2020-02-07-markall-douban-backup-yes/ title=【过时】又一个——豆瓣标记数据备份插件 class=md-nav__link> 【过时】又一个——豆瓣标记数据备份插件 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/undefined/2020-02-13-blog/ title=从分析本网站的网络请求谈起 class=md-nav__link> 从分析本网站的网络请求谈起 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/undefined/draft/ title=Draft class=md-nav__link> Draft </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary"> <label class=md-nav__title for=__toc>目录</label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=#_2 class=md-nav__link> 新旧对比 </a> </li> <li class=md-nav__item> <a href=#lambda class=md-nav__link> Lambda表达式 </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_3 class=md-nav__link> 递归 </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_4 class=md-nav__link> 方法引用 </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#runnable class=md-nav__link> Runnable接口 </a> </li> <li class=md-nav__item> <a href=#_5 class=md-nav__link> 未绑定的方法引用 </a> </li> <li class=md-nav__item> <a href=#_6 class=md-nav__link> 构造函数引用 </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_7 class=md-nav__link> 函数式接口 </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_8 class=md-nav__link> 多参数函数式接口 </a> </li> <li class=md-nav__item> <a href=#_9 class=md-nav__link> 缺少基本类型的函数 </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_10 class=md-nav__link> 高阶函数 </a> </li> <li class=md-nav__item> <a href=#_11 class=md-nav__link> 闭包 </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_12 class=md-nav__link> 作为闭包的内部类 </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_13 class=md-nav__link> 函数组合 </a> </li> <li class=md-nav__item> <a href=#_14 class=md-nav__link> 柯里化和部分求值 </a> </li> <li class=md-nav__item> <a href=#_15 class=md-nav__link> 纯函数式编程 </a> </li> <li class=md-nav__item> <a href=#_16 class=md-nav__link> 本章小结 </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content> <article class="md-content__inner md-typeset"> <a href=https://github.com/hqweay/my-mkdocs/edit/master/docs/book/OnJava8/docs/book/13-Functional-Programming.md title=编辑此页 class="md-icon md-content__icon">&#xE3C9;</a> <div class=toc> <ul> <li><a href=#_1>第十三章 函数式编程</a><ul> <li><a href=#_2>新旧对比</a></li> <li><a href=#lambda>Lambda表达式</a><ul> <li><a href=#_3>递归</a></li> </ul> </li> <li><a href=#_4>方法引用</a><ul> <li><a href=#runnable>Runnable接口</a></li> <li><a href=#_5>未绑定的方法引用</a></li> <li><a href=#_6>构造函数引用</a></li> </ul> </li> <li><a href=#_7>函数式接口</a><ul> <li><a href=#_8>多参数函数式接口</a></li> <li><a href=#_9>缺少基本类型的函数</a></li> </ul> </li> <li><a href=#_10>高阶函数</a></li> <li><a href=#_11>闭包</a><ul> <li><a href=#_12>作为闭包的内部类</a></li> </ul> </li> <li><a href=#_13>函数组合</a></li> <li><a href=#_14>柯里化和部分求值</a></li> <li><a href=#_15>纯函数式编程</a></li> <li><a href=#_16>本章小结</a></li> </ul> </li> </ul> </div> <!-- Functional Programming --> <h1 id=_1>第十三章 函数式编程<a class=headerlink href=#_1 title="Permanent link">#</a></h1> <blockquote> <p>函数式编程语言操纵代码片段就像操作数据一样容易。 虽然 Java 不是函数式语言，但 Java 8 Lambda 表达式和方法引用 (Method References) 允许你以函数式编程。</p> </blockquote> <p>在计算机时代早期，内存是稀缺和昂贵的。几乎每个人都用汇编语言编程。人们虽然知道编译器，但编译器生成的代码很低效，比手工编码的汇编程序多很多字节，仅仅想到这一点，人们还是选择汇编语言。</p> <p>通常，为了使程序能在有限的内存上运行，在程序运行时，程序员通过修改内存中的代码，使程序可以执行不同的操作，用这种方式来节省代码空间。这种技术被称为<strong>自修改代码</strong> （self-modifying code）。只要程序小到几个人就能够维护所有棘手和难懂的汇编代码，你就能让程序运行起来。</p> <p>随着内存和处理器变得更便宜、更快。C 语言出现并被大多数汇编程序员认为更“高级”。人们发现使用 C 可以显著提高生产力。同时，使用 C 创建自修改代码仍然不难。</p> <p>随着硬件越来越便宜，程序的规模和复杂性都在增长。这一切只是让程序工作变得困难。我们想方设法使代码更加一致和易懂。使用纯粹的自修改代码造成的结果就是：我们很难确定程序在做什么。它也难以测试：除非你想一点点测试输出，代码转换和修改等等过程？</p> <p>然而，使用代码以某种方式操纵其他代码的想法也很有趣，只要能保证它更安全。从代码创建，维护和可靠性的角度来看，这个想法非常吸引人。我们不用从头开始编写大量代码，而是从易于理解、充分测试及可靠的现有小块开始，最后将它们组合在一起以创建新代码。难道这不会让我们更有效率，同时创造更健壮的代码吗？</p> <p>这就是<strong>函数式编程</strong>（FP）的意义所在。通过合并现有代码来生成新功能而不是从头开始编写所有内容，我们可以更快地获得更可靠的代码。至少在某些情况下，这套理论似乎很有用。在这一过程中，函数式语言已经产生了优雅的语法，这些语法对于非函数式语言也适用。</p> <p>你也可以这样想：</p> <p>OO（object oriented，面向对象）是抽象数据，FP（functional programming，函数式编程）是抽象行为。</p> <p>纯粹的函数式语言在安全性方面更进一步。它强加了额外的约束，即所有数据必须是不可变的：设置一次，永不改变。将值传递给函数，该函数然后生成新值但从不修改自身外部的任何东西（包括其参数或该函数范围之外的元素）。当强制执行此操作时，你知道任何错误都不是由所谓的副作用引起的，因为该函数仅创建并返回结果，而不是其他任何错误。</p> <p>更好的是，“不可变对象和无副作用”范式解决了并发编程中最基本和最棘手的问题之一（当程序的某些部分同时在多个处理器上运行时）。这是可变共享状态的问题，这意味着代码的不同部分（在不同的处理器上运行）可以尝试同时修改同一块内存（谁赢了？没人知道）。如果函数永远不会修改现有值但只生成新值，则不会对内存产生争用，这是纯函数式语言的定义。 因此，经常提出纯函数式语言作为并行编程的解决方案（还有其他可行的解决方案）。</p> <p>需要提醒大家的是，函数式语言背后有很多动机，这意味着描述它们可能会有些混淆。它通常取决于各种观点：为“并行编程”，“代码可靠性”和“代码创建和库复用”。<sup id=fnref:1><a class=footnote-ref href=#fn:1>1</a></sup> 关于函数式编程能高效创建更健壮的代码这一观点仍存在部分争议。虽然已有一些好的范例<sup id=fnref:2><a class=footnote-ref href=#fn:2>2</a></sup>，但还不足以证明纯函数式语言就是解决编程问题的最佳方法。</p> <p>FP 思想值得融入非 FP 语言，如 Python。Java 8 也从中吸收并支持了 FP。我们将在此章探讨。</p> <!-- Old vs. New --> <h2 id=_2>新旧对比<a class=headerlink href=#_2 title="Permanent link">#</a></h2> <p>通常，传递给方法的数据不同，结果不同。如果我们希望方法在调用时行为不同，该怎么做呢？结论是：只要能将代码传递给方法，我们就可以控制它的行为。此前，我们通过在方法中创建包含所需行为的对象，然后将该对象传递给我们想要控制的方法来完成此操作。下面我们用传统形式和 Java 8 的方法引用、Lambda 表达式分别演示。代码示例：</p> <div class=highlight><pre><span></span><code><span class=c1>// functional/Strategize.java</span>

<span class=kd>interface</span> <span class=nc>Strategy</span> <span class=p>{</span>
  <span class=n>String</span> <span class=nf>approach</span><span class=p>(</span><span class=n>String</span> <span class=n>msg</span><span class=p>);</span>
<span class=p>}</span>

<span class=kd>class</span> <span class=nc>Soft</span> <span class=kd>implements</span> <span class=n>Strategy</span> <span class=p>{</span>
  <span class=kd>public</span> <span class=n>String</span> <span class=nf>approach</span><span class=p>(</span><span class=n>String</span> <span class=n>msg</span><span class=p>)</span> <span class=p>{</span>
    <span class=k>return</span> <span class=n>msg</span><span class=p>.</span><span class=na>toLowerCase</span><span class=p>()</span> <span class=o>+</span> <span class=s>&quot;?&quot;</span><span class=p>;</span>
  <span class=p>}</span>
<span class=p>}</span>

<span class=kd>class</span> <span class=nc>Unrelated</span> <span class=p>{</span>
  <span class=kd>static</span> <span class=n>String</span> <span class=nf>twice</span><span class=p>(</span><span class=n>String</span> <span class=n>msg</span><span class=p>)</span> <span class=p>{</span>
    <span class=k>return</span> <span class=n>msg</span> <span class=o>+</span> <span class=s>&quot; &quot;</span> <span class=o>+</span> <span class=n>msg</span><span class=p>;</span>
  <span class=p>}</span>
<span class=p>}</span>

<span class=kd>public</span> <span class=kd>class</span> <span class=nc>Strategize</span> <span class=p>{</span>
  <span class=n>Strategy</span> <span class=n>strategy</span><span class=p>;</span>
  <span class=n>String</span> <span class=n>msg</span><span class=p>;</span>
  <span class=n>Strategize</span><span class=p>(</span><span class=n>String</span> <span class=n>msg</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>strategy</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Soft</span><span class=p>();</span> <span class=c1>// [1]</span>
    <span class=k>this</span><span class=p>.</span><span class=na>msg</span> <span class=o>=</span> <span class=n>msg</span><span class=p>;</span>
  <span class=p>}</span>

  <span class=kt>void</span> <span class=nf>communicate</span><span class=p>()</span> <span class=p>{</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>strategy</span><span class=p>.</span><span class=na>approach</span><span class=p>(</span><span class=n>msg</span><span class=p>));</span>
  <span class=p>}</span>

  <span class=kt>void</span> <span class=nf>changeStrategy</span><span class=p>(</span><span class=n>Strategy</span> <span class=n>strategy</span><span class=p>)</span> <span class=p>{</span>
    <span class=k>this</span><span class=p>.</span><span class=na>strategy</span> <span class=o>=</span> <span class=n>strategy</span><span class=p>;</span>
  <span class=p>}</span>

  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=p>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>Strategy</span><span class=o>[]</span> <span class=n>strategies</span> <span class=o>=</span> <span class=p>{</span>
      <span class=k>new</span> <span class=n>Strategy</span><span class=p>()</span> <span class=p>{</span> <span class=c1>// [2]</span>
        <span class=kd>public</span> <span class=n>String</span> <span class=nf>approach</span><span class=p>(</span><span class=n>String</span> <span class=n>msg</span><span class=p>)</span> <span class=p>{</span>
          <span class=k>return</span> <span class=n>msg</span><span class=p>.</span><span class=na>toUpperCase</span><span class=p>()</span> <span class=o>+</span> <span class=s>&quot;!&quot;</span><span class=p>;</span>
        <span class=p>}</span>
      <span class=p>},</span>
      <span class=n>msg</span> <span class=o>-&gt;</span> <span class=n>msg</span><span class=p>.</span><span class=na>substring</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>5</span><span class=p>),</span> <span class=c1>// [3]</span>
      <span class=n>Unrelated</span><span class=p>::</span><span class=n>twice</span> <span class=c1>// [4]</span>
    <span class=p>};</span>
    <span class=n>Strategize</span> <span class=n>s</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Strategize</span><span class=p>(</span><span class=s>&quot;Hello there&quot;</span><span class=p>);</span>
    <span class=n>s</span><span class=p>.</span><span class=na>communicate</span><span class=p>();</span>
    <span class=k>for</span><span class=p>(</span><span class=n>Strategy</span> <span class=n>newStrategy</span> <span class=p>:</span> <span class=n>strategies</span><span class=p>)</span> <span class=p>{</span>
      <span class=n>s</span><span class=p>.</span><span class=na>changeStrategy</span><span class=p>(</span><span class=n>newStrategy</span><span class=p>);</span> <span class=c1>// [5]</span>
      <span class=n>s</span><span class=p>.</span><span class=na>communicate</span><span class=p>();</span> <span class=c1>// [6]</span>
    <span class=p>}</span>
  <span class=p>}</span>
<span class=p>}</span>
</code></pre></div> <p>输出结果:</p> <div class=highlight><pre><span></span><code>hello there?
HELLO THERE!
Hello
Hello there Hello there
</code></pre></div> <p><strong>Strategy</strong> 接口提供了单一的 <code>approach()</code> 方法来承载函数式功能。通过创建不同的 <strong>Strategy</strong> 对象，我们可以创建不同的行为。</p> <p>我们一般通过创建一个实现<strong>Strategy</strong>接口的类来实现这种行为，正如在<strong>Soft</strong>里所做的。</p> <ul> <li> <p><strong>[1]</strong> 在 <strong>Strategize</strong> 中，你可以看到 <strong>Soft</strong> 作为默认策略，在构造函数中赋值。</p> </li> <li> <p><strong>[2]</strong> 一种较为简洁且更加自然的方法是创建一个<strong>匿名内部类</strong>。即便如此，仍有相当数量的冗余代码。你总需要仔细观察后才会发现：“哦，我明白了，原来这里使用了匿名内部类。”</p> </li> <li> <p><strong>[3]</strong> Java 8 的 Lambda 表达式，其参数和函数体被箭头 <code>-&gt;</code> 分隔开。箭头右侧是从 Lambda 返回的表达式。它与单独定义类和采用匿名内部类是等价的，但代码少得多。</p> </li> <li> <p><strong>[4]</strong> Java 8 的<strong>方法引用</strong>，它以 <code>::</code> 为特征。 <code>::</code> 的左边是类或对象的名称， <code>::</code> 的右边是方法的名称，但是没有参数列表。</p> </li> <li> <p><strong>[5]</strong> 在使用默认的 <strong>Soft</strong> 策略之后，我们逐步遍历数组中的所有 <strong>Strategy</strong>，并通过调用 <code>changeStrategy()</code> 方法将每个 <strong>Strategy</strong> 传入变量 <code>s</code> 中。</p> </li> <li> <p><strong>[6]</strong> 现在，每次调用 <code>communicate()</code> 都会产生不同的行为，具体取决于此刻正在使用的策略<strong>代码对象</strong>。我们传递的是行为，而并不仅仅是数据。<sup id=fnref:3><a class=footnote-ref href=#fn:3>3</a></sup></p> </li> </ul> <p>在 Java 8 之前，我们能够通过 <strong>[1]</strong> 和 <strong>[2]</strong> 的方式传递功能。然而，这种语法的读写非常笨拙，并且我们别无选择。方法引用和 Lambda 表达式的出现让我们可以在需要时<strong>传递功能</strong>，而不是仅在必要时才这么做。</p> <!-- Lambda Expressions --> <h2 id=lambda>Lambda表达式<a class=headerlink href=#lambda title="Permanent link">#</a></h2> <p>Lambda 表达式是使用<strong>最小可能</strong>语法编写的函数定义：</p> <ol> <li> <p>Lambda 表达式产生函数，而不是类。 在 JVM（Java Virtual Machine，Java 虚拟机）上，一切都是一个类，因此在幕后执行各种操作使 Lambda 看起来像函数 —— 但作为程序员，你可以高兴地假装它们“只是函数”。</p> </li> <li> <p>Lambda 语法尽可能少，这正是为了使 Lambda 易于编写和使用。</p> </li> </ol> <p>我们在 <strong>Strategize.java</strong> 中看到了一个 Lambda 表达式，但还有其他语法变体：</p> <div class=highlight><pre><span></span><code><span class=c1>// functional/LambdaExpressions.java</span>

<span class=kd>interface</span> <span class=nc>Description</span> <span class=p>{</span>
  <span class=n>String</span> <span class=nf>brief</span><span class=p>();</span>
<span class=p>}</span>

<span class=kd>interface</span> <span class=nc>Body</span> <span class=p>{</span>
  <span class=n>String</span> <span class=nf>detailed</span><span class=p>(</span><span class=n>String</span> <span class=n>head</span><span class=p>);</span>
<span class=p>}</span>

<span class=kd>interface</span> <span class=nc>Multi</span> <span class=p>{</span>
  <span class=n>String</span> <span class=nf>twoArg</span><span class=p>(</span><span class=n>String</span> <span class=n>head</span><span class=p>,</span> <span class=n>Double</span> <span class=n>d</span><span class=p>);</span>
<span class=p>}</span>

<span class=kd>public</span> <span class=kd>class</span> <span class=nc>LambdaExpressions</span> <span class=p>{</span>

  <span class=kd>static</span> <span class=n>Body</span> <span class=n>bod</span> <span class=o>=</span> <span class=n>h</span> <span class=o>-&gt;</span> <span class=n>h</span> <span class=o>+</span> <span class=s>&quot; No Parens!&quot;</span><span class=p>;</span> <span class=c1>// [1]</span>

  <span class=kd>static</span> <span class=n>Body</span> <span class=n>bod2</span> <span class=o>=</span> <span class=p>(</span><span class=n>h</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>h</span> <span class=o>+</span> <span class=s>&quot; More details&quot;</span><span class=p>;</span> <span class=c1>// [2]</span>

  <span class=kd>static</span> <span class=n>Description</span> <span class=n>desc</span> <span class=o>=</span> <span class=p>()</span> <span class=o>-&gt;</span> <span class=s>&quot;Short info&quot;</span><span class=p>;</span> <span class=c1>// [3]</span>

  <span class=kd>static</span> <span class=n>Multi</span> <span class=n>mult</span> <span class=o>=</span> <span class=p>(</span><span class=n>h</span><span class=p>,</span> <span class=n>n</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>h</span> <span class=o>+</span> <span class=n>n</span><span class=p>;</span> <span class=c1>// [4]</span>

  <span class=kd>static</span> <span class=n>Description</span> <span class=n>moreLines</span> <span class=o>=</span> <span class=p>()</span> <span class=o>-&gt;</span> <span class=p>{</span> <span class=c1>// [5]</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&quot;moreLines()&quot;</span><span class=p>);</span>
    <span class=k>return</span> <span class=s>&quot;from moreLines()&quot;</span><span class=p>;</span>
  <span class=p>};</span>

  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=p>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>bod</span><span class=p>.</span><span class=na>detailed</span><span class=p>(</span><span class=s>&quot;Oh!&quot;</span><span class=p>));</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>bod2</span><span class=p>.</span><span class=na>detailed</span><span class=p>(</span><span class=s>&quot;Hi!&quot;</span><span class=p>));</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>desc</span><span class=p>.</span><span class=na>brief</span><span class=p>());</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>mult</span><span class=p>.</span><span class=na>twoArg</span><span class=p>(</span><span class=s>&quot;Pi! &quot;</span><span class=p>,</span> <span class=mf>3.14159</span><span class=p>));</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>moreLines</span><span class=p>.</span><span class=na>brief</span><span class=p>());</span>
  <span class=p>}</span>
<span class=p>}</span>
</code></pre></div> <p>输出结果：</p> <div class=highlight><pre><span></span><code>Oh! No Parens!
Hi! More details
Short info
Pi! 3.14159
moreLines()
from moreLines()
</code></pre></div> <p>我们从三个接口开始，每个接口都有一个单独的方法（很快就会理解它的重要性）。但是，每个方法都有不同数量的参数，以便演示 Lambda 表达式语法。</p> <p>任何 Lambda 表达式的基本语法是：</p> <ol> <li> <p>参数。</p> </li> <li> <p>接着 <code>-&gt;</code>，可视为“产出”。</p> </li> <li> <p><code>-&gt;</code> 之后的内容都是方法体。</p> </li> <li> <p><strong>[1]</strong> 当只用一个参数，可以不需要括号 <code>()</code>。 然而，这是一个特例。</p> </li> <li> <p><strong>[2]</strong> 正常情况使用括号 <code>()</code> 包裹参数。 为了保持一致性，也可以使用括号 <code>()</code> 包裹单个参数，虽然这种情况并不常见。</p> </li> <li> <p><strong>[3]</strong> 如果没有参数，则必须使用括号 <code>()</code> 表示空参数列表。</p> </li> <li> <p><strong>[4]</strong> 对于多个参数，将参数列表放在括号 <code>()</code> 中。</p> </li> </ol> <p>到目前为止，所有 Lambda 表达式方法体都是单行。 该表达式的结果自动成为 Lambda 表达式的返回值，在此处使用 <strong>return</strong> 关键字是非法的。 这是 Lambda 表达式简化相应语法的另一种方式。</p> <p><strong>[5]</strong> 如果在 Lambda 表达式中确实需要多行，则必须将这些行放在花括号中。 在这种情况下，就需要使用 <strong>return</strong>。</p> <p>Lambda 表达式通常比<strong>匿名内部类</strong>产生更易读的代码，因此我们将在本书中尽可能使用它们。</p> <h3 id=_3>递归<a class=headerlink href=#_3 title="Permanent link">#</a></h3> <p>递归函数是一个自我调用的函数。可以编写递归的 Lambda 表达式，但需要注意：递归方法必须是实例变量或静态变量，否则会出现编译时错误。 我们将为每个案例创建一个示例。</p> <p>这两个示例都需要一个接受 <strong>int</strong> 型参数并生成 <strong>int</strong> 的接口：</p> <div class=highlight><pre><span></span><code><span class=c1>// functional/IntCall.java</span>

<span class=kd>interface</span> <span class=nc>IntCall</span> <span class=p>{</span>
  <span class=kt>int</span> <span class=nf>call</span><span class=p>(</span><span class=kt>int</span> <span class=n>arg</span><span class=p>);</span>
<span class=p>}</span>
</code></pre></div> <p>整数 n 的阶乘将所有小于或等于 n 的正整数相乘。 阶乘函数是一个常见的递归示例：</p> <div class=highlight><pre><span></span><code><span class=c1>// functional/RecursiveFactorial.java</span>

<span class=kd>public</span> <span class=kd>class</span> <span class=nc>RecursiveFactorial</span> <span class=p>{</span>
  <span class=kd>static</span> <span class=n>IntCall</span> <span class=n>fact</span><span class=p>;</span>
  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=p>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>fact</span> <span class=o>=</span> <span class=n>n</span> <span class=o>-&gt;</span> <span class=n>n</span> <span class=o>==</span> <span class=mi>0</span> <span class=o>?</span> <span class=mi>1</span> <span class=p>:</span> <span class=n>n</span> <span class=o>*</span> <span class=n>fact</span><span class=p>.</span><span class=na>call</span><span class=p>(</span><span class=n>n</span> <span class=o>-</span> <span class=mi>1</span><span class=p>);</span>
    <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;=</span> <span class=mi>10</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span>
      <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>fact</span><span class=p>.</span><span class=na>call</span><span class=p>(</span><span class=n>i</span><span class=p>));</span>
  <span class=p>}</span>
<span class=p>}</span>
</code></pre></div> <p>输出结果：</p> <div class=highlight><pre><span></span><code>1
1
2
6
24
120
720
5040
40320
362880
3628800
</code></pre></div> <p>这里，<code>fact</code> 是一个静态变量。 注意使用三元 <strong>if-else</strong>。 递归函数将一直调用自己，直到 <code>i == 0</code>。所有递归函数都有“停止条件”，否则将无限递归并产生异常。</p> <p>我们可以将 <code>Fibonacci</code> 序列用递归的 Lambda 表达式来实现，这次使用实例变量：</p> <div class=highlight><pre><span></span><code><span class=c1>// functional/RecursiveFibonacci.java</span>

<span class=kd>public</span> <span class=kd>class</span> <span class=nc>RecursiveFibonacci</span> <span class=p>{</span>
  <span class=n>IntCall</span> <span class=n>fib</span><span class=p>;</span>

  <span class=n>RecursiveFibonacci</span><span class=p>()</span> <span class=p>{</span>
    <span class=n>fib</span> <span class=o>=</span> <span class=n>n</span> <span class=o>-&gt;</span> <span class=n>n</span> <span class=o>==</span> <span class=mi>0</span> <span class=o>?</span> <span class=mi>0</span> <span class=p>:</span>
               <span class=n>n</span> <span class=o>==</span> <span class=mi>1</span> <span class=o>?</span> <span class=mi>1</span> <span class=p>:</span>
               <span class=n>fib</span><span class=p>.</span><span class=na>call</span><span class=p>(</span><span class=n>n</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span> <span class=o>+</span> <span class=n>fib</span><span class=p>.</span><span class=na>call</span><span class=p>(</span><span class=n>n</span> <span class=o>-</span> <span class=mi>2</span><span class=p>);</span>
  <span class=p>}</span>

  <span class=kt>int</span> <span class=nf>fibonacci</span><span class=p>(</span><span class=kt>int</span> <span class=n>n</span><span class=p>)</span> <span class=p>{</span> <span class=k>return</span> <span class=n>fib</span><span class=p>.</span><span class=na>call</span><span class=p>(</span><span class=n>n</span><span class=p>);</span> <span class=p>}</span>

  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=p>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>RecursiveFibonacci</span> <span class=n>rf</span> <span class=o>=</span> <span class=k>new</span> <span class=n>RecursiveFibonacci</span><span class=p>();</span>
    <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;=</span> <span class=mi>10</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span>
      <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>rf</span><span class=p>.</span><span class=na>fibonacci</span><span class=p>(</span><span class=n>i</span><span class=p>));</span>
  <span class=p>}</span>
<span class=p>}</span>
</code></pre></div> <p>输出结果：</p> <div class=highlight><pre><span></span><code>0
1
1
2
3
5
8
13
21
34
55
</code></pre></div> <p>将 <code>Fibonacci</code> 序列中的最后两个元素求和来产生下一个元素。</p> <!-- method references--> <h2 id=_4>方法引用<a class=headerlink href=#_4 title="Permanent link">#</a></h2> <p>Java 8 方法引用没有历史包袱。方法引用组成：类名或对象名，后面跟 <code>::</code> <sup id=fnref:4><a class=footnote-ref href=#fn:4>4</a></sup>，然后跟方法名称。</p> <div class=highlight><pre><span></span><code><span class=c1>// functional/MethodReferences.java</span>

<span class=kn>import</span> <span class=nn>java.util.*</span><span class=p>;</span>

<span class=kd>interface</span> <span class=nc>Callable</span> <span class=p>{</span> <span class=c1>// [1]</span>
  <span class=kt>void</span> <span class=nf>call</span><span class=p>(</span><span class=n>String</span> <span class=n>s</span><span class=p>);</span>
<span class=p>}</span>

<span class=kd>class</span> <span class=nc>Describe</span> <span class=p>{</span>
  <span class=kt>void</span> <span class=nf>show</span><span class=p>(</span><span class=n>String</span> <span class=n>msg</span><span class=p>)</span> <span class=p>{</span> <span class=c1>// [2]</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>msg</span><span class=p>);</span>
  <span class=p>}</span>
<span class=p>}</span>

<span class=kd>public</span> <span class=kd>class</span> <span class=nc>MethodReferences</span> <span class=p>{</span>
  <span class=kd>static</span> <span class=kt>void</span> <span class=nf>hello</span><span class=p>(</span><span class=n>String</span> <span class=n>name</span><span class=p>)</span> <span class=p>{</span> <span class=c1>// [3]</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&quot;Hello, &quot;</span> <span class=o>+</span> <span class=n>name</span><span class=p>);</span>
  <span class=p>}</span>
  <span class=kd>static</span> <span class=kd>class</span> <span class=nc>Description</span> <span class=p>{</span>
    <span class=n>String</span> <span class=n>about</span><span class=p>;</span>
    <span class=n>Description</span><span class=p>(</span><span class=n>String</span> <span class=n>desc</span><span class=p>)</span> <span class=p>{</span> <span class=n>about</span> <span class=o>=</span> <span class=n>desc</span><span class=p>;</span> <span class=p>}</span>
    <span class=kt>void</span> <span class=nf>help</span><span class=p>(</span><span class=n>String</span> <span class=n>msg</span><span class=p>)</span> <span class=p>{</span> <span class=c1>// [4]</span>
      <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>about</span> <span class=o>+</span> <span class=s>&quot; &quot;</span> <span class=o>+</span> <span class=n>msg</span><span class=p>);</span>
    <span class=p>}</span>
  <span class=p>}</span>
  <span class=kd>static</span> <span class=kd>class</span> <span class=nc>Helper</span> <span class=p>{</span>
    <span class=kd>static</span> <span class=kt>void</span> <span class=nf>assist</span><span class=p>(</span><span class=n>String</span> <span class=n>msg</span><span class=p>)</span> <span class=p>{</span> <span class=c1>// [5]</span>
      <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>msg</span><span class=p>);</span>
    <span class=p>}</span>
  <span class=p>}</span>
  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=p>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>Describe</span> <span class=n>d</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Describe</span><span class=p>();</span>
    <span class=n>Callable</span> <span class=n>c</span> <span class=o>=</span> <span class=n>d</span><span class=p>::</span><span class=n>show</span><span class=p>;</span> <span class=c1>// [6]</span>
    <span class=n>c</span><span class=p>.</span><span class=na>call</span><span class=p>(</span><span class=s>&quot;call()&quot;</span><span class=p>);</span> <span class=c1>// [7]</span>

    <span class=n>c</span> <span class=o>=</span> <span class=n>MethodReferences</span><span class=p>::</span><span class=n>hello</span><span class=p>;</span> <span class=c1>// [8]</span>
    <span class=n>c</span><span class=p>.</span><span class=na>call</span><span class=p>(</span><span class=s>&quot;Bob&quot;</span><span class=p>);</span>

    <span class=n>c</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Description</span><span class=p>(</span><span class=s>&quot;valuable&quot;</span><span class=p>)::</span><span class=n>help</span><span class=p>;</span> <span class=c1>// [9]</span>
    <span class=n>c</span><span class=p>.</span><span class=na>call</span><span class=p>(</span><span class=s>&quot;information&quot;</span><span class=p>);</span>

    <span class=n>c</span> <span class=o>=</span> <span class=n>Helper</span><span class=p>::</span><span class=n>assist</span><span class=p>;</span> <span class=c1>// [10]</span>
    <span class=n>c</span><span class=p>.</span><span class=na>call</span><span class=p>(</span><span class=s>&quot;Help!&quot;</span><span class=p>);</span>
  <span class=p>}</span>
<span class=p>}</span>
</code></pre></div> <p>输出结果：</p> <div class=highlight><pre><span></span><code>call()
Hello, Bob
valuable information
Help!
</code></pre></div> <p><strong>[1]</strong> 我们从单一方法接口开始（同样，你很快就会了解到这一点的重要性）。</p> <p><strong>[2]</strong> <code>show()</code> 的签名（参数类型和返回类型）符合 <strong>Callable</strong> 的 <code>call()</code> 的签名。</p> <p><strong>[3]</strong> <code>hello()</code> 也符合 <code>call()</code> 的签名。 </p> <p><strong>[4]</strong> <code>help()</code> 也符合，它是静态内部类中的非静态方法。</p> <p><strong>[5]</strong> <code>assist()</code> 是静态内部类中的静态方法。</p> <p><strong>[6]</strong> 我们将 <strong>Describe</strong> 对象的方法引用赋值给 <strong>Callable</strong> ，它没有 <code>show()</code> 方法，而是 <code>call()</code> 方法。 但是，Java 似乎接受用这个看似奇怪的赋值，因为方法引用符合 <strong>Callable</strong> 的 <code>call()</code> 方法的签名。</p> <p><strong>[7]</strong> 我们现在可以通过调用 <code>call()</code> 来调用 <code>show()</code>，因为 Java 将 <code>call()</code> 映射到 <code>show()</code>。</p> <p><strong>[8]</strong> 这是一个<strong>静态</strong>方法引用。</p> <p><strong>[9]</strong> 这是 <strong>[6]</strong> 的另一个版本：对已实例化对象的方法的引用，有时称为<em>绑定方法引用</em>。</p> <p><strong>[10]</strong> 最后，获取静态内部类中静态方法的引用与 <strong>[8]</strong> 中通过外部类引用相似。</p> <p>上例只是简短的介绍，我们很快就能看到方法引用的所有不同形式。</p> <h3 id=runnable>Runnable接口<a class=headerlink href=#runnable title="Permanent link">#</a></h3> <p><strong>Runnable</strong> 接口自 1.0 版以来一直在 Java 中，因此不需要导入。它也符合特殊的单方法接口格式：它的方法 <code>run()</code> 不带参数，也没有返回值。因此，我们可以使用 Lambda 表达式和方法引用作为 <strong>Runnable</strong>：</p> <div class=highlight><pre><span></span><code><span class=c1>// functional/RunnableMethodReference.java</span>

<span class=c1>// 方法引用与 Runnable 接口的结合使用</span>

<span class=kd>class</span> <span class=nc>Go</span> <span class=p>{</span>
  <span class=kd>static</span> <span class=kt>void</span> <span class=nf>go</span><span class=p>()</span> <span class=p>{</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&quot;Go::go()&quot;</span><span class=p>);</span>
  <span class=p>}</span>
<span class=p>}</span>

<span class=kd>public</span> <span class=kd>class</span> <span class=nc>RunnableMethodReference</span> <span class=p>{</span>
  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=p>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=p>)</span> <span class=p>{</span>

    <span class=k>new</span> <span class=n>Thread</span><span class=p>(</span><span class=k>new</span> <span class=n>Runnable</span><span class=p>()</span> <span class=p>{</span>
      <span class=kd>public</span> <span class=kt>void</span> <span class=nf>run</span><span class=p>()</span> <span class=p>{</span>
        <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&quot;Anonymous&quot;</span><span class=p>);</span>
      <span class=p>}</span>
    <span class=p>}).</span><span class=na>start</span><span class=p>();</span>

    <span class=k>new</span> <span class=n>Thread</span><span class=p>(</span>
      <span class=p>()</span> <span class=o>-&gt;</span> <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&quot;lambda&quot;</span><span class=p>)</span>
    <span class=p>).</span><span class=na>start</span><span class=p>();</span>

    <span class=k>new</span> <span class=n>Thread</span><span class=p>(</span><span class=n>Go</span><span class=p>::</span><span class=n>go</span><span class=p>).</span><span class=na>start</span><span class=p>();</span>
  <span class=p>}</span>
<span class=p>}</span>
</code></pre></div> <p>输出结果：</p> <div class=highlight><pre><span></span><code>Anonymous
lambda
Go::go()
</code></pre></div> <p><strong>Thread</strong> 对象将 <strong>Runnable</strong> 作为其构造函数参数，并具有会调用 <code>run()</code> 的方法 <code>start()</code>。 <strong>注意</strong>，只有<strong>匿名内部类</strong>才需要具有名为 <code>run()</code> 的方法。</p> <!-- Unbound Method References --> <h3 id=_5>未绑定的方法引用<a class=headerlink href=#_5 title="Permanent link">#</a></h3> <p>未绑定的方法引用是指没有关联对象的普通（非静态）方法。 使用未绑定的引用时，我们必须先提供对象：</p> <div class=highlight><pre><span></span><code><span class=c1>// functional/UnboundMethodReference.java</span>

<span class=c1>// 没有方法引用的对象</span>

<span class=kd>class</span> <span class=nc>X</span> <span class=p>{</span>
  <span class=n>String</span> <span class=nf>f</span><span class=p>()</span> <span class=p>{</span> <span class=k>return</span> <span class=s>&quot;X::f()&quot;</span><span class=p>;</span> <span class=p>}</span>
<span class=p>}</span>

<span class=kd>interface</span> <span class=nc>MakeString</span> <span class=p>{</span>
  <span class=n>String</span> <span class=nf>make</span><span class=p>();</span>
<span class=p>}</span>

<span class=kd>interface</span> <span class=nc>TransformX</span> <span class=p>{</span>
  <span class=n>String</span> <span class=nf>transform</span><span class=p>(</span><span class=n>X</span> <span class=n>x</span><span class=p>);</span>
<span class=p>}</span>

<span class=kd>public</span> <span class=kd>class</span> <span class=nc>UnboundMethodReference</span> <span class=p>{</span>
  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=p>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=p>)</span> <span class=p>{</span>
    <span class=c1>// MakeString ms = X::f; // [1]</span>
    <span class=n>TransformX</span> <span class=n>sp</span> <span class=o>=</span> <span class=n>X</span><span class=p>::</span><span class=n>f</span><span class=p>;</span>
    <span class=n>X</span> <span class=n>x</span> <span class=o>=</span> <span class=k>new</span> <span class=n>X</span><span class=p>();</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>sp</span><span class=p>.</span><span class=na>transform</span><span class=p>(</span><span class=n>x</span><span class=p>));</span> <span class=c1>// [2]</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>x</span><span class=p>.</span><span class=na>f</span><span class=p>());</span> <span class=c1>// 同等效果</span>
  <span class=p>}</span>
<span class=p>}</span>
</code></pre></div> <p>输出结果：</p> <div class=highlight><pre><span></span><code>X::f()
X::f()
</code></pre></div> <p>截止目前，我们看到了与对应接口签名相同的方法引用。 在 <strong>[1]</strong>，我们尝试把 <code>X</code> 的 <code>f()</code> 方法引用赋值给 <strong>MakeString</strong>。结果即使 <code>make()</code> 与 <code>f()</code> 具有相同的签名，编译也会报“invalid method reference”（无效方法引用）错误。 这是因为实际上还有另一个隐藏的参数：我们的老朋友 <code>this</code>。 你不能在没有 <code>X</code> 对象的前提下调用 <code>f()</code>。 因此，<code>X :: f</code> 表示未绑定的方法引用，因为它尚未“绑定”到对象。</p> <p>要解决这个问题，我们需要一个 <code>X</code> 对象，所以我们的接口实际上需要一个额外的参数，如上例中的 <strong>TransformX</strong>。 如果将 <code>X :: f</code> 赋值给 <strong>TransformX</strong>，在 Java 中是允许的。我们必须做第二个心理调整——使用未绑定的引用时，函数式方法的签名（接口中的单个方法）不再与方法引用的签名完全匹配。 原因是：你需要一个对象来调用方法。</p> <p><strong>[2]</strong> 的结果有点像脑筋急转弯。我拿到未绑定的方法引用，并且调用它的<code>transform()</code>方法，将一个X类的对象传递给它，最后使得 <code>x.f()</code> 以某种方式被调用。Java知道它必须拿到第一个参数，该参数实际就是<code>this</code>，然后调用方法作用在它之上。</p> <p>如果你的方法有更多个参数，就以第一个参数接受<code>this</code>的模式来处理。</p> <div class=highlight><pre><span></span><code><span class=c1>// functional/MultiUnbound.java</span>

<span class=c1>// 未绑定的方法与多参数的结合运用</span>

<span class=kd>class</span> <span class=nc>This</span> <span class=p>{</span>
  <span class=kt>void</span> <span class=nf>two</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span><span class=p>,</span> <span class=kt>double</span> <span class=n>d</span><span class=p>)</span> <span class=p>{}</span>
  <span class=kt>void</span> <span class=nf>three</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span><span class=p>,</span> <span class=kt>double</span> <span class=n>d</span><span class=p>,</span> <span class=n>String</span> <span class=n>s</span><span class=p>)</span> <span class=p>{}</span>
  <span class=kt>void</span> <span class=nf>four</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span><span class=p>,</span> <span class=kt>double</span> <span class=n>d</span><span class=p>,</span> <span class=n>String</span> <span class=n>s</span><span class=p>,</span> <span class=kt>char</span> <span class=n>c</span><span class=p>)</span> <span class=p>{}</span>
<span class=p>}</span>

<span class=kd>interface</span> <span class=nc>TwoArgs</span> <span class=p>{</span>
  <span class=kt>void</span> <span class=nf>call2</span><span class=p>(</span><span class=n>This</span> <span class=n>athis</span><span class=p>,</span> <span class=kt>int</span> <span class=n>i</span><span class=p>,</span> <span class=kt>double</span> <span class=n>d</span><span class=p>);</span>
<span class=p>}</span>

<span class=kd>interface</span> <span class=nc>ThreeArgs</span> <span class=p>{</span>
  <span class=kt>void</span> <span class=nf>call3</span><span class=p>(</span><span class=n>This</span> <span class=n>athis</span><span class=p>,</span> <span class=kt>int</span> <span class=n>i</span><span class=p>,</span> <span class=kt>double</span> <span class=n>d</span><span class=p>,</span> <span class=n>String</span> <span class=n>s</span><span class=p>);</span>
<span class=p>}</span>

<span class=kd>interface</span> <span class=nc>FourArgs</span> <span class=p>{</span>
  <span class=kt>void</span> <span class=nf>call4</span><span class=p>(</span>
    <span class=n>This</span> <span class=n>athis</span><span class=p>,</span> <span class=kt>int</span> <span class=n>i</span><span class=p>,</span> <span class=kt>double</span> <span class=n>d</span><span class=p>,</span> <span class=n>String</span> <span class=n>s</span><span class=p>,</span> <span class=kt>char</span> <span class=n>c</span><span class=p>);</span>
<span class=p>}</span>

<span class=kd>public</span> <span class=kd>class</span> <span class=nc>MultiUnbound</span> <span class=p>{</span>
  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=p>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>TwoArgs</span> <span class=n>twoargs</span> <span class=o>=</span> <span class=n>This</span><span class=p>::</span><span class=n>two</span><span class=p>;</span>
    <span class=n>ThreeArgs</span> <span class=n>threeargs</span> <span class=o>=</span> <span class=n>This</span><span class=p>::</span><span class=n>three</span><span class=p>;</span>
    <span class=n>FourArgs</span> <span class=n>fourargs</span> <span class=o>=</span> <span class=n>This</span><span class=p>::</span><span class=n>four</span><span class=p>;</span>
    <span class=n>This</span> <span class=n>athis</span> <span class=o>=</span> <span class=k>new</span> <span class=n>This</span><span class=p>();</span>
    <span class=n>twoargs</span><span class=p>.</span><span class=na>call2</span><span class=p>(</span><span class=n>athis</span><span class=p>,</span> <span class=mi>11</span><span class=p>,</span> <span class=mf>3.14</span><span class=p>);</span>
    <span class=n>threeargs</span><span class=p>.</span><span class=na>call3</span><span class=p>(</span><span class=n>athis</span><span class=p>,</span> <span class=mi>11</span><span class=p>,</span> <span class=mf>3.14</span><span class=p>,</span> <span class=s>&quot;Three&quot;</span><span class=p>);</span>
    <span class=n>fourargs</span><span class=p>.</span><span class=na>call4</span><span class=p>(</span><span class=n>athis</span><span class=p>,</span> <span class=mi>11</span><span class=p>,</span> <span class=mf>3.14</span><span class=p>,</span> <span class=s>&quot;Four&quot;</span><span class=p>,</span> <span class=sc>&#39;Z&#39;</span><span class=p>);</span>
  <span class=p>}</span>
<span class=p>}</span>
</code></pre></div> <p>需要指出的是，我将类命名为 <strong>This</strong>，并将函数式方法的第一个参数命名为 <strong>athis</strong>，但你在生产级代码中应该使用其他名字，以防止混淆。</p> <h3 id=_6>构造函数引用<a class=headerlink href=#_6 title="Permanent link">#</a></h3> <p>你还可以捕获构造函数的引用，然后通过引用调用该构造函数。</p> <div class=highlight><pre><span></span><code><span class=c1>// functional/CtorReference.java</span>

<span class=kd>class</span> <span class=nc>Dog</span> <span class=p>{</span>
  <span class=n>String</span> <span class=n>name</span><span class=p>;</span>
  <span class=kt>int</span> <span class=n>age</span> <span class=o>=</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span> <span class=c1>// For &quot;unknown&quot;</span>
  <span class=n>Dog</span><span class=p>()</span> <span class=p>{</span> <span class=n>name</span> <span class=o>=</span> <span class=s>&quot;stray&quot;</span><span class=p>;</span> <span class=p>}</span>
  <span class=n>Dog</span><span class=p>(</span><span class=n>String</span> <span class=n>nm</span><span class=p>)</span> <span class=p>{</span> <span class=n>name</span> <span class=o>=</span> <span class=n>nm</span><span class=p>;</span> <span class=p>}</span>
  <span class=n>Dog</span><span class=p>(</span><span class=n>String</span> <span class=n>nm</span><span class=p>,</span> <span class=kt>int</span> <span class=n>yrs</span><span class=p>)</span> <span class=p>{</span> <span class=n>name</span> <span class=o>=</span> <span class=n>nm</span><span class=p>;</span> <span class=n>age</span> <span class=o>=</span> <span class=n>yrs</span><span class=p>;</span> <span class=p>}</span>
<span class=p>}</span>

<span class=kd>interface</span> <span class=nc>MakeNoArgs</span> <span class=p>{</span>
  <span class=n>Dog</span> <span class=nf>make</span><span class=p>();</span>
<span class=p>}</span>

<span class=kd>interface</span> <span class=nc>Make1Arg</span> <span class=p>{</span>
  <span class=n>Dog</span> <span class=nf>make</span><span class=p>(</span><span class=n>String</span> <span class=n>nm</span><span class=p>);</span>
<span class=p>}</span>

<span class=kd>interface</span> <span class=nc>Make2Args</span> <span class=p>{</span>
  <span class=n>Dog</span> <span class=nf>make</span><span class=p>(</span><span class=n>String</span> <span class=n>nm</span><span class=p>,</span> <span class=kt>int</span> <span class=n>age</span><span class=p>);</span>
<span class=p>}</span>

<span class=kd>public</span> <span class=kd>class</span> <span class=nc>CtorReference</span> <span class=p>{</span>
  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=p>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>MakeNoArgs</span> <span class=n>mna</span> <span class=o>=</span> <span class=n>Dog</span><span class=p>::</span><span class=k>new</span><span class=p>;</span> <span class=c1>// [1]</span>
    <span class=n>Make1Arg</span> <span class=n>m1a</span> <span class=o>=</span> <span class=n>Dog</span><span class=p>::</span><span class=k>new</span><span class=p>;</span>   <span class=c1>// [2]</span>
    <span class=n>Make2Args</span> <span class=n>m2a</span> <span class=o>=</span> <span class=n>Dog</span><span class=p>::</span><span class=k>new</span><span class=p>;</span>  <span class=c1>// [3]</span>

    <span class=n>Dog</span> <span class=n>dn</span> <span class=o>=</span> <span class=n>mna</span><span class=p>.</span><span class=na>make</span><span class=p>();</span>
    <span class=n>Dog</span> <span class=n>d1</span> <span class=o>=</span> <span class=n>m1a</span><span class=p>.</span><span class=na>make</span><span class=p>(</span><span class=s>&quot;Comet&quot;</span><span class=p>);</span>
    <span class=n>Dog</span> <span class=n>d2</span> <span class=o>=</span> <span class=n>m2a</span><span class=p>.</span><span class=na>make</span><span class=p>(</span><span class=s>&quot;Ralph&quot;</span><span class=p>,</span> <span class=mi>4</span><span class=p>);</span>
  <span class=p>}</span>
<span class=p>}</span>
</code></pre></div> <p><strong>Dog</strong> 有三个构造函数，函数式接口内的 <code>make()</code> 方法反映了构造函数参数列表（ <code>make()</code> 方法名称可以不同）。</p> <p><strong>注意</strong>我们如何对 <strong>[1]</strong>，<strong>[2]</strong> 和 <strong>[3]</strong> 中的每一个使用 <code>Dog :: new</code>。 这三个构造函数只有一个相同名称：<code>:: new</code>，但在每种情况下赋值给不同的接口，编译器可以从中知道具体使用哪个构造函数。</p> <p>编译器知道调用函数式方法（本例中为 <code>make()</code>）就相当于调用构造函数。</p> <!-- Functional Interfaces --> <h2 id=_7>函数式接口<a class=headerlink href=#_7 title="Permanent link">#</a></h2> <p>方法引用和 Lambda 表达式都必须被赋值，同时赋值需要类型信息才能使编译器保证类型的正确性。尤其是Lambda 表达式，它引入了新的要求。 代码示例：</p> <div class=highlight><pre><span></span><code><span class=n>x</span> <span class=o>-&gt;</span> <span class=n>x</span><span class=p>.</span><span class=na>toString</span><span class=p>()</span>
</code></pre></div> <p>我们清楚这里返回类型必须是 <strong>String</strong>，但 <code>x</code> 是什么类型呢？</p> <p>Lambda 表达式包含类型推导（编译器会自动推导出类型信息，避免了程序员显式地声明）。编译器必须能够以某种方式推导出 <code>x</code> 的类型。</p> <p>下面是第二个代码示例：</p> <div class=highlight><pre><span></span><code><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>x</span> <span class=o>+</span> <span class=n>y</span>
</code></pre></div> <p>现在 <code>x</code> 和 <code>y</code> 可以是任何支持 <code>+</code> 运算符连接的数据类型，可以是两个不同的数值类型或者是 一个 <strong>String</strong> 加任意一种可自动转换为 <strong>String</strong> 的数据类型（这包括了大多数类型）。 但是，当 Lambda 表达式被赋值时，编译器必须确定 <code>x</code> 和 <code>y</code> 的确切类型以生成正确的代码。</p> <p>该问题也适用于方法引用。 假设你要传递 <code>System.out :: println</code> 到你正在编写的方法 ，你怎么知道传递给方法的参数的类型？</p> <p>为了解决这个问题，Java 8 引入了 <code>java.util.function</code> 包。它包含一组接口，这些接口是 Lambda 表达式和方法引用的目标类型。 每个接口只包含一个抽象方法，称为函数式方法。</p> <p>在编写接口时，可以使用 <code>@FunctionalInterface</code> 注解强制执行此“函数式方法”模式：</p> <div class=highlight><pre><span></span><code><span class=c1>// functional/FunctionalAnnotation.java</span>

<span class=nd>@FunctionalInterface</span>
<span class=kd>interface</span> <span class=nc>Functional</span> <span class=p>{</span>
  <span class=n>String</span> <span class=nf>goodbye</span><span class=p>(</span><span class=n>String</span> <span class=n>arg</span><span class=p>);</span>
<span class=p>}</span>

<span class=kd>interface</span> <span class=nc>FunctionalNoAnn</span> <span class=p>{</span>
  <span class=n>String</span> <span class=nf>goodbye</span><span class=p>(</span><span class=n>String</span> <span class=n>arg</span><span class=p>);</span>
<span class=p>}</span>

<span class=cm>/*</span>
<span class=cm>@FunctionalInterface</span>
<span class=cm>interface NotFunctional {</span>
<span class=cm>  String goodbye(String arg);</span>
<span class=cm>  String hello(String arg);</span>
<span class=cm>}</span>
<span class=cm>产生错误信息:</span>
<span class=cm>NotFunctional is not a functional interface</span>
<span class=cm>multiple non-overriding abstract methods</span>
<span class=cm>found in interface NotFunctional</span>
<span class=cm>*/</span>

<span class=kd>public</span> <span class=kd>class</span> <span class=nc>FunctionalAnnotation</span> <span class=p>{</span>
  <span class=kd>public</span> <span class=n>String</span> <span class=nf>goodbye</span><span class=p>(</span><span class=n>String</span> <span class=n>arg</span><span class=p>)</span> <span class=p>{</span>
    <span class=k>return</span> <span class=s>&quot;Goodbye, &quot;</span> <span class=o>+</span> <span class=n>arg</span><span class=p>;</span>
  <span class=p>}</span>
  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=p>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>FunctionalAnnotation</span> <span class=n>fa</span> <span class=o>=</span>
      <span class=k>new</span> <span class=n>FunctionalAnnotation</span><span class=p>();</span>
    <span class=n>Functional</span> <span class=n>f</span> <span class=o>=</span> <span class=n>fa</span><span class=p>::</span><span class=n>goodbye</span><span class=p>;</span>
    <span class=n>FunctionalNoAnn</span> <span class=n>fna</span> <span class=o>=</span> <span class=n>fa</span><span class=p>::</span><span class=n>goodbye</span><span class=p>;</span>
    <span class=c1>// Functional fac = fa; // Incompatible</span>
    <span class=n>Functional</span> <span class=n>fl</span> <span class=o>=</span> <span class=n>a</span> <span class=o>-&gt;</span> <span class=s>&quot;Goodbye, &quot;</span> <span class=o>+</span> <span class=n>a</span><span class=p>;</span>
    <span class=n>FunctionalNoAnn</span> <span class=n>fnal</span> <span class=o>=</span> <span class=n>a</span> <span class=o>-&gt;</span> <span class=s>&quot;Goodbye, &quot;</span> <span class=o>+</span> <span class=n>a</span><span class=p>;</span>
  <span class=p>}</span>
<span class=p>}</span>
</code></pre></div> <p><code>@FunctionalInterface</code> 注解是可选的; Java 在 <code>main()</code> 中把 <strong>Functional</strong> 和 <strong>FunctionalNoAnn</strong> 都当作函数式接口。 在 <code>NotFunctional</code> 的定义中可看到<code>@FunctionalInterface</code> 的作用：接口中如果有多个抽象方法则会产生编译期错误。</p> <p>仔细观察在定义 <code>f</code> 和 <code>fna</code> 时发生了什么。 <code>Functional</code> 和 <code>FunctionalNoAnn</code> 定义接口，然而被赋值的只是方法 <code>goodbye()</code>。首先，这只是一个方法而不是类；其次，它甚至都不是实现了该接口的类中的方法。这是添加到Java 8中的一点小魔法：如果将方法引用或 Lambda 表达式赋值给函数式接口（类型需要匹配），Java 会适配你的赋值到目标接口。 编译器会在后台把方法引用或 Lambda 表达式包装进实现目标接口的类的实例中。</p> <p>尽管 <code>FunctionalAnnotation</code> 确实适合 <code>Functional</code> 模型，但 Java不允许我们像<code>fac</code>定义中的那样，将 <code>FunctionalAnnotation</code> 直接赋值给 <code>Functional</code>，因为 <code>FunctionalAnnotation</code> 并没有显式地去实现 <code>Functional</code> 接口。唯一的惊喜是，Java 8 允许我们将函数赋值给接口，这样的语法更加简单漂亮。</p> <p><code>java.util.function</code> 包旨在创建一组完整的目标接口，使得我们一般情况下不需再定义自己的接口。主要因为基本类型的存在，导致预定义的接口数量有少许增加。 如果你了解命名模式，顾名思义就能知道特定接口的作用。</p> <p>以下是基本命名准则：</p> <ol> <li> <p>如果只处理对象而非基本类型，名称则为 <code>Function</code>，<code>Consumer</code>，<code>Predicate</code> 等。参数类型通过泛型添加。</p> </li> <li> <p>如果接收的参数是基本类型，则由名称的第一部分表示，如 <code>LongConsumer</code>，<code>DoubleFunction</code>，<code>IntPredicate</code> 等，但返回基本类型的 <code>Supplier</code> 接口例外。</p> </li> <li> <p>如果返回值为基本类型，则用 <code>To</code> 表示，如 <code>ToLongFunction &lt;T&gt;</code> 和 <code>IntToLongFunction</code>。</p> </li> <li> <p>如果返回值类型与参数类型一致，则是一个运算符：单个参数使用 <code>UnaryOperator</code>，两个参数使用 <code>BinaryOperator</code>。</p> </li> <li> <p>如果接收两个参数且返回值为布尔值，则是一个谓词（Predicate）。</p> </li> <li> <p>如果接收的两个参数类型不同，则名称中有一个 <code>Bi</code>。</p> </li> </ol> <p>下表描述了 <code>java.util.function</code> 中的目标类型（包括例外情况）：</p> <table> <thead> <tr> <th align=left><strong>特征</strong></th> <th align=center><strong>函数式方法名</strong></th> <th align=center><strong>示例</strong></th> </tr> </thead> <tbody> <tr> <td align=left>无参数； <br> 无返回值</td> <td align=center><strong>Runnable</strong> <br> (java.lang) <br> <code>run()</code></td> <td align=center><strong>Runnable</strong></td> </tr> <tr> <td align=left>无参数； <br> 返回类型任意</td> <td align=center><strong>Supplier</strong> <br> <code>get()</code> <br> <code>getAs类型()</code></td> <td align=center><strong>Supplier<code>&lt;T&gt;</code> <br> BooleanSupplier <br> IntSupplier <br> LongSupplier <br> DoubleSupplier</strong></td> </tr> <tr> <td align=left>无参数； <br> 返回类型任意</td> <td align=center><strong>Callable</strong> <br> (java.util.concurrent) <br> <code>call()</code></td> <td align=center><strong>Callable<code>&lt;V&gt;</code></strong></td> </tr> <tr> <td align=left>1 参数； <br> 无返回值</td> <td align=center><strong>Consumer</strong> <br> <code>accept()</code></td> <td align=center><strong><code>Consumer&lt;T&gt;</code> <br> IntConsumer <br> LongConsumer <br> DoubleConsumer</strong></td> </tr> <tr> <td align=left>2 参数 <strong>Consumer</strong></td> <td align=center><strong>BiConsumer</strong> <br> <code>accept()</code></td> <td align=center><strong><code>BiConsumer&lt;T,U&gt;</code></strong></td> </tr> <tr> <td align=left>2 参数 <strong>Consumer</strong>； <br> 1 引用； <br> 1 基本类型</td> <td align=center><strong>Obj类型Consumer</strong> <br> <code>accept()</code></td> <td align=center><strong><code>ObjIntConsumer&lt;T&gt;</code> <br> <code>ObjLongConsumer&lt;T&gt;</code> <br> <code>ObjDoubleConsumer&lt;T&gt;</code></strong></td> </tr> <tr> <td align=left>1 参数； <br> 返回类型不同</td> <td align=center><strong>Function</strong> <br> <code>apply()</code> <br> <strong>To类型</strong> 和 <strong>类型To类型</strong> <br> <code>applyAs类型()</code></td> <td align=center><strong>Function<code>&lt;T,R&gt;</code> <br> IntFunction<code>&lt;R&gt;</code> <br> <code>LongFunction&lt;R&gt;</code> <br> DoubleFunction<code>&lt;R&gt;</code> <br> ToIntFunction<code>&lt;T&gt;</code> <br> <code>ToLongFunction&lt;T&gt;</code> <br> <code>ToDoubleFunction&lt;T&gt;</code> <br> IntToLongFunction <br> IntToDoubleFunction <br> LongToIntFunction <br> LongToDoubleFunction <br> DoubleToIntFunction <br> DoubleToLongFunction</strong></td> </tr> <tr> <td align=left>1 参数； <br> 返回类型相同</td> <td align=center><strong>UnaryOperator</strong> <br> <code>apply()</code></td> <td align=center><strong><code>UnaryOperator&lt;T&gt;</code> <br> IntUnaryOperator <br> LongUnaryOperator <br> DoubleUnaryOperator</strong></td> </tr> <tr> <td align=left>2 参数类型相同； <br> 返回类型相同</td> <td align=center><strong>BinaryOperator</strong> <br> <code>apply()</code></td> <td align=center><strong><code>BinaryOperator&lt;T&gt;</code> <br> IntBinaryOperator <br> LongBinaryOperator <br> DoubleBinaryOperator</strong></td> </tr> <tr> <td align=left>2 参数类型相同; <br> 返回整型</td> <td align=center>Comparator <br> (java.util) <br> <code>compare()</code></td> <td align=center><strong><code>Comparator&lt;T&gt;</code></strong></td> </tr> <tr> <td align=left>2 参数； <br> 返回布尔型</td> <td align=center><strong>Predicate</strong> <br> <code>test()</code></td> <td align=center><strong><code>Predicate&lt;T&gt;</code> <br> <code>BiPredicate&lt;T,U&gt;</code> <br> IntPredicate <br> LongPredicate <br> DoublePredicate</strong></td> </tr> <tr> <td align=left>参数基本类型； <br> 返回基本类型</td> <td align=center><strong>类型To类型Function</strong> <br> <code>applyAs类型()</code></td> <td align=center><strong>IntToLongFunction <br> IntToDoubleFunction <br> LongToIntFunction <br> LongToDoubleFunction <br> DoubleToIntFunction <br> DoubleToLongFunction</strong></td> </tr> <tr> <td align=left>2 参数类型不同</td> <td align=center><strong>Bi操作</strong> <br> (不同方法名)</td> <td align=center><strong><code>BiFunction&lt;T,U,R&gt;</code> <br> <code>BiConsumer&lt;T,U&gt;</code> <br> <code>BiPredicate&lt;T,U&gt;</code> <br> <code>ToIntBiFunction&lt;T,U&gt;</code> <br> <code>ToLongBiFunction&lt;T,U&gt;</code> <br> <code>ToDoubleBiFunction&lt;T&gt;</code></strong></td> </tr> </tbody> </table> <p>此表仅提供些常规方案。通过上表，你应该或多或少能自行推导出你所需要的函数式接口。</p> <p>可以看出，在创建 <code>java.util.function</code> 时，设计者们做出了一些选择。 </p> <p>例如，为什么没有 <code>IntComparator</code>，<code>LongComparator</code> 和 <code>DoubleComparator</code> 呢？有 <code>BooleanSupplier</code> 却没有其他表示 <strong>Boolean</strong> 的接口；有通用的 <code>BiConsumer</code> 却没有用于 <strong>int</strong>，<strong>long</strong> 和 <strong>double</strong> 的 <code>BiConsumers</code> 变体（我理解他们为什么放弃这些接口）。这到底是疏忽还是有人认为其他组合使用得很少呢（他们是如何得出这个结论的）？</p> <p>你还可以看到基本类型给 Java 添加了多少复杂性。基于效率方面的考虑（问题之后有所缓解），该语言的第一版中就包含了基本类型。现在，在语言的生命周期中，我们仍然会受到语言设计选择不佳的影响。</p> <p>下面枚举了基于 Lambda 表达式的所有不同 <strong>Function</strong> 变体的示例：</p> <div class=highlight><pre><span></span><code><span class=c1>// functional/FunctionVariants.java</span>

<span class=kn>import</span> <span class=nn>java.util.function.*</span><span class=p>;</span>

<span class=kd>class</span> <span class=nc>Foo</span> <span class=p>{}</span>

<span class=kd>class</span> <span class=nc>Bar</span> <span class=p>{</span>
  <span class=n>Foo</span> <span class=n>f</span><span class=p>;</span>
  <span class=n>Bar</span><span class=p>(</span><span class=n>Foo</span> <span class=n>f</span><span class=p>)</span> <span class=p>{</span> <span class=k>this</span><span class=p>.</span><span class=na>f</span> <span class=o>=</span> <span class=n>f</span><span class=p>;</span> <span class=p>}</span>
<span class=p>}</span>

<span class=kd>class</span> <span class=nc>IBaz</span> <span class=p>{</span>
  <span class=kt>int</span> <span class=n>i</span><span class=p>;</span>
  <span class=n>IBaz</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span><span class=p>)</span> <span class=p>{</span>
    <span class=k>this</span><span class=p>.</span><span class=na>i</span> <span class=o>=</span> <span class=n>i</span><span class=p>;</span>
  <span class=p>}</span>
<span class=p>}</span>

<span class=kd>class</span> <span class=nc>LBaz</span> <span class=p>{</span>
  <span class=kt>long</span> <span class=n>l</span><span class=p>;</span>
  <span class=n>LBaz</span><span class=p>(</span><span class=kt>long</span> <span class=n>l</span><span class=p>)</span> <span class=p>{</span>
    <span class=k>this</span><span class=p>.</span><span class=na>l</span> <span class=o>=</span> <span class=n>l</span><span class=p>;</span>
  <span class=p>}</span>
<span class=p>}</span>

<span class=kd>class</span> <span class=nc>DBaz</span> <span class=p>{</span>
  <span class=kt>double</span> <span class=n>d</span><span class=p>;</span>
  <span class=n>DBaz</span><span class=p>(</span><span class=kt>double</span> <span class=n>d</span><span class=p>)</span> <span class=p>{</span>
    <span class=k>this</span><span class=p>.</span><span class=na>d</span> <span class=o>=</span> <span class=n>d</span><span class=p>;</span>
  <span class=p>}</span>
<span class=p>}</span>

<span class=kd>public</span> <span class=kd>class</span> <span class=nc>FunctionVariants</span> <span class=p>{</span>
  <span class=kd>static</span> <span class=n>Function</span><span class=o>&lt;</span><span class=n>Foo</span><span class=p>,</span><span class=n>Bar</span><span class=o>&gt;</span> <span class=n>f1</span> <span class=o>=</span> <span class=n>f</span> <span class=o>-&gt;</span> <span class=k>new</span> <span class=n>Bar</span><span class=p>(</span><span class=n>f</span><span class=p>);</span>
  <span class=kd>static</span> <span class=n>IntFunction</span><span class=o>&lt;</span><span class=n>IBaz</span><span class=o>&gt;</span> <span class=n>f2</span> <span class=o>=</span> <span class=n>i</span> <span class=o>-&gt;</span> <span class=k>new</span> <span class=n>IBaz</span><span class=p>(</span><span class=n>i</span><span class=p>);</span>
  <span class=kd>static</span> <span class=n>LongFunction</span><span class=o>&lt;</span><span class=n>LBaz</span><span class=o>&gt;</span> <span class=n>f3</span> <span class=o>=</span> <span class=n>l</span> <span class=o>-&gt;</span> <span class=k>new</span> <span class=n>LBaz</span><span class=p>(</span><span class=n>l</span><span class=p>);</span>
  <span class=kd>static</span> <span class=n>DoubleFunction</span><span class=o>&lt;</span><span class=n>DBaz</span><span class=o>&gt;</span> <span class=n>f4</span> <span class=o>=</span> <span class=n>d</span> <span class=o>-&gt;</span> <span class=k>new</span> <span class=n>DBaz</span><span class=p>(</span><span class=n>d</span><span class=p>);</span>
  <span class=kd>static</span> <span class=n>ToIntFunction</span><span class=o>&lt;</span><span class=n>IBaz</span><span class=o>&gt;</span> <span class=n>f5</span> <span class=o>=</span> <span class=n>ib</span> <span class=o>-&gt;</span> <span class=n>ib</span><span class=p>.</span><span class=na>i</span><span class=p>;</span>
  <span class=kd>static</span> <span class=n>ToLongFunction</span><span class=o>&lt;</span><span class=n>LBaz</span><span class=o>&gt;</span> <span class=n>f6</span> <span class=o>=</span> <span class=n>lb</span> <span class=o>-&gt;</span> <span class=n>lb</span><span class=p>.</span><span class=na>l</span><span class=p>;</span>
  <span class=kd>static</span> <span class=n>ToDoubleFunction</span><span class=o>&lt;</span><span class=n>DBaz</span><span class=o>&gt;</span> <span class=n>f7</span> <span class=o>=</span> <span class=n>db</span> <span class=o>-&gt;</span> <span class=n>db</span><span class=p>.</span><span class=na>d</span><span class=p>;</span>
  <span class=kd>static</span> <span class=n>IntToLongFunction</span> <span class=n>f8</span> <span class=o>=</span> <span class=n>i</span> <span class=o>-&gt;</span> <span class=n>i</span><span class=p>;</span>
  <span class=kd>static</span> <span class=n>IntToDoubleFunction</span> <span class=n>f9</span> <span class=o>=</span> <span class=n>i</span> <span class=o>-&gt;</span> <span class=n>i</span><span class=p>;</span>
  <span class=kd>static</span> <span class=n>LongToIntFunction</span> <span class=n>f10</span> <span class=o>=</span> <span class=n>l</span> <span class=o>-&gt;</span> <span class=p>(</span><span class=kt>int</span><span class=p>)</span><span class=n>l</span><span class=p>;</span>
  <span class=kd>static</span> <span class=n>LongToDoubleFunction</span> <span class=n>f11</span> <span class=o>=</span> <span class=n>l</span> <span class=o>-&gt;</span> <span class=n>l</span><span class=p>;</span>
  <span class=kd>static</span> <span class=n>DoubleToIntFunction</span> <span class=n>f12</span> <span class=o>=</span> <span class=n>d</span> <span class=o>-&gt;</span> <span class=p>(</span><span class=kt>int</span><span class=p>)</span><span class=n>d</span><span class=p>;</span>
  <span class=kd>static</span> <span class=n>DoubleToLongFunction</span> <span class=n>f13</span> <span class=o>=</span> <span class=n>d</span> <span class=o>-&gt;</span> <span class=p>(</span><span class=kt>long</span><span class=p>)</span><span class=n>d</span><span class=p>;</span>

  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=p>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>Bar</span> <span class=n>b</span> <span class=o>=</span> <span class=n>f1</span><span class=p>.</span><span class=na>apply</span><span class=p>(</span><span class=k>new</span> <span class=n>Foo</span><span class=p>());</span>
    <span class=n>IBaz</span> <span class=n>ib</span> <span class=o>=</span> <span class=n>f2</span><span class=p>.</span><span class=na>apply</span><span class=p>(</span><span class=mi>11</span><span class=p>);</span>
    <span class=n>LBaz</span> <span class=n>lb</span> <span class=o>=</span> <span class=n>f3</span><span class=p>.</span><span class=na>apply</span><span class=p>(</span><span class=mi>11</span><span class=p>);</span>
    <span class=n>DBaz</span> <span class=n>db</span> <span class=o>=</span> <span class=n>f4</span><span class=p>.</span><span class=na>apply</span><span class=p>(</span><span class=mi>11</span><span class=p>);</span>
    <span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=n>f5</span><span class=p>.</span><span class=na>applyAsInt</span><span class=p>(</span><span class=n>ib</span><span class=p>);</span>
    <span class=kt>long</span> <span class=n>l</span> <span class=o>=</span> <span class=n>f6</span><span class=p>.</span><span class=na>applyAsLong</span><span class=p>(</span><span class=n>lb</span><span class=p>);</span>
    <span class=kt>double</span> <span class=n>d</span> <span class=o>=</span> <span class=n>f7</span><span class=p>.</span><span class=na>applyAsDouble</span><span class=p>(</span><span class=n>db</span><span class=p>);</span>
    <span class=n>l</span> <span class=o>=</span> <span class=n>f8</span><span class=p>.</span><span class=na>applyAsLong</span><span class=p>(</span><span class=mi>12</span><span class=p>);</span>
    <span class=n>d</span> <span class=o>=</span> <span class=n>f9</span><span class=p>.</span><span class=na>applyAsDouble</span><span class=p>(</span><span class=mi>12</span><span class=p>);</span>
    <span class=n>i</span> <span class=o>=</span> <span class=n>f10</span><span class=p>.</span><span class=na>applyAsInt</span><span class=p>(</span><span class=mi>12</span><span class=p>);</span>
    <span class=n>d</span> <span class=o>=</span> <span class=n>f11</span><span class=p>.</span><span class=na>applyAsDouble</span><span class=p>(</span><span class=mi>12</span><span class=p>);</span>
    <span class=n>i</span> <span class=o>=</span> <span class=n>f12</span><span class=p>.</span><span class=na>applyAsInt</span><span class=p>(</span><span class=mf>13.0</span><span class=p>);</span>
    <span class=n>l</span> <span class=o>=</span> <span class=n>f13</span><span class=p>.</span><span class=na>applyAsLong</span><span class=p>(</span><span class=mf>13.0</span><span class=p>);</span>
  <span class=p>}</span>
<span class=p>}</span>
</code></pre></div> <p>这些 Lambda 表达式尝试生成适合函数签名的最简代码。 在某些情况下，有必要进行强制类型转换，否则编译器会报截断错误。</p> <p>主方法中的每个测试都显示了 <code>Function</code> 接口中不同类型的 <code>apply()</code> 方法。 每个都产生一个与其关联的 Lambda 表达式的调用。</p> <p>方法引用有自己的小魔法：</p> <div class=highlight><pre><span></span><code><span class=o>/</span> <span class=n>functional</span><span class=o>/</span><span class=n>MethodConversion</span><span class=p>.</span><span class=na>java</span>

<span class=kn>import</span> <span class=nn>java.util.function.*</span><span class=p>;</span>

<span class=kd>class</span> <span class=nc>In1</span> <span class=p>{}</span>
<span class=kd>class</span> <span class=nc>In2</span> <span class=p>{}</span>

<span class=kd>public</span> <span class=kd>class</span> <span class=nc>MethodConversion</span> <span class=p>{</span>
  <span class=kd>static</span> <span class=kt>void</span> <span class=nf>accept</span><span class=p>(</span><span class=n>In1</span> <span class=n>i1</span><span class=p>,</span> <span class=n>In2</span> <span class=n>i2</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&quot;accept()&quot;</span><span class=p>);</span>
  <span class=p>}</span>
  <span class=kd>static</span> <span class=kt>void</span> <span class=nf>someOtherName</span><span class=p>(</span><span class=n>In1</span> <span class=n>i1</span><span class=p>,</span> <span class=n>In2</span> <span class=n>i2</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&quot;someOtherName()&quot;</span><span class=p>);</span>
  <span class=p>}</span>
  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=p>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>BiConsumer</span><span class=o>&lt;</span><span class=n>In1</span><span class=p>,</span><span class=n>In2</span><span class=o>&gt;</span> <span class=n>bic</span><span class=p>;</span>

    <span class=n>bic</span> <span class=o>=</span> <span class=n>MethodConversion</span><span class=p>::</span><span class=n>accept</span><span class=p>;</span>
    <span class=n>bic</span><span class=p>.</span><span class=na>accept</span><span class=p>(</span><span class=k>new</span> <span class=n>In1</span><span class=p>(),</span> <span class=k>new</span> <span class=n>In2</span><span class=p>());</span>

    <span class=n>bic</span> <span class=o>=</span> <span class=n>MethodConversion</span><span class=p>::</span><span class=n>someOtherName</span><span class=p>;</span>
    <span class=c1>// bic.someOtherName(new In1(), new In2()); // Nope</span>
    <span class=n>bic</span><span class=p>.</span><span class=na>accept</span><span class=p>(</span><span class=k>new</span> <span class=n>In1</span><span class=p>(),</span> <span class=k>new</span> <span class=n>In2</span><span class=p>());</span>
  <span class=p>}</span>
<span class=p>}</span>
</code></pre></div> <p>输出结果：</p> <div class=highlight><pre><span></span><code>accept()
someOtherName()
</code></pre></div> <p>查看 <code>BiConsumer</code> 的文档，你会看到 <code>accept()</code> 方法。 实际上，如果我们将方法命名为 <code>accept()</code>，它就可以作为方法引用。 但是我们也可用不同的名称，比如 <code>someOtherName()</code>。只要参数类型、返回类型与 <code>BiConsumer</code> 的 <code>accept()</code> 相同即可。</p> <p>因此，在使用函数接口时，名称无关紧要——只要参数类型和返回类型相同。 Java 会将你的方法映射到接口方法。 要调用方法，可以调用接口的函数式方法名（在本例中为 <code>accept()</code>），而不是你的方法名。</p> <p>现在我们来看看，将方法引用应用于基于类的函数式接口（即那些不包含基本类型的函数式接口）。下面的例子中，我创建了适合函数式方法签名的最简单的方法：</p> <div class=highlight><pre><span></span><code><span class=c1>// functional/ClassFunctionals.java</span>

<span class=kn>import</span> <span class=nn>java.util.*</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>java.util.function.*</span><span class=p>;</span>

<span class=kd>class</span> <span class=nc>AA</span> <span class=p>{}</span>
<span class=kd>class</span> <span class=nc>BB</span> <span class=p>{}</span>
<span class=kd>class</span> <span class=nc>CC</span> <span class=p>{}</span>

<span class=kd>public</span> <span class=kd>class</span> <span class=nc>ClassFunctionals</span> <span class=p>{</span>
  <span class=kd>static</span> <span class=n>AA</span> <span class=nf>f1</span><span class=p>()</span> <span class=p>{</span> <span class=k>return</span> <span class=k>new</span> <span class=n>AA</span><span class=p>();</span> <span class=p>}</span>
  <span class=kd>static</span> <span class=kt>int</span> <span class=nf>f2</span><span class=p>(</span><span class=n>AA</span> <span class=n>aa1</span><span class=p>,</span> <span class=n>AA</span> <span class=n>aa2</span><span class=p>)</span> <span class=p>{</span> <span class=k>return</span> <span class=mi>1</span><span class=p>;</span> <span class=p>}</span>
  <span class=kd>static</span> <span class=kt>void</span> <span class=nf>f3</span><span class=p>(</span><span class=n>AA</span> <span class=n>aa</span><span class=p>)</span> <span class=p>{}</span>
  <span class=kd>static</span> <span class=kt>void</span> <span class=nf>f4</span><span class=p>(</span><span class=n>AA</span> <span class=n>aa</span><span class=p>,</span> <span class=n>BB</span> <span class=n>bb</span><span class=p>)</span> <span class=p>{}</span>
  <span class=kd>static</span> <span class=n>CC</span> <span class=nf>f5</span><span class=p>(</span><span class=n>AA</span> <span class=n>aa</span><span class=p>)</span> <span class=p>{</span> <span class=k>return</span> <span class=k>new</span> <span class=n>CC</span><span class=p>();</span> <span class=p>}</span>
  <span class=kd>static</span> <span class=n>CC</span> <span class=nf>f6</span><span class=p>(</span><span class=n>AA</span> <span class=n>aa</span><span class=p>,</span> <span class=n>BB</span> <span class=n>bb</span><span class=p>)</span> <span class=p>{</span> <span class=k>return</span> <span class=k>new</span> <span class=n>CC</span><span class=p>();</span> <span class=p>}</span>
  <span class=kd>static</span> <span class=kt>boolean</span> <span class=nf>f7</span><span class=p>(</span><span class=n>AA</span> <span class=n>aa</span><span class=p>)</span> <span class=p>{</span> <span class=k>return</span> <span class=kc>true</span><span class=p>;</span> <span class=p>}</span>
  <span class=kd>static</span> <span class=kt>boolean</span> <span class=nf>f8</span><span class=p>(</span><span class=n>AA</span> <span class=n>aa</span><span class=p>,</span> <span class=n>BB</span> <span class=n>bb</span><span class=p>)</span> <span class=p>{</span> <span class=k>return</span> <span class=kc>true</span><span class=p>;</span> <span class=p>}</span>
  <span class=kd>static</span> <span class=n>AA</span> <span class=nf>f9</span><span class=p>(</span><span class=n>AA</span> <span class=n>aa</span><span class=p>)</span> <span class=p>{</span> <span class=k>return</span> <span class=k>new</span> <span class=n>AA</span><span class=p>();</span> <span class=p>}</span>
  <span class=kd>static</span> <span class=n>AA</span> <span class=nf>f10</span><span class=p>(</span><span class=n>AA</span> <span class=n>aa1</span><span class=p>,</span> <span class=n>AA</span> <span class=n>aa2</span><span class=p>)</span> <span class=p>{</span> <span class=k>return</span> <span class=k>new</span> <span class=n>AA</span><span class=p>();</span> <span class=p>}</span>
  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=p>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>Supplier</span><span class=o>&lt;</span><span class=n>AA</span><span class=o>&gt;</span> <span class=n>s</span> <span class=o>=</span> <span class=n>ClassFunctionals</span><span class=p>::</span><span class=n>f1</span><span class=p>;</span>
    <span class=n>s</span><span class=p>.</span><span class=na>get</span><span class=p>();</span>
    <span class=n>Comparator</span><span class=o>&lt;</span><span class=n>AA</span><span class=o>&gt;</span> <span class=n>c</span> <span class=o>=</span> <span class=n>ClassFunctionals</span><span class=p>::</span><span class=n>f2</span><span class=p>;</span>
    <span class=n>c</span><span class=p>.</span><span class=na>compare</span><span class=p>(</span><span class=k>new</span> <span class=n>AA</span><span class=p>(),</span> <span class=k>new</span> <span class=n>AA</span><span class=p>());</span>
    <span class=n>Consumer</span><span class=o>&lt;</span><span class=n>AA</span><span class=o>&gt;</span> <span class=n>cons</span> <span class=o>=</span> <span class=n>ClassFunctionals</span><span class=p>::</span><span class=n>f3</span><span class=p>;</span>
    <span class=n>cons</span><span class=p>.</span><span class=na>accept</span><span class=p>(</span><span class=k>new</span> <span class=n>AA</span><span class=p>());</span>
    <span class=n>BiConsumer</span><span class=o>&lt;</span><span class=n>AA</span><span class=p>,</span><span class=n>BB</span><span class=o>&gt;</span> <span class=n>bicons</span> <span class=o>=</span> <span class=n>ClassFunctionals</span><span class=p>::</span><span class=n>f4</span><span class=p>;</span>
    <span class=n>bicons</span><span class=p>.</span><span class=na>accept</span><span class=p>(</span><span class=k>new</span> <span class=n>AA</span><span class=p>(),</span> <span class=k>new</span> <span class=n>BB</span><span class=p>());</span>
    <span class=n>Function</span><span class=o>&lt;</span><span class=n>AA</span><span class=p>,</span><span class=n>CC</span><span class=o>&gt;</span> <span class=n>f</span> <span class=o>=</span> <span class=n>ClassFunctionals</span><span class=p>::</span><span class=n>f5</span><span class=p>;</span>
    <span class=n>CC</span> <span class=n>cc</span> <span class=o>=</span> <span class=n>f</span><span class=p>.</span><span class=na>apply</span><span class=p>(</span><span class=k>new</span> <span class=n>AA</span><span class=p>());</span>
    <span class=n>BiFunction</span><span class=o>&lt;</span><span class=n>AA</span><span class=p>,</span><span class=n>BB</span><span class=p>,</span><span class=n>CC</span><span class=o>&gt;</span> <span class=n>bif</span> <span class=o>=</span> <span class=n>ClassFunctionals</span><span class=p>::</span><span class=n>f6</span><span class=p>;</span>
    <span class=n>cc</span> <span class=o>=</span> <span class=n>bif</span><span class=p>.</span><span class=na>apply</span><span class=p>(</span><span class=k>new</span> <span class=n>AA</span><span class=p>(),</span> <span class=k>new</span> <span class=n>BB</span><span class=p>());</span>
    <span class=n>Predicate</span><span class=o>&lt;</span><span class=n>AA</span><span class=o>&gt;</span> <span class=n>p</span> <span class=o>=</span> <span class=n>ClassFunctionals</span><span class=p>::</span><span class=n>f7</span><span class=p>;</span>
    <span class=kt>boolean</span> <span class=n>result</span> <span class=o>=</span> <span class=n>p</span><span class=p>.</span><span class=na>test</span><span class=p>(</span><span class=k>new</span> <span class=n>AA</span><span class=p>());</span>
    <span class=n>BiPredicate</span><span class=o>&lt;</span><span class=n>AA</span><span class=p>,</span><span class=n>BB</span><span class=o>&gt;</span> <span class=n>bip</span> <span class=o>=</span> <span class=n>ClassFunctionals</span><span class=p>::</span><span class=n>f8</span><span class=p>;</span>
    <span class=n>result</span> <span class=o>=</span> <span class=n>bip</span><span class=p>.</span><span class=na>test</span><span class=p>(</span><span class=k>new</span> <span class=n>AA</span><span class=p>(),</span> <span class=k>new</span> <span class=n>BB</span><span class=p>());</span>
    <span class=n>UnaryOperator</span><span class=o>&lt;</span><span class=n>AA</span><span class=o>&gt;</span> <span class=n>uo</span> <span class=o>=</span> <span class=n>ClassFunctionals</span><span class=p>::</span><span class=n>f9</span><span class=p>;</span>
    <span class=n>AA</span> <span class=n>aa</span> <span class=o>=</span> <span class=n>uo</span><span class=p>.</span><span class=na>apply</span><span class=p>(</span><span class=k>new</span> <span class=n>AA</span><span class=p>());</span>
    <span class=n>BinaryOperator</span><span class=o>&lt;</span><span class=n>AA</span><span class=o>&gt;</span> <span class=n>bo</span> <span class=o>=</span> <span class=n>ClassFunctionals</span><span class=p>::</span><span class=n>f10</span><span class=p>;</span>
    <span class=n>aa</span> <span class=o>=</span> <span class=n>bo</span><span class=p>.</span><span class=na>apply</span><span class=p>(</span><span class=k>new</span> <span class=n>AA</span><span class=p>(),</span> <span class=k>new</span> <span class=n>AA</span><span class=p>());</span>
  <span class=p>}</span>
<span class=p>}</span>
</code></pre></div> <p>请<strong>注意</strong>，每个方法名称都是随意的（如 <code>f1()</code>，<code>f2()</code>等）。正如你刚才看到的，一旦将方法引用赋值给函数接口，我们就可以调用与该接口关联的函数方法。 在此示例中为 <code>get()</code>、<code>compare()</code>、<code>accept()</code>、<code>apply()</code> 和 <code>test()</code>。</p> <!-- Functional Interfaces with More Arguments --> <h3 id=_8>多参数函数式接口<a class=headerlink href=#_8 title="Permanent link">#</a></h3> <p><code>java.util.functional</code> 中的接口是有限的。比如有 <code>BiFunction</code>，但也仅此而已。 如果需要三参数函数的接口怎么办？ 其实这些接口非常简单，很容易查看 Java 库源代码并自行创建。代码示例：</p> <div class=highlight><pre><span></span><code><span class=c1>// functional/TriFunction.java</span>

<span class=nd>@FunctionalInterface</span>
<span class=kd>public</span> <span class=kd>interface</span> <span class=nc>TriFunction</span><span class=o>&lt;</span><span class=n>T</span><span class=p>,</span> <span class=n>U</span><span class=p>,</span> <span class=n>V</span><span class=p>,</span> <span class=n>R</span><span class=o>&gt;</span> <span class=p>{</span>
    <span class=n>R</span> <span class=nf>apply</span><span class=p>(</span><span class=n>T</span> <span class=n>t</span><span class=p>,</span> <span class=n>U</span> <span class=n>u</span><span class=p>,</span> <span class=n>V</span> <span class=n>v</span><span class=p>);</span>
<span class=p>}</span>
</code></pre></div> <p>简单测试，验证它是否有效：</p> <div class=highlight><pre><span></span><code><span class=c1>// functional/TriFunctionTest.java</span>

<span class=kd>public</span> <span class=kd>class</span> <span class=nc>TriFunctionTest</span> <span class=p>{</span>
  <span class=kd>static</span> <span class=kt>int</span> <span class=nf>f</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span><span class=p>,</span> <span class=kt>long</span> <span class=n>l</span><span class=p>,</span> <span class=kt>double</span> <span class=n>d</span><span class=p>)</span> <span class=p>{</span> <span class=k>return</span> <span class=mi>99</span><span class=p>;</span> <span class=p>}</span>
  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=p>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>TriFunction</span><span class=o>&lt;</span><span class=n>Integer</span><span class=p>,</span> <span class=n>Long</span><span class=p>,</span> <span class=n>Double</span><span class=p>,</span> <span class=n>Integer</span><span class=o>&gt;</span> <span class=n>tf</span> <span class=o>=</span>
      <span class=n>TriFunctionTest</span><span class=p>::</span><span class=n>f</span><span class=p>;</span>
    <span class=n>tf</span> <span class=o>=</span> <span class=p>(</span><span class=n>i</span><span class=p>,</span> <span class=n>l</span><span class=p>,</span> <span class=n>d</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=mi>12</span><span class=p>;</span>
  <span class=p>}</span>
<span class=p>}</span>
</code></pre></div> <p>这里我们同时测试了方法引用和 Lambda 表达式。</p> <h3 id=_9>缺少基本类型的函数<a class=headerlink href=#_9 title="Permanent link">#</a></h3> <p>让我们重温一下 <code>BiConsumer</code>，看看我们如何创建缺少的针对 <strong>int</strong>，<strong>long</strong> 和 <strong>double</strong> 的各种排列：</p> <div class=highlight><pre><span></span><code><span class=c1>// functional/BiConsumerPermutations.java</span>

<span class=kn>import</span> <span class=nn>java.util.function.*</span><span class=p>;</span>

<span class=kd>public</span> <span class=kd>class</span> <span class=nc>BiConsumerPermutations</span> <span class=p>{</span>
  <span class=kd>static</span> <span class=n>BiConsumer</span><span class=o>&lt;</span><span class=n>Integer</span><span class=p>,</span> <span class=n>Double</span><span class=o>&gt;</span> <span class=n>bicid</span> <span class=o>=</span> <span class=p>(</span><span class=n>i</span><span class=p>,</span> <span class=n>d</span><span class=p>)</span> <span class=o>-&gt;</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>format</span><span class=p>(</span><span class=s>&quot;%d, %f%n&quot;</span><span class=p>,</span> <span class=n>i</span><span class=p>,</span> <span class=n>d</span><span class=p>);</span>
  <span class=kd>static</span> <span class=n>BiConsumer</span><span class=o>&lt;</span><span class=n>Double</span><span class=p>,</span> <span class=n>Integer</span><span class=o>&gt;</span> <span class=n>bicdi</span> <span class=o>=</span> <span class=p>(</span><span class=n>d</span><span class=p>,</span> <span class=n>i</span><span class=p>)</span> <span class=o>-&gt;</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>format</span><span class=p>(</span><span class=s>&quot;%d, %f%n&quot;</span><span class=p>,</span> <span class=n>i</span><span class=p>,</span> <span class=n>d</span><span class=p>);</span>
  <span class=kd>static</span> <span class=n>BiConsumer</span><span class=o>&lt;</span><span class=n>Integer</span><span class=p>,</span> <span class=n>Long</span><span class=o>&gt;</span> <span class=n>bicil</span> <span class=o>=</span> <span class=p>(</span><span class=n>i</span><span class=p>,</span> <span class=n>l</span><span class=p>)</span> <span class=o>-&gt;</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>format</span><span class=p>(</span><span class=s>&quot;%d, %d%n&quot;</span><span class=p>,</span> <span class=n>i</span><span class=p>,</span> <span class=n>l</span><span class=p>);</span>
  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=p>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>bicid</span><span class=p>.</span><span class=na>accept</span><span class=p>(</span><span class=mi>47</span><span class=p>,</span> <span class=mf>11.34</span><span class=p>);</span>
    <span class=n>bicdi</span><span class=p>.</span><span class=na>accept</span><span class=p>(</span><span class=mf>22.45</span><span class=p>,</span> <span class=mi>92</span><span class=p>);</span>
    <span class=n>bicil</span><span class=p>.</span><span class=na>accept</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>11L</span><span class=p>);</span>
  <span class=p>}</span>
<span class=p>}</span>
</code></pre></div> <p>输出结果：</p> <div class=highlight><pre><span></span><code>47, 11.340000
92, 22.450000
1, 11
</code></pre></div> <p>这里使用 <code>System.out.format()</code> 来显示。它类似于 <code>System.out.println()</code> 但提供了更多的显示选项。 这里，<code>%f</code> 表示我将 <code>n</code> 作为浮点值给出，<code>%d</code> 表示 <code>n</code> 是一个整数值。 这其中可以包含空格，输入 <code>%n</code> 会换行 — 当然使用传统的 <code>\n</code> 也能换行，但 <code>%n</code> 是自动跨平台的，这是使用 <code>format()</code> 的另一个原因。</p> <p>上例简单使用了包装类型，装箱和拆箱负责它与基本类型之间的来回转换。 又比如，我们可以将包装类型和<code>Function</code>一起使用，而不去用各种针对基本类型的预定义接口。代码示例：</p> <div class=highlight><pre><span></span><code><span class=c1>// functional/FunctionWithWrapped.java</span>

<span class=kn>import</span> <span class=nn>java.util.function.*</span><span class=p>;</span>

<span class=kd>public</span> <span class=kd>class</span> <span class=nc>FunctionWithWrapped</span> <span class=p>{</span>
  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=p>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>Function</span><span class=o>&lt;</span><span class=n>Integer</span><span class=p>,</span> <span class=n>Double</span><span class=o>&gt;</span> <span class=n>fid</span> <span class=o>=</span> <span class=n>i</span> <span class=o>-&gt;</span> <span class=p>(</span><span class=kt>double</span><span class=p>)</span><span class=n>i</span><span class=p>;</span>
    <span class=n>IntToDoubleFunction</span> <span class=n>fid2</span> <span class=o>=</span> <span class=n>i</span> <span class=o>-&gt;</span> <span class=n>i</span><span class=p>;</span>
  <span class=p>}</span>
<span class=p>}</span>
</code></pre></div> <p>如果没有强制转换，则会收到错误消息：“Integer cannot be converted to Double”（<strong>Integer</strong> 无法转换为 <strong>Double</strong>），而使用 <strong>IntToDoubleFunction</strong> 就没有此类问题。 <strong>IntToDoubleFunction</strong> 接口的源代码是这样的：</p> <div class=highlight><pre><span></span><code><span class=nd>@FunctionalInterface</span> 
<span class=kd>public</span> <span class=kd>interface</span> <span class=nc>IntToDoubleFunction</span> <span class=p>{</span> 
  <span class=kt>double</span> <span class=nf>applyAsDouble</span><span class=p>(</span><span class=kt>int</span> <span class=n>value</span><span class=p>);</span> 
<span class=p>}</span>
</code></pre></div> <p>因为我们可以简单地写 <code>Function &lt;Integer，Double&gt;</code> 并产生正常的结果，所以用基本类型的唯一原因是可以避免传递参数和返回结果过程中的自动装箱和自动拆箱，进而提升性能。</p> <p>似乎是考虑到使用频率，某些函数类型并没有预定义。</p> <p>当然，如果因为缺少针对基本类型的函数式接口造成了性能问题，你可以轻松编写自己的接口（ 参考 Java 源代码）——尽管这里出现性能瓶颈的可能性不大。</p> <!-- Higher-Order Functions--> <h2 id=_10>高阶函数<a class=headerlink href=#_10 title="Permanent link">#</a></h2> <p>这个名字可能听起来令人生畏，但是：<a href=https://en.wikipedia.org/wiki/Higher-order_function>高阶函数</a>（Higher-order Function）只是一个消费或产生函数的函数。</p> <p>我们先来看看如何产生一个函数：</p> <div class=highlight><pre><span></span><code><span class=c1>// functional/ProduceFunction.java</span>

<span class=kn>import</span> <span class=nn>java.util.function.*</span><span class=p>;</span>

<span class=kd>interface</span>
<span class=nc>FuncSS</span> <span class=kd>extends</span> <span class=n>Function</span><span class=o>&lt;</span><span class=n>String</span><span class=p>,</span> <span class=n>String</span><span class=o>&gt;</span> <span class=p>{}</span> <span class=c1>// [1]</span>

<span class=kd>public</span> <span class=kd>class</span> <span class=nc>ProduceFunction</span> <span class=p>{</span>
  <span class=kd>static</span> <span class=n>FuncSS</span> <span class=nf>produce</span><span class=p>()</span> <span class=p>{</span>
    <span class=k>return</span> <span class=n>s</span> <span class=o>-&gt;</span> <span class=n>s</span><span class=p>.</span><span class=na>toLowerCase</span><span class=p>();</span> <span class=c1>// [2]</span>
  <span class=p>}</span>
  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=p>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>FuncSS</span> <span class=n>f</span> <span class=o>=</span> <span class=n>produce</span><span class=p>();</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>f</span><span class=p>.</span><span class=na>apply</span><span class=p>(</span><span class=s>&quot;YELLING&quot;</span><span class=p>));</span>
  <span class=p>}</span>
<span class=p>}</span>
</code></pre></div> <p>输出结果： <div class=highlight><pre><span></span><code>yelling
</code></pre></div></p> <p>这里，<code>produce()</code> 是高阶函数。</p> <p><strong>[1]</strong> 使用继承，可以轻松地为专用接口创建别名。</p> <p><strong>[2]</strong> 使用 Lambda 表达式，可以轻松地在方法中创建和返回一个函数。</p> <p>要消费一个函数，消费函数需要在参数列表正确地描述函数类型。代码示例：</p> <div class=highlight><pre><span></span><code><span class=c1>// functional/ConsumeFunction.java</span>

<span class=kn>import</span> <span class=nn>java.util.function.*</span><span class=p>;</span>

<span class=kd>class</span> <span class=nc>One</span> <span class=p>{}</span>
<span class=kd>class</span> <span class=nc>Two</span> <span class=p>{}</span>

<span class=kd>public</span> <span class=kd>class</span> <span class=nc>ConsumeFunction</span> <span class=p>{</span>
  <span class=kd>static</span> <span class=n>Two</span> <span class=nf>consume</span><span class=p>(</span><span class=n>Function</span><span class=o>&lt;</span><span class=n>One</span><span class=p>,</span><span class=n>Two</span><span class=o>&gt;</span> <span class=n>onetwo</span><span class=p>)</span> <span class=p>{</span>
    <span class=k>return</span> <span class=n>onetwo</span><span class=p>.</span><span class=na>apply</span><span class=p>(</span><span class=k>new</span> <span class=n>One</span><span class=p>());</span>
  <span class=p>}</span>
  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=p>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>Two</span> <span class=n>two</span> <span class=o>=</span> <span class=n>consume</span><span class=p>(</span><span class=n>one</span> <span class=o>-&gt;</span> <span class=k>new</span> <span class=n>Two</span><span class=p>());</span>
  <span class=p>}</span>
<span class=p>}</span>
</code></pre></div> <p>当基于消费函数生成新函数时，事情就变得相当有趣了。代码示例如下：</p> <div class=highlight><pre><span></span><code><span class=c1>// functional/TransformFunction.java</span>

<span class=kn>import</span> <span class=nn>java.util.function.*</span><span class=p>;</span>

<span class=kd>class</span> <span class=nc>I</span> <span class=p>{</span>
  <span class=nd>@Override</span>
  <span class=kd>public</span> <span class=n>String</span> <span class=nf>toString</span><span class=p>()</span> <span class=p>{</span> <span class=k>return</span> <span class=s>&quot;I&quot;</span><span class=p>;</span> <span class=p>}</span>
<span class=p>}</span>

<span class=kd>class</span> <span class=nc>O</span> <span class=p>{</span>
  <span class=nd>@Override</span>
  <span class=kd>public</span> <span class=n>String</span> <span class=nf>toString</span><span class=p>()</span> <span class=p>{</span> <span class=k>return</span> <span class=s>&quot;O&quot;</span><span class=p>;</span> <span class=p>}</span>
<span class=p>}</span>

<span class=kd>public</span> <span class=kd>class</span> <span class=nc>TransformFunction</span> <span class=p>{</span>
  <span class=kd>static</span> <span class=n>Function</span><span class=o>&lt;</span><span class=n>I</span><span class=p>,</span><span class=n>O</span><span class=o>&gt;</span> <span class=nf>transform</span><span class=p>(</span><span class=n>Function</span><span class=o>&lt;</span><span class=n>I</span><span class=p>,</span><span class=n>O</span><span class=o>&gt;</span> <span class=n>in</span><span class=p>)</span> <span class=p>{</span>
    <span class=k>return</span> <span class=n>in</span><span class=p>.</span><span class=na>andThen</span><span class=p>(</span><span class=n>o</span> <span class=o>-&gt;</span> <span class=p>{</span>
      <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>o</span><span class=p>);</span>
      <span class=k>return</span> <span class=n>o</span><span class=p>;</span>
    <span class=p>});</span>
  <span class=p>}</span>
  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=p>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>Function</span><span class=o>&lt;</span><span class=n>I</span><span class=p>,</span><span class=n>O</span><span class=o>&gt;</span> <span class=n>f2</span> <span class=o>=</span> <span class=n>transform</span><span class=p>(</span><span class=n>i</span> <span class=o>-&gt;</span> <span class=p>{</span>
      <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>i</span><span class=p>);</span>
      <span class=k>return</span> <span class=k>new</span> <span class=n>O</span><span class=p>();</span>
    <span class=p>});</span>
    <span class=n>O</span> <span class=n>o</span> <span class=o>=</span> <span class=n>f2</span><span class=p>.</span><span class=na>apply</span><span class=p>(</span><span class=k>new</span> <span class=n>I</span><span class=p>());</span>
  <span class=p>}</span>
<span class=p>}</span>
</code></pre></div> <p>输出结果：</p> <div class=highlight><pre><span></span><code>I
O
</code></pre></div> <p>在这里，<code>transform()</code> 生成一个与传入的函数具有相同签名的函数，但是你可以生成任何你想要的类型。</p> <p>这里使用到了 <code>Function</code> 接口中名为 <code>andThen()</code> 的默认方法，该方法专门用于操作函数。 顾名思义，在调用 <code>in</code> 函数之后调用 <code>andThen()</code>（还有个 <code>compose()</code> 方法，它在 <code>in</code> 函数之前应用新函数）。 要附加一个 <code>andThen()</code> 函数，我们只需将该函数作为参数传递。 <code>transform()</code> 产生的是一个新函数，它将 <code>in</code> 的动作与 <code>andThen()</code> 参数的动作结合起来。</p> <!-- Closures --> <h2 id=_11>闭包<a class=headerlink href=#_11 title="Permanent link">#</a></h2> <p>在上一节的 <code>ProduceFunction.java</code> 中，我们从方法中返回 Lambda 函数。 虽然过程简单，但是有些问题必须再回过头来探讨一下。</p> <p><strong>闭包</strong>（Closure）一词总结了这些问题。 它非常重要，利用闭包可以轻松生成函数。</p> <p>考虑一个更复杂的 Lambda，它使用函数作用域之外的变量。 返回该函数会发生什么？ 也就是说，当你调用函数时，它对那些 “外部 ”变量引用了什么? 如果语言不能自动解决，那问题将变得非常棘手。 能够解决这个问题的语言被称为<strong>支持闭包</strong>，或者叫作在词法上限定范围( 也使用术语<em>变量捕获</em> )。Java 8 提供了有限但合理的闭包支持，我们将用一些简单的例子来研究它。</p> <p>首先，下列方法返回一个函数，该函数访问对象字段和方法参数：</p> <div class=highlight><pre><span></span><code><span class=c1>// functional/Closure1.java</span>

<span class=kn>import</span> <span class=nn>java.util.function.*</span><span class=p>;</span>

<span class=kd>public</span> <span class=kd>class</span> <span class=nc>Closure1</span> <span class=p>{</span>
  <span class=kt>int</span> <span class=n>i</span><span class=p>;</span>
  <span class=n>IntSupplier</span> <span class=nf>makeFun</span><span class=p>(</span><span class=kt>int</span> <span class=n>x</span><span class=p>)</span> <span class=p>{</span>
    <span class=k>return</span> <span class=p>()</span> <span class=o>-&gt;</span> <span class=n>x</span> <span class=o>+</span> <span class=n>i</span><span class=o>++</span><span class=p>;</span>
  <span class=p>}</span>
<span class=p>}</span>
</code></pre></div> <p>但是，仔细考虑一下，<code>i</code> 的这种用法并非是个大难题，因为对象很可能在你调用 <code>makeFun()</code> 之后就存在了——实际上，垃圾收集器几乎肯定会保留以这种方式被绑定到现存函数的对象<sup id=fnref:5><a class=footnote-ref href=#fn:5>5</a></sup>。当然，如果你对同一个对象多次调用 <code>makeFun()</code> ，你最终会得到多个函数，它们共享 <code>i</code> 的存储空间： <div class=highlight><pre><span></span><code><span class=c1>// functional/SharedStorage.java</span>

<span class=kn>import</span> <span class=nn>java.util.function.*</span><span class=p>;</span>

<span class=kd>public</span> <span class=kd>class</span> <span class=nc>SharedStorage</span> <span class=p>{</span>
  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=p>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>Closure1</span> <span class=n>c1</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Closure1</span><span class=p>();</span>
    <span class=n>IntSupplier</span> <span class=n>f1</span> <span class=o>=</span> <span class=n>c1</span><span class=p>.</span><span class=na>makeFun</span><span class=p>(</span><span class=mi>0</span><span class=p>);</span>
    <span class=n>IntSupplier</span> <span class=n>f2</span> <span class=o>=</span> <span class=n>c1</span><span class=p>.</span><span class=na>makeFun</span><span class=p>(</span><span class=mi>0</span><span class=p>);</span>
    <span class=n>IntSupplier</span> <span class=n>f3</span> <span class=o>=</span> <span class=n>c1</span><span class=p>.</span><span class=na>makeFun</span><span class=p>(</span><span class=mi>0</span><span class=p>);</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>f1</span><span class=p>.</span><span class=na>getAsInt</span><span class=p>());</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>f2</span><span class=p>.</span><span class=na>getAsInt</span><span class=p>());</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>f3</span><span class=p>.</span><span class=na>getAsInt</span><span class=p>());</span>
  <span class=p>}</span>
<span class=p>}</span>
</code></pre></div></p> <p>输出结果：</p> <div class=highlight><pre><span></span><code>0
1
2
</code></pre></div> <p>每次调用 <code>getAsInt()</code> 都会增加 <code>i</code>，表明存储是共享的。</p> <p>如果 <code>i</code> 是 <code>makeFun()</code> 的局部变量怎么办？ 在正常情况下，当 <code>makeFun()</code> 完成时 <code>i</code> 就消失。 但它仍可以编译：</p> <div class=highlight><pre><span></span><code><span class=c1>// functional/Closure2.java</span>

<span class=kn>import</span> <span class=nn>java.util.function.*</span><span class=p>;</span>

<span class=kd>public</span> <span class=kd>class</span> <span class=nc>Closure2</span> <span class=p>{</span>
  <span class=n>IntSupplier</span> <span class=nf>makeFun</span><span class=p>(</span><span class=kt>int</span> <span class=n>x</span><span class=p>)</span> <span class=p>{</span>
    <span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
    <span class=k>return</span> <span class=p>()</span> <span class=o>-&gt;</span> <span class=n>x</span> <span class=o>+</span> <span class=n>i</span><span class=p>;</span>
  <span class=p>}</span>
<span class=p>}</span>
</code></pre></div> <p>由 <code>makeFun()</code> 返回的 <code>IntSupplier</code> “关住了” <code>i</code> 和 <code>x</code>，因此即使<code>makeFun()</code>已执行完毕，当你调用返回的函数时<code>i</code> 和 <code>x</code>仍然有效，而不是像正常情况下那样在 <code>makeFun()</code> 执行后 <code>i</code> 和<code>x</code>就消失了。 但请注意，我没有像 <code>Closure1.java</code> 那样递增 <code>i</code>，因为会产生编译时错误。代码示例：</p> <div class=highlight><pre><span></span><code><span class=c1>// functional/Closure3.java</span>

<span class=c1>// {WillNotCompile}</span>
<span class=kn>import</span> <span class=nn>java.util.function.*</span><span class=p>;</span>

<span class=kd>public</span> <span class=kd>class</span> <span class=nc>Closure3</span> <span class=p>{</span>
  <span class=n>IntSupplier</span> <span class=nf>makeFun</span><span class=p>(</span><span class=kt>int</span> <span class=n>x</span><span class=p>)</span> <span class=p>{</span>
    <span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
    <span class=c1>// x++ 和 i++ 都会报错：</span>
    <span class=k>return</span> <span class=p>()</span> <span class=o>-&gt;</span> <span class=n>x</span><span class=o>++</span> <span class=o>+</span> <span class=n>i</span><span class=o>++</span><span class=p>;</span>
  <span class=p>}</span>
<span class=p>}</span>
</code></pre></div> <p><code>x</code> 和 <code>i</code> 的操作都犯了同样的错误：被 Lambda 表达式引用的局部变量必须是 <code>final</code> 或者是等同 <code>final</code> 效果的。</p> <p>如果使用 <code>final</code> 修饰 <code>x</code>和 <code>i</code>，就不能再递增它们的值了。代码示例：</p> <div class=highlight><pre><span></span><code><span class=c1>// functional/Closure4.java</span>

<span class=kn>import</span> <span class=nn>java.util.function.*</span><span class=p>;</span>

<span class=kd>public</span> <span class=kd>class</span> <span class=nc>Closure4</span> <span class=p>{</span>
  <span class=n>IntSupplier</span> <span class=nf>makeFun</span><span class=p>(</span><span class=kd>final</span> <span class=kt>int</span> <span class=n>x</span><span class=p>)</span> <span class=p>{</span>
    <span class=kd>final</span> <span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
    <span class=k>return</span> <span class=p>()</span> <span class=o>-&gt;</span> <span class=n>x</span> <span class=o>+</span> <span class=n>i</span><span class=p>;</span>
  <span class=p>}</span>
<span class=p>}</span>
</code></pre></div> <p>那么为什么在 <code>Closure2.java</code> 中， <code>x</code> 和 <code>i</code> 非 <code>final</code> 却可以运行呢？</p> <p>这就叫做<strong>等同 final 效果</strong>（Effectively Final）。这个术语是在 Java 8 才开始出现的，表示虽然没有明确地声明变量是 <code>final</code> 的，但是因变量值没被改变过而实际有了 <code>final</code> 同等的效果。 如果局部变量的初始值永远不会改变，那么它实际上就是 <code>final</code> 的。</p> <p>如果 <code>x</code> 和 <code>i</code> 的值在方法中的其他位置发生改变（但不在返回的函数内部），则编译器仍将视其为错误。每个递增操作则会分别产生错误消息。代码示例：</p> <div class=highlight><pre><span></span><code><span class=c1>// functional/Closure5.java</span>

<span class=c1>// {无法编译成功}</span>
<span class=kn>import</span> <span class=nn>java.util.function.*</span><span class=p>;</span>

<span class=kd>public</span> <span class=kd>class</span> <span class=nc>Closure5</span> <span class=p>{</span>
  <span class=n>IntSupplier</span> <span class=nf>makeFun</span><span class=p>(</span><span class=kt>int</span> <span class=n>x</span><span class=p>)</span> <span class=p>{</span>
    <span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
    <span class=n>i</span><span class=o>++</span><span class=p>;</span>
    <span class=n>x</span><span class=o>++</span><span class=p>;</span>
    <span class=k>return</span> <span class=p>()</span> <span class=o>-&gt;</span> <span class=n>x</span> <span class=o>+</span> <span class=n>i</span><span class=p>;</span>
  <span class=p>}</span>
<span class=p>}</span>
</code></pre></div> <p><strong>等同 final 效果</strong>意味着可以在变量声明前加上 <strong>final</strong> 关键字而不用更改任何其余代码。 实际上它就是具备 <code>final</code> 效果的，只是没有明确说明。</p> <p>通过在闭包中使用 <code>final</code> 关键字提前修饰变量 <code>x</code> 和 <code>i</code> ， 我们解决了 <code>Closure5.java</code> 中的问题。代码示例：</p> <div class=highlight><pre><span></span><code><span class=c1>// functional/Closure6.java</span>

<span class=kn>import</span> <span class=nn>java.util.function.*</span><span class=p>;</span>

<span class=kd>public</span> <span class=kd>class</span> <span class=nc>Closure6</span> <span class=p>{</span>
  <span class=n>IntSupplier</span> <span class=nf>makeFun</span><span class=p>(</span><span class=kt>int</span> <span class=n>x</span><span class=p>)</span> <span class=p>{</span>
    <span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
    <span class=n>i</span><span class=o>++</span><span class=p>;</span>
    <span class=n>x</span><span class=o>++</span><span class=p>;</span>
    <span class=kd>final</span> <span class=kt>int</span> <span class=n>iFinal</span> <span class=o>=</span> <span class=n>i</span><span class=p>;</span>
    <span class=kd>final</span> <span class=kt>int</span> <span class=n>xFinal</span> <span class=o>=</span> <span class=n>x</span><span class=p>;</span>
    <span class=k>return</span> <span class=p>()</span> <span class=o>-&gt;</span> <span class=n>xFinal</span> <span class=o>+</span> <span class=n>iFinal</span><span class=p>;</span>
  <span class=p>}</span>
<span class=p>}</span>
</code></pre></div> <p>上例中 <code>iFinal</code> 和 <code>xFinal</code> 的值在赋值后并没有改变过，因此在这里使用 <code>final</code> 是多余的。</p> <p>如果函数式方法中使用的外部局部变量是引用，而不是基本类型的话，会是什么情况呢？我们可以把<code>int</code>类型改为<code>Integer</code>类型研究一下：</p> <div class=highlight><pre><span></span><code><span class=c1>// functional/Closure7.java</span>

<span class=c1>// {无法编译成功}</span>
<span class=kn>import</span> <span class=nn>java.util.function.*</span><span class=p>;</span>

<span class=kd>public</span> <span class=kd>class</span> <span class=nc>Closure7</span> <span class=p>{</span>
  <span class=n>IntSupplier</span> <span class=nf>makeFun</span><span class=p>(</span><span class=kt>int</span> <span class=n>x</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>Integer</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
    <span class=n>i</span> <span class=o>=</span> <span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>;</span>
    <span class=k>return</span> <span class=p>()</span> <span class=o>-&gt;</span> <span class=n>x</span> <span class=o>+</span> <span class=n>i</span><span class=p>;</span>
  <span class=p>}</span>
<span class=p>}</span>
</code></pre></div> <p>编译器非常聪明地识别到变量 <code>i</code> 的值被更改过。 因为包装类型可能被特殊处理过了，所以我们尝试下 <strong>List</strong>：</p> <div class=highlight><pre><span></span><code><span class=c1>// functional/Closure8.java</span>

<span class=kn>import</span> <span class=nn>java.util.*</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>java.util.function.*</span><span class=p>;</span>

<span class=kd>public</span> <span class=kd>class</span> <span class=nc>Closure8</span> <span class=p>{</span>
  <span class=n>Supplier</span><span class=o>&lt;</span><span class=n>List</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>&gt;&gt;</span> <span class=nf>makeFun</span><span class=p>()</span> <span class=p>{</span>
    <span class=kd>final</span> <span class=n>List</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>&gt;</span> <span class=n>ai</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ArrayList</span><span class=o>&lt;&gt;</span><span class=p>();</span>
    <span class=n>ai</span><span class=p>.</span><span class=na>add</span><span class=p>(</span><span class=mi>1</span><span class=p>);</span>
    <span class=k>return</span> <span class=p>()</span> <span class=o>-&gt;</span> <span class=n>ai</span><span class=p>;</span>
  <span class=p>}</span>
  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=p>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>Closure8</span> <span class=n>c7</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Closure8</span><span class=p>();</span>
    <span class=n>List</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>&gt;</span>
      <span class=n>l1</span> <span class=o>=</span> <span class=n>c7</span><span class=p>.</span><span class=na>makeFun</span><span class=p>().</span><span class=na>get</span><span class=p>(),</span>
      <span class=n>l2</span> <span class=o>=</span> <span class=n>c7</span><span class=p>.</span><span class=na>makeFun</span><span class=p>().</span><span class=na>get</span><span class=p>();</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>l1</span><span class=p>);</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>l2</span><span class=p>);</span>
    <span class=n>l1</span><span class=p>.</span><span class=na>add</span><span class=p>(</span><span class=mi>42</span><span class=p>);</span>
    <span class=n>l2</span><span class=p>.</span><span class=na>add</span><span class=p>(</span><span class=mi>96</span><span class=p>);</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>l1</span><span class=p>);</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>l2</span><span class=p>);</span>
  <span class=p>}</span>
<span class=p>}</span>
</code></pre></div> <p>输出结果：</p> <div class=highlight><pre><span></span><code>[1]
[1]
[1, 42]
[1, 96]
</code></pre></div> <p>可以看到，这次一切正常。我们改变了 <strong>List</strong> 的内容却没产生编译时错误。通过观察本例的输出结果，我们发现这看起来非常安全。这是因为每次调用 <code>makeFun()</code> 时，其实都会创建并返回一个全新而非共享的 <code>ArrayList</code>。也就是说，每个闭包都有自己独立的 <code>ArrayList</code>，它们之间互不干扰。</p> <p>请<strong>注意</strong>我已经声明 <code>ai</code> 是 <code>final</code> 的了。尽管在这个例子中你可以去掉 <code>final</code> 并得到相同的结果（试试吧！）。 应用于对象引用的 <code>final</code> 关键字仅表示不会重新赋值引用。 它并不代表你不能修改对象本身。</p> <p>下面我们来看看 <code>Closure7.java</code> 和 <code>Closure8.java</code> 之间的区别。我们看到：在 <code>Closure7.java</code> 中变量 <code>i</code> 有过重新赋值。 也许这就是触发<strong>等同 final 效果</strong>错误消息的原因。</p> <div class=highlight><pre><span></span><code><span class=c1>// functional/Closure9.java</span>

<span class=c1>// {无法编译成功}</span>
<span class=kn>import</span> <span class=nn>java.util.*</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>java.util.function.*</span><span class=p>;</span>

<span class=kd>public</span> <span class=kd>class</span> <span class=nc>Closure9</span> <span class=p>{</span>
  <span class=n>Supplier</span><span class=o>&lt;</span><span class=n>List</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>&gt;&gt;</span> <span class=nf>makeFun</span><span class=p>()</span> <span class=p>{</span>
    <span class=n>List</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>&gt;</span> <span class=n>ai</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ArrayList</span><span class=o>&lt;&gt;</span><span class=p>();</span>
    <span class=n>ai</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ArrayList</span><span class=o>&lt;&gt;</span><span class=p>();</span> <span class=c1>// Reassignment</span>
    <span class=k>return</span> <span class=p>()</span> <span class=o>-&gt;</span> <span class=n>ai</span><span class=p>;</span>
  <span class=p>}</span>
<span class=p>}</span>
</code></pre></div> <p>上例，重新赋值引用会触发错误消息。如果只修改指向的对象则没问题，只要没有其他人获得对该对象的引用（这意味着你有多个实体可以修改对象，此时事情会变得非常混乱），基本上就是安全的<sup id=fnref:6><a class=footnote-ref href=#fn:6>6</a></sup>。</p> <p>让我们回顾一下 <code>Closure1.java</code>。那么现在问题来了：为什么变量 <code>i</code> 被修改编译器却没有报错呢。 它既不是 <code>final</code> 的，也不是<strong>等同 final 效果</strong>的。因为 <code>i</code> 是外围类的成员，所以这样做肯定是安全的（除非你正在创建共享可变内存的多个函数）。是的，你可以辩称在这种情况下不会发生变量捕获（Variable Capture）。但可以肯定的是，<code>Closure3.java</code> 的错误消息是专门针对局部变量的。因此，规则并非只是“在 Lambda 之外定义的任何变量必须是 <code>final</code> 的或<strong>等同 final 效果</strong>那么简单。相反，你必须考虑捕获的变量是否是<strong>等同 final 效果</strong>的。 如果它是对象中的字段，那么它拥有独立的生存周期，并且不需要任何特殊的捕获，以便稍后在调用 Lambda 时存在。</p> <!-- Inner Classes as Closures --> <h3 id=_12>作为闭包的内部类<a class=headerlink href=#_12 title="Permanent link">#</a></h3> <p>我们可以使用匿名内部类重写之前的例子:</p> <div class=highlight><pre><span></span><code><span class=c1>// functional/AnonymousClosure.java</span>

<span class=kn>import</span> <span class=nn>java.util.function.*</span><span class=p>;</span>

<span class=kd>public</span> <span class=kd>class</span> <span class=nc>AnonymousClosure</span> <span class=p>{</span>
  <span class=n>IntSupplier</span> <span class=nf>makeFun</span><span class=p>(</span><span class=kt>int</span> <span class=n>x</span><span class=p>)</span> <span class=p>{</span>
    <span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
    <span class=c1>// 同样规则的应用:</span>
    <span class=c1>// i++; // 非等同 final 效果</span>
    <span class=c1>// x++; // 同上</span>
    <span class=k>return</span> <span class=k>new</span> <span class=n>IntSupplier</span><span class=p>()</span> <span class=p>{</span>
      <span class=kd>public</span> <span class=kt>int</span> <span class=nf>getAsInt</span><span class=p>()</span> <span class=p>{</span> <span class=k>return</span> <span class=n>x</span> <span class=o>+</span> <span class=n>i</span><span class=p>;</span> <span class=p>}</span>
    <span class=p>};</span>
  <span class=p>}</span>
<span class=p>}</span>
</code></pre></div> <p>实际上只要有内部类，就会有闭包（Java 8 只是简化了闭包操作）。在 Java 8 之前，变量 <code>x</code> 和 <code>i</code> 必须被明确声明为 <code>final</code>。在 Java 8 中，内部类的规则放宽，包括<strong>等同 final 效果</strong>。</p> <!-- Function Composition --> <h2 id=_13>函数组合<a class=headerlink href=#_13 title="Permanent link">#</a></h2> <p>函数组合（Function Composition）意为“多个函数组合成新函数”。它通常是函数式编程的基本组成部分。在前面的 <code>TransformFunction.java</code> 类中，有一个使用 <code>andThen()</code> 的函数组合示例。一些 <code>java.util.function</code> 接口中包含支持函数组合的方法 <sup id=fnref:7><a class=footnote-ref href=#fn:7>7</a></sup>。</p> <table> <thead> <tr> <th align=left>组合方法</th> <th align=left>支持接口</th> </tr> </thead> <tbody> <tr> <td align=left><code>andThen(argument)</code> <br> 根据参数执行原始操作</td> <td align=left><strong>Function <br> BiFunction <br> Consumer <br> BiConsumer <br> IntConsumer <br> LongConsumer <br> DoubleConsumer <br> UnaryOperator <br> IntUnaryOperator <br> LongUnaryOperator <br> DoubleUnaryOperator <br> BinaryOperator</strong></td> </tr> <tr> <td align=left><code>compose(argument)</code> <br> 根据参数执行原始操作</td> <td align=left><strong>Function <br> UnaryOperator <br> IntUnaryOperator <br> LongUnaryOperator <br> DoubleUnaryOperator</strong></td> </tr> <tr> <td align=left><code>and(argument)</code> <br> 短路<strong>逻辑与</strong>原始谓词和参数谓词</td> <td align=left><strong>Predicate <br> BiPredicate <br> IntPredicate <br> LongPredicate <br> DoublePredicate</strong></td> </tr> <tr> <td align=left><code>or(argument)</code> <br> 短路<strong>逻辑或</strong>原始谓词和参数谓词</td> <td align=left><strong>Predicate <br> BiPredicate <br> IntPredicate <br> LongPredicate <br> DoublePredicate</strong></td> </tr> <tr> <td align=left><code>negate()</code> <br> 该谓词的<strong>逻辑否</strong>谓词</td> <td align=left><strong>Predicate <br> BiPredicate <br> IntPredicate <br> LongPredicate <br> DoublePredicate</strong></td> </tr> </tbody> </table> <p>下例使用了 <code>Function</code> 里的 <code>compose()</code>和 <code>andThen()</code>。代码示例：</p> <div class=highlight><pre><span></span><code><span class=c1>// functional/FunctionComposition.java</span>

<span class=kn>import</span> <span class=nn>java.util.function.*</span><span class=p>;</span>

<span class=kd>public</span> <span class=kd>class</span> <span class=nc>FunctionComposition</span> <span class=p>{</span>
  <span class=kd>static</span> <span class=n>Function</span><span class=o>&lt;</span><span class=n>String</span><span class=p>,</span> <span class=n>String</span><span class=o>&gt;</span>
    <span class=n>f1</span> <span class=o>=</span> <span class=n>s</span> <span class=o>-&gt;</span> <span class=p>{</span>
      <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>s</span><span class=p>);</span>
      <span class=k>return</span> <span class=n>s</span><span class=p>.</span><span class=na>replace</span><span class=p>(</span><span class=sc>&#39;A&#39;</span><span class=p>,</span> <span class=sc>&#39;_&#39;</span><span class=p>);</span>
    <span class=p>},</span>
    <span class=n>f2</span> <span class=o>=</span> <span class=n>s</span> <span class=o>-&gt;</span> <span class=n>s</span><span class=p>.</span><span class=na>substring</span><span class=p>(</span><span class=mi>3</span><span class=p>),</span>
    <span class=n>f3</span> <span class=o>=</span> <span class=n>s</span> <span class=o>-&gt;</span> <span class=n>s</span><span class=p>.</span><span class=na>toLowerCase</span><span class=p>(),</span>
    <span class=n>f4</span> <span class=o>=</span> <span class=n>f1</span><span class=p>.</span><span class=na>compose</span><span class=p>(</span><span class=n>f2</span><span class=p>).</span><span class=na>andThen</span><span class=p>(</span><span class=n>f3</span><span class=p>);</span>
  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=p>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span>
      <span class=n>f4</span><span class=p>.</span><span class=na>apply</span><span class=p>(</span><span class=s>&quot;GO AFTER ALL AMBULANCES&quot;</span><span class=p>));</span>
  <span class=p>}</span>
<span class=p>}</span>
</code></pre></div> <p>输出结果：</p> <div class=highlight><pre><span></span><code>AFTER ALL AMBULANCES
_fter _ll _mbul_nces
</code></pre></div> <p>这里我们重点看正在创建的新函数 <code>f4</code>。它调用 <code>apply()</code> 的方式与常规几乎无异<sup id=fnref:8><a class=footnote-ref href=#fn:8>8</a></sup>。</p> <p>当 <code>f1</code> 获得字符串时，它已经被<code>f2</code> 剥离了前三个字符。这是因为 <code>compose（f2）</code> 表示 <code>f2</code> 的调用发生在 <code>f1</code> 之前。</p> <p>下例是 <code>Predicate</code> 的逻辑运算演示.代码示例：</p> <div class=highlight><pre><span></span><code><span class=c1>// functional/PredicateComposition.java</span>

<span class=kn>import</span> <span class=nn>java.util.function.*</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>java.util.stream.*</span><span class=p>;</span>

<span class=kd>public</span> <span class=kd>class</span> <span class=nc>PredicateComposition</span> <span class=p>{</span>
  <span class=kd>static</span> <span class=n>Predicate</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;</span>
    <span class=n>p1</span> <span class=o>=</span> <span class=n>s</span> <span class=o>-&gt;</span> <span class=n>s</span><span class=p>.</span><span class=na>contains</span><span class=p>(</span><span class=s>&quot;bar&quot;</span><span class=p>),</span>
    <span class=n>p2</span> <span class=o>=</span> <span class=n>s</span> <span class=o>-&gt;</span> <span class=n>s</span><span class=p>.</span><span class=na>length</span><span class=p>()</span> <span class=o>&lt;</span> <span class=mi>5</span><span class=p>,</span>
    <span class=n>p3</span> <span class=o>=</span> <span class=n>s</span> <span class=o>-&gt;</span> <span class=n>s</span><span class=p>.</span><span class=na>contains</span><span class=p>(</span><span class=s>&quot;foo&quot;</span><span class=p>),</span>
    <span class=n>p4</span> <span class=o>=</span> <span class=n>p1</span><span class=p>.</span><span class=na>negate</span><span class=p>().</span><span class=na>and</span><span class=p>(</span><span class=n>p2</span><span class=p>).</span><span class=na>or</span><span class=p>(</span><span class=n>p3</span><span class=p>);</span>
  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=p>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>Stream</span><span class=p>.</span><span class=na>of</span><span class=p>(</span><span class=s>&quot;bar&quot;</span><span class=p>,</span> <span class=s>&quot;foobar&quot;</span><span class=p>,</span> <span class=s>&quot;foobaz&quot;</span><span class=p>,</span> <span class=s>&quot;fongopuckey&quot;</span><span class=p>)</span>
      <span class=p>.</span><span class=na>filter</span><span class=p>(</span><span class=n>p4</span><span class=p>)</span>
      <span class=p>.</span><span class=na>forEach</span><span class=p>(</span><span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>::</span><span class=n>println</span><span class=p>);</span>
  <span class=p>}</span>
<span class=p>}</span>
</code></pre></div> <p>输出结果：</p> <div class=highlight><pre><span></span><code>foobar
foobaz
</code></pre></div> <p><code>p4</code> 获取到了所有谓词并组合成一个更复杂的谓词。解读：如果字符串中不包含 <code>bar</code> 且长度小于 5，或者它包含 <code>foo</code> ，则结果为 <code>true</code>。</p> <p>正因它产生如此清晰的语法，我在主方法中采用了一些小技巧，并借用了下一章的内容。首先，我创建了一个字符串对象的流，然后将每个对象传递给 <code>filter()</code> 操作。 <code>filter()</code> 使用 <code>p4</code> 的谓词来确定对象的去留。最后我们使用 <code>forEach()</code> 将 <code>println</code> 方法引用应用在每个留存的对象上。</p> <p>从输出结果我们可以看到 <code>p4</code> 的工作流程：任何带有 <code>"foo"</code> 的字符串都得以保留，即使它的长度大于 5。 <code>"fongopuckey"</code> 因长度超出且不包含 <code>foo</code> 而被丢弃。</p> <!-- Currying and  Partial Evaluation --> <h2 id=_14>柯里化和部分求值<a class=headerlink href=#_14 title="Permanent link">#</a></h2> <p><a href=https://en.wikipedia.org/wiki/Currying>柯里化</a>（Currying）的名称来自于其发明者之一 <em>Haskell Curry</em>。他可能是计算机领域唯一姓氏和名字都命名过重要概念的人（另外就是 Haskell 编程语言）。 柯里化意为：将一个多参数的函数，转换为一系列单参数函数。</p> <div class=highlight><pre><span></span><code><span class=c1>// functional/CurryingAndPartials.java</span>

<span class=kn>import</span> <span class=nn>java.util.function.*</span><span class=p>;</span>

<span class=kd>public</span> <span class=kd>class</span> <span class=nc>CurryingAndPartials</span> <span class=p>{</span>
   <span class=c1>// 未柯里化:</span>
   <span class=kd>static</span> <span class=n>String</span> <span class=nf>uncurried</span><span class=p>(</span><span class=n>String</span> <span class=n>a</span><span class=p>,</span> <span class=n>String</span> <span class=n>b</span><span class=p>)</span> <span class=p>{</span>
      <span class=k>return</span> <span class=n>a</span> <span class=o>+</span> <span class=n>b</span><span class=p>;</span>
   <span class=p>}</span>
   <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=p>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=p>)</span> <span class=p>{</span>
      <span class=c1>// 柯里化的函数:</span>
      <span class=n>Function</span><span class=o>&lt;</span><span class=n>String</span><span class=p>,</span> <span class=n>Function</span><span class=o>&lt;</span><span class=n>String</span><span class=p>,</span> <span class=n>String</span><span class=o>&gt;&gt;</span> <span class=n>sum</span> <span class=o>=</span>
         <span class=n>a</span> <span class=o>-&gt;</span> <span class=n>b</span> <span class=o>-&gt;</span> <span class=n>a</span> <span class=o>+</span> <span class=n>b</span><span class=p>;</span> <span class=c1>// [1]</span>

      <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>uncurried</span><span class=p>(</span><span class=s>&quot;Hi &quot;</span><span class=p>,</span> <span class=s>&quot;Ho&quot;</span><span class=p>));</span>

      <span class=n>Function</span><span class=o>&lt;</span><span class=n>String</span><span class=p>,</span> <span class=n>String</span><span class=o>&gt;</span>
        <span class=n>hi</span> <span class=o>=</span> <span class=n>sum</span><span class=p>.</span><span class=na>apply</span><span class=p>(</span><span class=s>&quot;Hi &quot;</span><span class=p>);</span> <span class=c1>// [2]</span>
      <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>hi</span><span class=p>.</span><span class=na>apply</span><span class=p>(</span><span class=s>&quot;Ho&quot;</span><span class=p>));</span>

      <span class=c1>// 部分应用:</span>
      <span class=n>Function</span><span class=o>&lt;</span><span class=n>String</span><span class=p>,</span> <span class=n>String</span><span class=o>&gt;</span> <span class=n>sumHi</span> <span class=o>=</span>
        <span class=n>sum</span><span class=p>.</span><span class=na>apply</span><span class=p>(</span><span class=s>&quot;Hup &quot;</span><span class=p>);</span>
      <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>sumHi</span><span class=p>.</span><span class=na>apply</span><span class=p>(</span><span class=s>&quot;Ho&quot;</span><span class=p>));</span>
      <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>sumHi</span><span class=p>.</span><span class=na>apply</span><span class=p>(</span><span class=s>&quot;Hey&quot;</span><span class=p>));</span>
   <span class=p>}</span>
<span class=p>}</span>
</code></pre></div> <p>输出结果：</p> <div class=highlight><pre><span></span><code>Hi Ho
Hi Ho
Hup Ho
Hup Hey
</code></pre></div> <p><strong>[1]</strong> 这一连串的箭头很巧妙。<em>注意</em>，在函数接口声明中，第二个参数是另一个函数。</p> <p><strong>[2]</strong> 柯里化的目的是能够通过提供一个参数来创建一个新函数，所以现在有了一个“带参函数”和剩下的 “自由函数”（free argumnet） 。实际上，你从一个双参数函数开始，最后得到一个单参数函数。</p> <p>我们可以通过添加级别来柯里化一个三参数函数：</p> <div class=highlight><pre><span></span><code><span class=c1>// functional/Curry3Args.java</span>

<span class=kn>import</span> <span class=nn>java.util.function.*</span><span class=p>;</span>

<span class=kd>public</span> <span class=kd>class</span> <span class=nc>Curry3Args</span> <span class=p>{</span>
   <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=p>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=p>)</span> <span class=p>{</span>
      <span class=n>Function</span><span class=o>&lt;</span><span class=n>String</span><span class=p>,</span>
        <span class=n>Function</span><span class=o>&lt;</span><span class=n>String</span><span class=p>,</span>
          <span class=n>Function</span><span class=o>&lt;</span><span class=n>String</span><span class=p>,</span> <span class=n>String</span><span class=o>&gt;&gt;&gt;</span> <span class=n>sum</span> <span class=o>=</span>
            <span class=n>a</span> <span class=o>-&gt;</span> <span class=n>b</span> <span class=o>-&gt;</span> <span class=n>c</span> <span class=o>-&gt;</span> <span class=n>a</span> <span class=o>+</span> <span class=n>b</span> <span class=o>+</span> <span class=n>c</span><span class=p>;</span>
      <span class=n>Function</span><span class=o>&lt;</span><span class=n>String</span><span class=p>,</span>
        <span class=n>Function</span><span class=o>&lt;</span><span class=n>String</span><span class=p>,</span> <span class=n>String</span><span class=o>&gt;&gt;</span> <span class=n>hi</span> <span class=o>=</span>
          <span class=n>sum</span><span class=p>.</span><span class=na>apply</span><span class=p>(</span><span class=s>&quot;Hi &quot;</span><span class=p>);</span>
      <span class=n>Function</span><span class=o>&lt;</span><span class=n>String</span><span class=p>,</span> <span class=n>String</span><span class=o>&gt;</span> <span class=n>ho</span> <span class=o>=</span>
        <span class=n>hi</span><span class=p>.</span><span class=na>apply</span><span class=p>(</span><span class=s>&quot;Ho &quot;</span><span class=p>);</span>
      <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>ho</span><span class=p>.</span><span class=na>apply</span><span class=p>(</span><span class=s>&quot;Hup&quot;</span><span class=p>));</span>
   <span class=p>}</span>
<span class=p>}</span>
</code></pre></div> <p>输出结果：</p> <div class=highlight><pre><span></span><code>Hi Ho Hup
</code></pre></div> <p>对于每个级别的箭头级联（Arrow-cascading），你都要在类型声明中包裹另一层 <strong>Function</strong>。</p> <p>处理基本类型和装箱时，请使用适当的函数式接口：</p> <div class=highlight><pre><span></span><code><span class=c1>// functional/CurriedIntAdd.java</span>

<span class=kn>import</span> <span class=nn>java.util.function.*</span><span class=p>;</span>

<span class=kd>public</span> <span class=kd>class</span> <span class=nc>CurriedIntAdd</span> <span class=p>{</span>
  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=p>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>IntFunction</span><span class=o>&lt;</span><span class=n>IntUnaryOperator</span><span class=o>&gt;</span>
      <span class=n>curriedIntAdd</span> <span class=o>=</span> <span class=n>a</span> <span class=o>-&gt;</span> <span class=n>b</span> <span class=o>-&gt;</span> <span class=n>a</span> <span class=o>+</span> <span class=n>b</span><span class=p>;</span>
    <span class=n>IntUnaryOperator</span> <span class=n>add4</span> <span class=o>=</span> <span class=n>curriedIntAdd</span><span class=p>.</span><span class=na>apply</span><span class=p>(</span><span class=mi>4</span><span class=p>);</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>add4</span><span class=p>.</span><span class=na>applyAsInt</span><span class=p>(</span><span class=mi>5</span><span class=p>));</span>
      <span class=p>}</span>
<span class=p>}</span>
</code></pre></div> <p>输出结果：</p> <div class=highlight><pre><span></span><code>9
</code></pre></div> <p>可以在互联网上找到更多的柯里化示例。通常它们是用 Java 之外的语言实现的，但如果理解了柯里化的基本概念，你可以很轻松地用 Java 实现它们。</p> <!-- Pure Functional Programming --> <h2 id=_15>纯函数式编程<a class=headerlink href=#_15 title="Permanent link">#</a></h2> <p>即使没有函数式支持，像 C 这样的基础语言，也可以按照一定的原则编写纯函数式程序。Java 8 让函数式编程更简单，不过我们要确保一切是 <code>final</code> 的，同时你的所有方法和函数没有副作用。因为 Java 在本质上并非是不可变语言，所以编译器对我们犯的错误将无能为力。</p> <p>这种情况下，我们可以借助第三方工具<sup id=fnref:9><a class=footnote-ref href=#fn:9>9</a></sup>，但使用 Scala 或 Clojure 这样的语言可能更简单。因为它们从一开始就是为保持不变性而设计的。你可以采用这些语言来编写你的 Java 项目的一部分。如果必须要用纯函数式编写，则可以用 Scala（需要遵循一些规则） 或 Clojure （遵循的规则更少）。虽然 Java 支持<a href=../24-Concurrent-Programming/ >并发编程</a>，但如果这是你项目的核心部分，你应该考虑在项目部分功能中使用 <code>Scala</code> 或 <code>Clojure</code> 之类的语言。</p> <!-- Summary --> <h2 id=_16>本章小结<a class=headerlink href=#_16 title="Permanent link">#</a></h2> <p>Lambda 表达式和方法引用并没有将 Java 转换成函数式语言，而是提供了对函数式编程的支持。这对 Java 来说是一个巨大的改进。因为这允许你编写更简洁明了，易于理解的代码。在下一章中，你会看到它们在流式编程中的应用。相信你会像我一样，喜欢上流式编程。</p> <p>这些特性满足了很多羡慕Clojure、Scala 这类更函数化语言的程序员，并且阻止了Java程序员转向那些更函数化的语言（就算不能阻止，起码提供了更好的选择）。</p> <p>但是，Lambdas 和方法引用远非完美，我们永远要为 Java 设计者早期的草率决定付出代价。特别是没有泛型 Lambda，所以 Lambda 在 Java 中并非一等公民。虽然我不否认 Java 8 的巨大改进，但这意味着和许多 Java 特性一样，它终究还是会让人感觉沮丧和鸡肋。</p> <p>当你遇到学习困难时，请记住通过 IDE（NetBeans、IntelliJ Idea 和 Eclipse）获得帮助，因为 IDE 可以智能提示你何时使用 Lambda 表达式或方法引用，甚至有时还能为你优化代码。</p> <!--下面是脚注--> <!-- 分页 --> <div style="page-break-after: always;"></div> <div class=footnote> <hr> <ol> <li id=fn:1> <p>功能粘贴在一起的方法的确有点与众不同，但它仍不失为一个库。&#160;<a class=footnote-backref href=#fnref:1 title="Jump back to footnote 1 in the text">&#8617;</a></p> </li> <li id=fn:2> <p>例如,这个电子书是利用 <a href=http://pandoc.org/ >Pandoc</a> 制作出来的，它是用纯函数式语言 <a href=https://www.haskell.org/ >Haskell</a> 编写的一个程序 。&#160;<a class=footnote-backref href=#fnref:2 title="Jump back to footnote 2 in the text">&#8617;</a></p> </li> <li id=fn:3> <p>有时函数式语言将其描述为“代码即数据”。&#160;<a class=footnote-backref href=#fnref:3 title="Jump back to footnote 3 in the text">&#8617;</a></p> </li> <li id=fn:4> <p>这个语法来自 C++。&#160;<a class=footnote-backref href=#fnref:4 title="Jump back to footnote 4 in the text">&#8617;</a></p> </li> <li id=fn:5> <p>我还没有验证过这种说法。&#160;<a class=footnote-backref href=#fnref:5 title="Jump back to footnote 5 in the text">&#8617;</a></p> </li> <li id=fn:6> <p>当你理解了<a href=../24-Concurrent-Programming/ >并发编程</a>章节的内容，你就能明白为什么更改共享变量 “不是线程安全的” 的了。&#160;<a class=footnote-backref href=#fnref:6 title="Jump back to footnote 6 in the text">&#8617;</a></p> </li> <li id=fn:7> <p>接口能够支持方法的原因是它们是 Java 8 默认方法，你将在下一章中了解到。&#160;<a class=footnote-backref href=#fnref:7 title="Jump back to footnote 7 in the text">&#8617;</a></p> </li> <li id=fn:8> <p>一些语言，如 Python，允许像调用其他函数一样调用组合函数。但这是 Java，所以我们做做可为之事。&#160;<a class=footnote-backref href=#fnref:8 title="Jump back to footnote 8 in the text">&#8617;</a></p> </li> <li id=fn:9> <p>例如，<a href=https://immutables.github.io/ >Immutables</a> 和 <a href=https://mutabilitydetector.github.io/MutabilityDetector/ >Mutability Detector</a>。&#160;<a class=footnote-backref href=#fnref:9 title="Jump back to footnote 9 in the text">&#8617;</a></p> </li> </ol> </div> </article> </div> </div> </main> <footer class=md-footer> <div class=md-footer-nav> <nav class="md-footer-nav__inner md-grid"> <a href=../12-Collections/ title="12 Collections" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel=prev> <div class="md-flex__cell md-flex__cell--shrink"> <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i> </div> <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"> <span class=md-flex__ellipsis> <span class=md-footer-nav__direction> 上一页 </span> 12 Collections </span> </div> </a> <a href=../14-Streams/ title="14 Streams" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel=next> <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"> <span class=md-flex__ellipsis> <span class=md-footer-nav__direction> 下一页 </span> 14 Streams </span> </div> <div class="md-flex__cell md-flex__cell--shrink"> <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i> </div> </a> </nav> </div> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-copyright> powered by <a href=https://www.mkdocs.org target=_blank rel=noopener>MkDocs</a> and <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs</a> </div> <div class=md-footer-social> <link rel=stylesheet href=../../../../../assets/fonts/font-awesome.css> <a href=https://leay.net target=_blank rel=noopener title=home class="md-footer-social__link fa fa-home"></a> <a href=https://github.com/hqweay target=_blank rel=noopener title=github class="md-footer-social__link fa fa-github"></a> </div> </div> </div> </footer> </div> <script src=../../../../../assets/javascripts/application.c33a9706.js></script> <script src=../../../../../assets/javascripts/lunr/lunr.stemmer.support.js></script> <script src=../../../../../assets/javascripts/lunr/tinyseg.js></script> <script src=../../../../../assets/javascripts/lunr/lunr.ja.js></script> <script src=../../../../../assets/javascripts/lunr/lunr.multi.js></script> <script>app.initialize({version:"1.1",url:{base:"../../../../.."}})</script> </body> </html>