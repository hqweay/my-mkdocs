<!doctype html><html lang=zh class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=description content="Thinking Drafts"><link href=https://wiki.leay.net/book/OnJava8/docs/book/12-Collections/ rel=canonical><meta name=author content=hqweay><meta name=lang:clipboard.copy content=复制><meta name=lang:clipboard.copied content=已复制><meta name=lang:search.language content="en, ja"><meta name=lang:search.pipeline.stopwords content=True><meta name=lang:search.pipeline.trimmer content=True><meta name=lang:search.result.none content=没有找到符合条件的结果><meta name=lang:search.result.one content="找到 1 个符合条件的结果"><meta name=lang:search.result.other content="# 个符合条件的结果"><meta name=lang:search.tokenizer content=[\uff0c\u3002]+><link rel="shortcut icon" href=../../../../../img/favicon.ico><meta name=generator content="mkdocs-1.1, mkdocs-material-4.6.3"><title>12 Collections - Hqweay's Wiki</title><link rel=stylesheet href=../../../../../assets/stylesheets/application.adb8469c.css><link rel=stylesheet href=../../../../../assets/stylesheets/application-palette.a8b3c06d.css><meta name=theme-color content=#3f51b5><script src=../../../../../assets/javascripts/modernizr.86422ebf.js></script><link href=https://fonts.gstatic.com rel=preconnect crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Noto+Serif+SC:300,400,400i,700%7CRoboto+Mono&display=fallback"><style>body,input{font-family:"Noto Serif SC","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style><link rel=stylesheet href=../../../../../assets/fonts/material-icons.css><script>
  window.ga = window.ga || function() {
    (ga.q = ga.q || []).push(arguments)
  }
  ga.l = +new Date
  /* Setup integration and send page view */
  ga("create", "UA-105976066-3", "wiki.leay.net")
  ga("set", "anonymizeIp", true)
  ga("send", "pageview")
  /* Register handler to log search on blur */
  document.addEventListener("DOMContentLoaded", () => {
    if (document.forms.search) {
      var query = document.forms.search.query
      query.addEventListener("blur", function() {
        if (this.value) {
          var path = document.location.pathname;
          ga("send", "pageview", path + "?q=" + this.value)
        }
      })
    }
  })
</script><script async src=https://www.google-analytics.com/analytics.js></script></head> <body dir=ltr data-md-color-primary=indigo data-md-color-accent=indigo> <svg class=md-svg> <defs> <svg xmlns=http://www.w3.org/2000/svg width=416 height=448 viewbox="0 0 416 448" id=__github><path fill=currentColor d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg> </defs> </svg> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay data-md-component=overlay for=__drawer></label> <a href=#_1 tabindex=0 class=md-skip> 跳转至 </a> <header class=md-header data-md-component=header> <nav class="md-header-nav md-grid"> <div class=md-flex> <div class="md-flex__cell md-flex__cell--shrink"> <a href=https://wiki.leay.net/ title="Hqweay's Wiki" aria-label="Hqweay's Wiki" class="md-header-nav__button md-logo"> <i class=md-icon></i> </a> </div> <div class="md-flex__cell md-flex__cell--shrink"> <label class="md-icon md-icon--menu md-header-nav__button" for=__drawer></label> </div> <div class="md-flex__cell md-flex__cell--stretch"> <div class="md-flex__ellipsis md-header-nav__title" data-md-component=title> <span class=md-header-nav__topic> Hqweay's Wiki </span> <span class=md-header-nav__topic> 12 Collections </span> </div> </div> <div class="md-flex__cell md-flex__cell--shrink"> <label class="md-icon md-icon--search md-header-nav__button" for=__search></label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input aria-label=search name=query placeholder=搜索 autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=query data-md-state=active> <label class="md-icon md-search__icon" for=__search></label> <button type=reset class="md-icon md-search__icon" data-md-component=reset tabindex=-1> &#xE5CD; </button> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=result> <div class=md-search-result__meta> 键入以开始搜索 </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> </div> <div class="md-flex__cell md-flex__cell--shrink"> <div class=md-header-nav__source> <a href=https://github.com/hqweay/my-mkdocs/ title="前往 Github 仓库" class=md-source data-md-source=github> <div class=md-source__icon> <svg viewbox="0 0 24 24" width=24 height=24> <use xlink:href=#__github width=24 height=24></use> </svg> </div> <div class=md-source__repository> hqweay/my-mkdocs </div> </a> </div> </div> </div> </nav> </header> <div class=md-container> <nav class="md-tabs md-tabs--active" data-md-component=tabs> <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../../../../.. class=md-tabs__link> About </a> </li> <li class=md-tabs__item> <a href=../../../ class="md-tabs__link md-tabs__link--active"> Book </a> </li> <li class=md-tabs__item> <a href=../../../../../doc/ class=md-tabs__link> Doc </a> </li> <li class=md-tabs__item> <a href=../../../../../life/reading/ class=md-tabs__link> Life </a> </li> <li class=md-tabs__item> <a href=../../../../../study/draft/try-wiki/ class=md-tabs__link> Study </a> </li> <li class=md-tabs__item> <a href=../../../../../tech/code/frontend/2017-09-14-easy-web-test/ class=md-tabs__link> Tech </a> </li> </ul> </div> </nav> <main class=md-main role=main> <div class="md-main__inner md-grid" data-md-component=container> <div class="md-sidebar md-sidebar--primary" data-md-component=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" data-md-level=0> <label class="md-nav__title md-nav__title--site" for=__drawer> <a href=https://wiki.leay.net/ title="Hqweay's Wiki" class="md-nav__button md-logo"> <i class=md-icon></i> </a> Hqweay's Wiki </label> <div class=md-nav__source> <a href=https://github.com/hqweay/my-mkdocs/ title="前往 Github 仓库" class=md-source data-md-source=github> <div class=md-source__icon> <svg viewbox="0 0 24 24" width=24 height=24> <use xlink:href=#__github width=24 height=24></use> </svg> </div> <div class=md-source__repository> hqweay/my-mkdocs </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../.. title=About class=md-nav__link> About </a> </li> <li class=md-nav__item> <a href=../../../../../test/ title=特殊语法 class=md-nav__link> 特殊语法 </a> </li> <li class=md-nav__item> <a href=../../../../../web-page/ title=静态文档导航 class=md-nav__link> 静态文档导航 </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-4 type=checkbox id=nav-4 checked> <label class=md-nav__link for=nav-4> Book </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-4> Book </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-4-1 type=checkbox id=nav-4-1 checked> <label class=md-nav__link for=nav-4-1> OnJava8 </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-4-1> OnJava8 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../ title="《On Java 8》中文版" class=md-nav__link> 《On Java 8》中文版 </a> </li> <li class=md-nav__item> <a href=../../../CONTRIBUTING/ title=CONTRIBUTING class=md-nav__link> CONTRIBUTING </a> </li> <li class=md-nav__item> <a href=../../../SUMMARY/ title=Summary class=md-nav__link> Summary </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-4-1-4 type=checkbox id=nav-4-1-4 checked> <label class=md-nav__link for=nav-4-1-4> Docs </label> <nav class=md-nav data-md-component=collapsible data-md-level=3> <label class=md-nav__title for=nav-4-1-4> Docs </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../ title=译者的话 class=md-nav__link> 译者的话 </a> </li> <li class=md-nav__item> <a href=../../_coverpage/ title=coverpage class=md-nav__link> coverpage </a> </li> <li class=md-nav__item> <a href=../../sidebar/ title=Sidebar class=md-nav__link> Sidebar </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-4-1-4-4 type=checkbox id=nav-4-1-4-4> <label class=md-nav__link for=nav-4-1-4-4> style </label> <nav class=md-nav data-md-component=collapsible data-md-level=4> <label class=md-nav__title for=nav-4-1-4-4> style </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-4-1-4-4-1 type=checkbox id=nav-4-1-4-4-1> <label class=md-nav__link for=nav-4-1-4-4-1> Prism master </label> <nav class=md-nav data-md-component=collapsible data-md-level=5> <label class=md-nav__title for=nav-4-1-4-4-1> Prism master </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../_style/prism-master/ title=[Prism](http://prismjs.com/) class=md-nav__link> [Prism](http://prismjs.com/) </a> </li> <li class=md-nav__item> <a href=../../_style/prism-master/CHANGELOG/ title="Prism Changelog" class=md-nav__link> Prism Changelog </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-4-1-4-5 type=checkbox id=nav-4-1-4-5 checked> <label class=md-nav__link for=nav-4-1-4-5> Book </label> <nav class=md-nav data-md-component=collapsible data-md-level=4> <label class=md-nav__title for=nav-4-1-4-5> Book </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../00-Introduction/ title=简介 class=md-nav__link> 简介 </a> </li> <li class=md-nav__item> <a href=../00-On-Java-8/ title="00 On Java 8" class=md-nav__link> 00 On Java 8 </a> </li> <li class=md-nav__item> <a href=../00-Preface/ title=前言 class=md-nav__link> 前言 </a> </li> <li class=md-nav__item> <a href=../01-What-is-an-Object/ title="第一章 对象的概念" class=md-nav__link> 第一章 对象的概念 </a> </li> <li class=md-nav__item> <a href=../02-Installing-Java-and-the-Book-Examples/ title="02 Installing Java and the Book Examples" class=md-nav__link> 02 Installing Java and the Book Examples </a> </li> <li class=md-nav__item> <a href=../03-Objects-Everywhere/ title="03 Objects Everywhere" class=md-nav__link> 03 Objects Everywhere </a> </li> <li class=md-nav__item> <a href=../04-Operators/ title="04 Operators" class=md-nav__link> 04 Operators </a> </li> <li class=md-nav__item> <a href=../05-Control-Flow/ title="05 Control Flow" class=md-nav__link> 05 Control Flow </a> </li> <li class=md-nav__item> <a href=../06-Housekeeping/ title="06 Housekeeping" class=md-nav__link> 06 Housekeeping </a> </li> <li class=md-nav__item> <a href=../07-Implementation-Hiding/ title="07 Implementation Hiding" class=md-nav__link> 07 Implementation Hiding </a> </li> <li class=md-nav__item> <a href=../08-Reuse/ title="08 Reuse" class=md-nav__link> 08 Reuse </a> </li> <li class=md-nav__item> <a href=../09-Polymorphism/ title="09 Polymorphism" class=md-nav__link> 09 Polymorphism </a> </li> <li class=md-nav__item> <a href=../10-Interfaces/ title="10 Interfaces" class=md-nav__link> 10 Interfaces </a> </li> <li class=md-nav__item> <a href=../11-Inner-Classes/ title="11 Inner Classes" class=md-nav__link> 11 Inner Classes </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-toggle md-nav__toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> 12 Collections </label> <a href=./ title="12 Collections" class="md-nav__link md-nav__link--active"> 12 Collections </a> <nav class="md-nav md-nav--secondary"> <label class=md-nav__title for=__toc>目录</label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=#_2 class=md-nav__link> 泛型和类型安全的集合 </a> </li> <li class=md-nav__item> <a href=#_3 class=md-nav__link> 基本概念 </a> </li> <li class=md-nav__item> <a href=#_4 class=md-nav__link> 添加元素组 </a> </li> <li class=md-nav__item> <a href=#_5 class=md-nav__link> 集合的打印 </a> </li> <li class=md-nav__item> <a href=#list class=md-nav__link> 列表List </a> </li> <li class=md-nav__item> <a href=#iterators class=md-nav__link> 迭代器Iterators </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#listiterator class=md-nav__link> ListIterator </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#linkedlist class=md-nav__link> 链表LinkedList </a> </li> <li class=md-nav__item> <a href=#stack class=md-nav__link> 堆栈Stack </a> </li> <li class=md-nav__item> <a href=#set class=md-nav__link> 集合Set </a> </li> <li class=md-nav__item> <a href=#map class=md-nav__link> 映射Map </a> </li> <li class=md-nav__item> <a href=#queue class=md-nav__link> 队列Queue </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#priorityqueue class=md-nav__link> 优先级队列PriorityQueue </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_6 class=md-nav__link> 集合与迭代器 </a> </li> <li class=md-nav__item> <a href=#for-in class=md-nav__link> for-in和迭代器 </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_7 class=md-nav__link> 适配器方法惯用法 </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_8 class=md-nav__link> 本章小结 </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_9 class=md-nav__link> 简单集合分类 </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../13-Functional-Programming/ title="13 Functional Programming" class=md-nav__link> 13 Functional Programming </a> </li> <li class=md-nav__item> <a href=../14-Streams/ title="14 Streams" class=md-nav__link> 14 Streams </a> </li> <li class=md-nav__item> <a href=../15-Exceptions/ title="15 Exceptions" class=md-nav__link> 15 Exceptions </a> </li> <li class=md-nav__item> <a href=../16-Validating-Your-Code/ title="16 Validating Your Code" class=md-nav__link> 16 Validating Your Code </a> </li> <li class=md-nav__item> <a href=../17-Files/ title="17 Files" class=md-nav__link> 17 Files </a> </li> <li class=md-nav__item> <a href=../18-Strings/ title="18 Strings" class=md-nav__link> 18 Strings </a> </li> <li class=md-nav__item> <a href=../19-Type-Information/ title="19 Type Information" class=md-nav__link> 19 Type Information </a> </li> <li class=md-nav__item> <a href=../20-Generics/ title="20 Generics" class=md-nav__link> 20 Generics </a> </li> <li class=md-nav__item> <a href=../21-Arrays/ title="21 Arrays" class=md-nav__link> 21 Arrays </a> </li> <li class=md-nav__item> <a href=../22-Enumerations/ title="22 Enumerations" class=md-nav__link> 22 Enumerations </a> </li> <li class=md-nav__item> <a href=../23-Annotations/ title="23 Annotations" class=md-nav__link> 23 Annotations </a> </li> <li class=md-nav__item> <a href=../24-Concurrent-Programming/ title="24 Concurrent Programming" class=md-nav__link> 24 Concurrent Programming </a> </li> <li class=md-nav__item> <a href=../25-Patterns/ title="25 Patterns" class=md-nav__link> 25 Patterns </a> </li> <li class=md-nav__item> <a href=../Appendix-Becoming-a-Programmer/ title="Appendix Becoming a Programmer" class=md-nav__link> Appendix Becoming a Programmer </a> </li> <li class=md-nav__item> <a href=../Appendix-Benefits-and-Costs-of-Static-Type-Checking/ title="Appendix Benefits and Costs of Static Type Checking" class=md-nav__link> Appendix Benefits and Costs of Static Type Checking </a> </li> <li class=md-nav__item> <a href=../Appendix-Collection-Topics/ title="Appendix Collection Topics" class=md-nav__link> Appendix Collection Topics </a> </li> <li class=md-nav__item> <a href=../Appendix-Data-Compression/ title="Appendix Data Compression" class=md-nav__link> Appendix Data Compression </a> </li> <li class=md-nav__item> <a href=../Appendix-IO-Streams/ title="Appendix IO Streams" class=md-nav__link> Appendix IO Streams </a> </li> <li class=md-nav__item> <a href=../Appendix-Javadoc/ title="Appendix Javadoc" class=md-nav__link> Appendix Javadoc </a> </li> <li class=md-nav__item> <a href=../Appendix-Low-Level-Concurrency/ title="Appendix Low Level Concurrency" class=md-nav__link> Appendix Low Level Concurrency </a> </li> <li class=md-nav__item> <a href=../Appendix-New-IO/ title="Appendix New IO" class=md-nav__link> Appendix New IO </a> </li> <li class=md-nav__item> <a href=../Appendix-Object-Serialization/ title="Appendix Object Serialization" class=md-nav__link> Appendix Object Serialization </a> </li> <li class=md-nav__item> <a href=../Appendix-Passing-and-Returning-Objects/ title="Appendix Passing and Returning Objects" class=md-nav__link> Appendix Passing and Returning Objects </a> </li> <li class=md-nav__item> <a href=../Appendix-Programming-Guidelines/ title="Appendix Programming Guidelines" class=md-nav__link> Appendix Programming Guidelines </a> </li> <li class=md-nav__item> <a href=../Appendix-Standard-IO/ title="Appendix Standard IO" class=md-nav__link> Appendix Standard IO </a> </li> <li class=md-nav__item> <a href=../Appendix-Supplements/ title="Appendix Supplements" class=md-nav__link> Appendix Supplements </a> </li> <li class=md-nav__item> <a href=../Appendix-The-Positive-Legacy-of-C-plus-plus-and-Java/ title="Appendix The Positive Legacy of C plus plus and Java" class=md-nav__link> Appendix The Positive Legacy of C plus plus and Java </a> </li> <li class=md-nav__item> <a href=../Appendix-Understanding-equals-and-hashCode/ title="Appendix Understanding equals and hashCode" class=md-nav__link> Appendix Understanding equals and hashCode </a> </li> <li class=md-nav__item> <a href=../GLOSSARY/ title=GLOSSARY class=md-nav__link> GLOSSARY </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-5 type=checkbox id=nav-5> <label class=md-nav__link for=nav-5> Doc </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-5> Doc </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../doc/ title=About class=md-nav__link> About </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-5-2 type=checkbox id=nav-5-2> <label class=md-nav__link for=nav-5-2> English </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-5-2> English </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-5-2-1 type=checkbox id=nav-5-2-1> <label class=md-nav__link for=nav-5-2-1> A Programmers Guide to English </label> <nav class=md-nav data-md-component=collapsible data-md-level=3> <label class=md-nav__title for=nav-5-2-1> A Programmers Guide to English </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../doc/english/A-Programmers-Guide-to-English/ title="A Programmer's Guide to English" class=md-nav__link> A Programmer's Guide to English </a> </li> <li class=md-nav__item> <a href=../../../../../doc/english/A-Programmers-Guide-to-English/SUMMARY/ title=Summary class=md-nav__link> Summary </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-5-2-1-3 type=checkbox id=nav-5-2-1-3> <label class=md-nav__link for=nav-5-2-1-3> Essence </label> <nav class=md-nav data-md-component=collapsible data-md-level=4> <label class=md-nav__title for=nav-5-2-1-3> Essence </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../doc/english/A-Programmers-Guide-to-English/essence/ title=语言学习的本质浅析 class=md-nav__link> 语言学习的本质浅析 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-5-2-1-4 type=checkbox id=nav-5-2-1-4> <label class=md-nav__link for=nav-5-2-1-4> Make a program </label> <nav class=md-nav data-md-component=collapsible data-md-level=4> <label class=md-nav__title for=nav-5-2-1-4> Make a program </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../doc/english/A-Programmers-Guide-to-English/make-a-program/ title=如何构建一个识别英语的程序 class=md-nav__link> 如何构建一个识别英语的程序 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-5-2-1-5 type=checkbox id=nav-5-2-1-5> <label class=md-nav__link for=nav-5-2-1-5> Qa </label> <nav class=md-nav data-md-component=collapsible data-md-level=4> <label class=md-nav__title for=nav-5-2-1-5> Qa </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../doc/english/A-Programmers-Guide-to-English/qa/ title="常见问题 QA" class=md-nav__link> 常见问题 QA </a> </li> <li class=md-nav__item> <a href=../../../../../doc/english/A-Programmers-Guide-to-English/qa/WhyPTE/ title="为什么我选择 PTE 考试" class=md-nav__link> 为什么我选择 PTE 考试 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-5-2-1-6 type=checkbox id=nav-5-2-1-6> <label class=md-nav__link for=nav-5-2-1-6> Resources </label> <nav class=md-nav data-md-component=collapsible data-md-level=4> <label class=md-nav__title for=nav-5-2-1-6> Resources </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../doc/english/A-Programmers-Guide-to-English/resources/ title=资料、工具推荐和扩展阅读 class=md-nav__link> 资料、工具推荐和扩展阅读 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-5-2-1-7 type=checkbox id=nav-5-2-1-7> <label class=md-nav__link for=nav-5-2-1-7> Training </label> <nav class=md-nav data-md-component=collapsible data-md-level=4> <label class=md-nav__title for=nav-5-2-1-7> Training </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../doc/english/A-Programmers-Guide-to-English/training/ title=我的训练方法 class=md-nav__link> 我的训练方法 </a> </li> <li class=md-nav__item> <a href=../../../../../doc/english/A-Programmers-Guide-to-English/training/KnowledgeBase/ title=扩充语料库的训练方法 class=md-nav__link> 扩充语料库的训练方法 </a> </li> <li class=md-nav__item> <a href=../../../../../doc/english/A-Programmers-Guide-to-English/training/ListeningandSpeaking/ title=发音和听力训练方法 class=md-nav__link> 发音和听力训练方法 </a> </li> <li class=md-nav__item> <a href=../../../../../doc/english/A-Programmers-Guide-to-English/training/Thinking/ title=英语思维训练 class=md-nav__link> 英语思维训练 </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-5-2-2 type=checkbox id=nav-5-2-2> <label class=md-nav__link for=nav-5-2-2> English level up tips for Chinese </label> <nav class=md-nav data-md-component=collapsible data-md-level=3> <label class=md-nav__title for=nav-5-2-2> English level up tips for Chinese </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../doc/english/English-level-up-tips-for-Chinese/ title=English-level-up-tips-for-Chinese class=md-nav__link> English-level-up-tips-for-Chinese </a> </li> <li class=md-nav__item> <a href=../../../../../doc/english/English-level-up-tips-for-Chinese/SUMMARY/ title=Summary class=md-nav__link> Summary </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-5-2-2-3 type=checkbox id=nav-5-2-2-3> <label class=md-nav__link for=nav-5-2-2-3> Part 1 </label> <nav class=md-nav data-md-component=collapsible data-md-level=4> <label class=md-nav__title for=nav-5-2-2-3> Part 1 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../doc/english/English-level-up-tips-for-Chinese/part-1/1-understanding/ title=认知篇 class=md-nav__link> 认知篇 </a> </li> <li class=md-nav__item> <a href=../../../../../doc/english/English-level-up-tips-for-Chinese/part-1/2-vocabulary/ title=单词篇 class=md-nav__link> 单词篇 </a> </li> <li class=md-nav__item> <a href=../../../../../doc/english/English-level-up-tips-for-Chinese/part-1/3-listening/ title=听力篇 class=md-nav__link> 听力篇 </a> </li> <li class=md-nav__item> <a href=../../../../../doc/english/English-level-up-tips-for-Chinese/part-1/4-reading/ title=阅读篇 class=md-nav__link> 阅读篇 </a> </li> <li class=md-nav__item> <a href=../../../../../doc/english/English-level-up-tips-for-Chinese/part-1/5-speaking/ title="5 speaking" class=md-nav__link> 5 speaking </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-5-2-2-4 type=checkbox id=nav-5-2-2-4> <label class=md-nav__link for=nav-5-2-2-4> Part 2 </label> <nav class=md-nav data-md-component=collapsible data-md-level=4> <label class=md-nav__title for=nav-5-2-2-4> Part 2 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../doc/english/English-level-up-tips-for-Chinese/part-2/x-misc/ title=扯淡篇 class=md-nav__link> 扯淡篇 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-5-2-2-5 type=checkbox id=nav-5-2-2-5> <label class=md-nav__link for=nav-5-2-2-5> Word list </label> <nav class=md-nav data-md-component=collapsible data-md-level=4> <label class=md-nav__title for=nav-5-2-2-5> Word list </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../doc/english/English-level-up-tips-for-Chinese/word-list/Go/ title=Go class=md-nav__link> Go </a> </li> <li class=md-nav__item> <a href=../../../../../doc/english/English-level-up-tips-for-Chinese/word-list/Java/ title=Java class=md-nav__link> Java </a> </li> <li class=md-nav__item> <a href=../../../../../doc/english/English-level-up-tips-for-Chinese/word-list/JavaScript/ title=JavaScript class=md-nav__link> JavaScript </a> </li> <li class=md-nav__item> <a href=../../../../../doc/english/English-level-up-tips-for-Chinese/word-list/PHP/ title=PHP class=md-nav__link> PHP </a> </li> <li class=md-nav__item> <a href=../../../../../doc/english/English-level-up-tips-for-Chinese/word-list/Python/ title=Python class=md-nav__link> Python </a> </li> <li class=md-nav__item> <a href=../../../../../doc/english/English-level-up-tips-for-Chinese/word-list/Swift/ title=Swift class=md-nav__link> Swift </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-5-2-3 type=checkbox id=nav-5-2-3> <label class=md-nav__link for=nav-5-2-3> Everyone can use english </label> <nav class=md-nav data-md-component=collapsible data-md-level=3> <label class=md-nav__title for=nav-5-2-3> Everyone can use english </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../doc/english/everyone-can-use-english/ title=人人都能用英语 class=md-nav__link> 人人都能用英语 </a> </li> <li class=md-nav__item> <a href=../../../../../doc/english/everyone-can-use-english/chapter1/ title="第一章 起点" class=md-nav__link> 第一章 起点 </a> </li> <li class=md-nav__item> <a href=../../../../../doc/english/everyone-can-use-english/chapter2/ title="第二章 口语" class=md-nav__link> 第二章 口语 </a> </li> <li class=md-nav__item> <a href=../../../../../doc/english/everyone-can-use-english/chapter3/ title="第三章 语音" class=md-nav__link> 第三章 语音 </a> </li> <li class=md-nav__item> <a href=../../../../../doc/english/everyone-can-use-english/chapter4/ title="第四章 朗读" class=md-nav__link> 第四章 朗读 </a> </li> <li class=md-nav__item> <a href=../../../../../doc/english/everyone-can-use-english/chapter5/ title="第五章 词典" class=md-nav__link> 第五章 词典 </a> </li> <li class=md-nav__item> <a href=../../../../../doc/english/everyone-can-use-english/chapter6/ title="第六章 语法" class=md-nav__link> 第六章 语法 </a> </li> <li class=md-nav__item> <a href=../../../../../doc/english/everyone-can-use-english/chapter7/ title="第七章 精读" class=md-nav__link> 第七章 精读 </a> </li> <li class=md-nav__item> <a href=../../../../../doc/english/everyone-can-use-english/chapter8/ title="第八章 叮嘱" class=md-nav__link> 第八章 叮嘱 </a> </li> <li class=md-nav__item> <a href=../../../../../doc/english/everyone-can-use-english/end/ title=后记 class=md-nav__link> 后记 </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-5-3 type=checkbox id=nav-5-3> <label class=md-nav__link for=nav-5-3> Writing </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-5-3> Writing </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-5-3-1 type=checkbox id=nav-5-3-1> <label class=md-nav__link for=nav-5-3-1> Chinese copywriting guidelines </label> <nav class=md-nav data-md-component=collapsible data-md-level=3> <label class=md-nav__title for=nav-5-3-1> Chinese copywriting guidelines </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../doc/writing/chinese-copywriting-guidelines/ title=中文文案排版指北 class=md-nav__link> 中文文案排版指北 </a> </li> <li class=md-nav__item> <a href=../../../../../doc/writing/chinese-copywriting-guidelines/CHANGELOG/ title=CHANGELOG class=md-nav__link> CHANGELOG </a> </li> <li class=md-nav__item> <a href=../../../../../doc/writing/chinese-copywriting-guidelines/README.en-US/ title="Chinese Copywriting Guidelines" class=md-nav__link> Chinese Copywriting Guidelines </a> </li> <li class=md-nav__item> <a href=../../../../../doc/writing/chinese-copywriting-guidelines/README.zh-CN/ title=中文文案排版指北 class=md-nav__link> 中文文案排版指北 </a> </li> <li class=md-nav__item> <a href=../../../../../doc/writing/chinese-copywriting-guidelines/README.zh-HK/ title=中文文案排版指北 class=md-nav__link> 中文文案排版指北 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-5-3-2 type=checkbox id=nav-5-3-2> <label class=md-nav__link for=nav-5-3-2> Document style guide </label> <nav class=md-nav data-md-component=collapsible data-md-level=3> <label class=md-nav__title for=nav-5-3-2> Document style guide </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../doc/writing/document-style-guide/ title=Index class=md-nav__link> Index </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-5-3-2-2 type=checkbox id=nav-5-3-2-2> <label class=md-nav__link for=nav-5-3-2-2> Docs </label> <nav class=md-nav data-md-component=collapsible data-md-level=4> <label class=md-nav__title for=nav-5-3-2-2> Docs </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../doc/writing/document-style-guide/docs/marks/ title=标点符号 class=md-nav__link> 标点符号 </a> </li> <li class=md-nav__item> <a href=../../../../../doc/writing/document-style-guide/docs/number/ title=数值 class=md-nav__link> 数值 </a> </li> <li class=md-nav__item> <a href=../../../../../doc/writing/document-style-guide/docs/paragraph/ title=段落 class=md-nav__link> 段落 </a> </li> <li class=md-nav__item> <a href=../../../../../doc/writing/document-style-guide/docs/reference/ title=参考链接 class=md-nav__link> 参考链接 </a> </li> <li class=md-nav__item> <a href=../../../../../doc/writing/document-style-guide/docs/structure/ title=文档体系 class=md-nav__link> 文档体系 </a> </li> <li class=md-nav__item> <a href=../../../../../doc/writing/document-style-guide/docs/text/ title=文本 class=md-nav__link> 文本 </a> </li> <li class=md-nav__item> <a href=../../../../../doc/writing/document-style-guide/docs/title/ title=标题 class=md-nav__link> 标题 </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-6 type=checkbox id=nav-6> <label class=md-nav__link for=nav-6> Life </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-6> Life </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-6-1 type=checkbox id=nav-6-1> <label class=md-nav__link for=nav-6-1> Reading </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-6-1> Reading </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../life/reading/ title=阅读 class=md-nav__link> 阅读 </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-6-1-2 type=checkbox id=nav-6-1-2> <label class=md-nav__link for=nav-6-1-2> Mark </label> <nav class=md-nav data-md-component=collapsible data-md-level=3> <label class=md-nav__title for=nav-6-1-2> Mark </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../life/reading/mark/back-up/ title="2019 暑假备份" class=md-nav__link> 2019 暑假备份 </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/mark/back/ title=例行收集 class=md-nav__link> 例行收集 </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/mark/efficiency-time/ title=效率、时间、鸡汤 class=md-nav__link> 效率、时间、鸡汤 </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/mark/fiction/ title=小说 class=md-nav__link> 小说 </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/mark/films-remark/ title=影评、电影 class=md-nav__link> 影评、电影 </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/mark/fo/ title=佛 class=md-nav__link> 佛 </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/mark/hackers-others/ title=互联网、思维方式 class=md-nav__link> 互联网、思维方式 </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/mark/hooked-media/ title=媒介反思 class=md-nav__link> 媒介反思 </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/mark/isaka-kotaro/ title=伊坂幸太郎 class=md-nav__link> 伊坂幸太郎 </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/mark/knote/ title=整理 class=md-nav__link> 整理 </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/mark/mark-knote/ title=浪费时间 class=md-nav__link> 浪费时间 </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/mark/meaning/ title=思维方式 class=md-nav__link> 思维方式 </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/mark/morimi-tomihiko/ title=森见登美彦的文字好有趣啊! class=md-nav__link> 森见登美彦的文字好有趣啊! </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/mark/murakamo-haruki/ title=村上春树 class=md-nav__link> 村上春树 </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/mark/no-fiction/ title=非虚构类 class=md-nav__link> 非虚构类 </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/mark/paper/ title=论文式总结 class=md-nav__link> 论文式总结 </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/mark/poem/ title=诗歌 class=md-nav__link> 诗歌 </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/mark/sence/ title=哲学相关通俗读物 class=md-nav__link> 哲学相关通俗读物 </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/mark/the-little-prince/ title="The Little Prince" class=md-nav__link> The Little Prince </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/mark/universe/ title=物理科普读物 class=md-nav__link> 物理科普读物 </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/mark/utopia/ title=乌托邦小说世界关于书籍的冷幽默 class=md-nav__link> 乌托邦小说世界关于书籍的冷幽默 </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/mark/western-politics/ title=政哲 class=md-nav__link> 政哲 </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/mark/what-we-talk-about/ title=日本文学 class=md-nav__link> 日本文学 </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/mark/wuxia/ title=武侠 class=md-nav__link> 武侠 </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/mark/xiao-bo/ title=王小波 class=md-nav__link> 王小波 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-6-1-3 type=checkbox id=nav-6-1-3> <label class=md-nav__link for=nav-6-1-3> Note </label> <nav class=md-nav data-md-component=collapsible data-md-level=3> <label class=md-nav__title for=nav-6-1-3> Note </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../life/reading/note/2017-09-02-book-JavaScript-DOM/ title="《JavaScript DOM 编程艺术》" class=md-nav__link> 《JavaScript DOM 编程艺术》 </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/note/2017-09-09-coding-javascript-down/ title="尽量把 JavaScript 代码放到 HTML 网页底部" class=md-nav__link> 尽量把 JavaScript 代码放到 HTML 网页底部 </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/note/2018-05-23-HTTP/ title="《HTTP 图解》" class=md-nav__link> 《HTTP 图解》 </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/note/2018-06-07-computer/ title=计算机系统基础 class=md-nav__link> 计算机系统基础 </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/note/2018-10-09-JVM/ title="JVM 笔记" class=md-nav__link> JVM 笔记 </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/note/2018-11-25-computer/ title=计算机系统概论 class=md-nav__link> 计算机系统概论 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-6-1-4 type=checkbox id=nav-6-1-4> <label class=md-nav__link for=nav-6-1-4> Review </label> <nav class=md-nav data-md-component=collapsible data-md-level=3> <label class=md-nav__title for=nav-6-1-4> Review </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../life/reading/review/2017-09-28-say-something/ title=听你吹牛的闲暇时光 class=md-nav__link> 听你吹牛的闲暇时光 </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/review/2017-09-29-wuxia/ title="《流星 蝴蝶 剑》简记" class=md-nav__link> 《流星 蝴蝶 剑》简记 </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/review/2017-12-30-xiao-bo/ title=波波老师 class=md-nav__link> 波波老师 </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/review/2018-01-17-lai-zi-xin-shi-jie/ title=《来自新世界》 class=md-nav__link> 《来自新世界》 </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/review/2018-10-06-October/ title=科普谈起 class=md-nav__link> 科普谈起 </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/review/2019-09-07-story/ title=从网络小说谈起。 class=md-nav__link> 从网络小说谈起。 </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-6-2 type=checkbox id=nav-6-2> <label class=md-nav__link for=nav-6-2> Watching </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-6-2> Watching </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../life/watching/2017-08-29-watch-movies-rencently/ title=最近看的几部电影 class=md-nav__link> 最近看的几部电影 </a> </li> <li class=md-nav__item> <a href=../../../../../life/watching/2017-10-13-september-movies-record/ title=九月观影记录 class=md-nav__link> 九月观影记录 </a> </li> <li class=md-nav__item> <a href=../../../../../life/watching/2017-11-01-October-summary/ title=十月看片与非专业类阅读 class=md-nav__link> 十月看片与非专业类阅读 </a> </li> <li class=md-nav__item> <a href=../../../../../life/watching/2017-12-01-1112/ title=观影与阅读记录 class=md-nav__link> 观影与阅读记录 </a> </li> <li class=md-nav__item> <a href=../../../../../life/watching/2018-01-10-12/ title=最近看片与阅读 class=md-nav__link> 最近看片与阅读 </a> </li> <li class=md-nav__item> <a href=../../../../../life/watching/2018-02-06-january/ title=一月观影记录 class=md-nav__link> 一月观影记录 </a> </li> <li class=md-nav__item> <a href=../../../../../life/watching/2018-03-08-February/ title=二月至今观影记录 class=md-nav__link> 二月至今观影记录 </a> </li> <li class=md-nav__item> <a href=../../../../../life/watching/2018-03-31-March/ title=三月观影记录 class=md-nav__link> 三月观影记录 </a> </li> <li class=md-nav__item> <a href=../../../../../life/watching/2018-12-26-Smultronst%C3%A4llet/ title=野草莓 class=md-nav__link> 野草莓 </a> </li> <li class=md-nav__item> <a href=../../../../../life/watching/2019-10-10-October/ title=克服本能就是善良吗？（从十月新番胡扯……） class=md-nav__link> 克服本能就是善良吗？（从十月新番胡扯……） </a> </li> <li class=md-nav__item> <a href=../../../../../life/watching/2019-11-04-bgm/ title=无人声环 class=md-nav__link> 无人声环 </a> </li> <li class=md-nav__item> <a href=../../../../../life/watching/2019-11-13-the-end-of-the-world/ title="The End of the Fucking World" class=md-nav__link> The End of the Fucking World </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-7 type=checkbox id=nav-7> <label class=md-nav__link for=nav-7> Study </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-7> Study </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-7-1 type=checkbox id=nav-7-1> <label class=md-nav__link for=nav-7-1> Draft </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-7-1> Draft </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../study/draft/try-wiki/ title="一些 Wiki 工具的尝试" class=md-nav__link> 一些 Wiki 工具的尝试 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-7-2 type=checkbox id=nav-7-2> <label class=md-nav__link for=nav-7-2> Language </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-7-2> Language </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../study/language/%E6%97%A5%E8%AF%AD%E5%85%A5%E9%97%A8/ title=日语入门 class=md-nav__link> 日语入门 </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-8 type=checkbox id=nav-8> <label class=md-nav__link for=nav-8> Tech </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-8> Tech </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-8-1 type=checkbox id=nav-8-1> <label class=md-nav__link for=nav-8-1> Code </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-8-1> Code </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-8-1-1 type=checkbox id=nav-8-1-1> <label class=md-nav__link for=nav-8-1-1> Frontend </label> <nav class=md-nav data-md-component=collapsible data-md-level=3> <label class=md-nav__title for=nav-8-1-1> Frontend </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../tech/code/frontend/2017-09-14-easy-web-test/ title=大表哥的电商网页实战体验 class=md-nav__link> 大表哥的电商网页实战体验 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/code/frontend/2017-09-23-know-nothing/ title=知其然不知其所以然 class=md-nav__link> 知其然不知其所以然 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/code/frontend/2018-06-08-responsive/ title=大表哥的响应式设计 class=md-nav__link> 大表哥的响应式设计 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/code/frontend/zh-javascript-info/ title="现代 JavaScript 教程摘录" class=md-nav__link> 现代 JavaScript 教程摘录 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-8-1-2 type=checkbox id=nav-8-1-2> <label class=md-nav__link for=nav-8-1-2> Go </label> <nav class=md-nav data-md-component=collapsible data-md-level=3> <label class=md-nav__title for=nav-8-1-2> Go </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../tech/code/go/01/ title=01 class=md-nav__link> 01 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-8-1-3 type=checkbox id=nav-8-1-3> <label class=md-nav__link for=nav-8-1-3> Java </label> <nav class=md-nav data-md-component=collapsible data-md-level=3> <label class=md-nav__title for=nav-8-1-3> Java </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../tech/code/java/2017-12-30-Java%20Web/ title="从 url 访问服务器资源讨论 Java Web 中的 Servlet" class=md-nav__link> 从 url 访问服务器资源讨论 Java Web 中的 Servlet </a> </li> <li class=md-nav__item> <a href=../../../../../tech/code/java/2018-11-23-ArrayList/ title=ArrayList class=md-nav__link> ArrayList </a> </li> <li class=md-nav__item> <a href=../../../../../tech/code/java/2019-01-31-HashMap/ title=HashMap class=md-nav__link> HashMap </a> </li> <li class=md-nav__item> <a href=../../../../../tech/code/java/2019-02-01-String/ title="String 分析(栈,堆,字符串常量池)" class=md-nav__link> String 分析(栈,堆,字符串常量池) </a> </li> <li class=md-nav__item> <a href=../../../../../tech/code/java/2019-02-03-String/ title=String、StringBuffer、StingBuilder class=md-nav__link> String、StringBuffer、StingBuilder </a> </li> <li class=md-nav__item> <a href=../../../../../tech/code/java/2019-02-06-Hashtable/ title=Hashtable class=md-nav__link> Hashtable </a> </li> <li class=md-nav__item> <a href=../../../../../tech/code/java/2019-03-22-string-pool/ title=字符串常量池到底保存的是字符串对象还是字符串对象的引用? class=md-nav__link> 字符串常量池到底保存的是字符串对象还是字符串对象的引用? </a> </li> <li class=md-nav__item> <a href=../../../../../tech/code/java/2019-03-23-Java-Thread-pool/ title="Java 线程池" class=md-nav__link> Java 线程池 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/code/java/2019-03-29-Java%20Web/ title="Java Web 启动流程" class=md-nav__link> Java Web 启动流程 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/code/java/2019-04-05-AQS-lock/ title="AQS 与 Java 锁的具体实现" class=md-nav__link> AQS 与 Java 锁的具体实现 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-8-1-4 type=checkbox id=nav-8-1-4> <label class=md-nav__link for=nav-8-1-4> Projects </label> <nav class=md-nav data-md-component=collapsible data-md-level=3> <label class=md-nav__title for=nav-8-1-4> Projects </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../tech/code/projects/2018-05-07-big-data/ title="大数据 Demo （采集、处理、应用）复盘" class=md-nav__link> 大数据 Demo （采集、处理、应用）复盘 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-8-1-5 type=checkbox id=nav-8-1-5> <label class=md-nav__link for=nav-8-1-5> Spring </label> <nav class=md-nav data-md-component=collapsible data-md-level=3> <label class=md-nav__title for=nav-8-1-5> Spring </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../tech/code/spring/2018-09-01-Spring%20Security/ title="Spring Boot 与 Spring Security" class=md-nav__link> Spring Boot 与 Spring Security </a> </li> <li class=md-nav__item> <a href=../../../../../tech/code/spring/2019-03-29-Spring-init/ title="Spring 启动流程与简单源码分析" class=md-nav__link> Spring 启动流程与简单源码分析 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/code/spring/2019-04-06-Spring-MVC/ title="Spring MVC 简单源码分析" class=md-nav__link> Spring MVC 简单源码分析 </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-8-2 type=checkbox id=nav-8-2> <label class=md-nav__link for=nav-8-2> Config </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-8-2> Config </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-8-2-1 type=checkbox id=nav-8-2-1> <label class=md-nav__link for=nav-8-2-1> Git </label> <nav class=md-nav data-md-component=collapsible data-md-level=3> <label class=md-nav__title for=nav-8-2-1> Git </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../tech/config/git/2018-02-01-git/ title="Git 的简单使用" class=md-nav__link> Git 的简单使用 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/config/git/2019-08-10-git-merge/ title="Git 协作管理项目时不可避免的 merge 操作" class=md-nav__link> Git 协作管理项目时不可避免的 merge 操作 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/config/git/submodule/ title=submodule class=md-nav__link> submodule </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-8-2-2 type=checkbox id=nav-8-2-2> <label class=md-nav__link for=nav-8-2-2> Linux </label> <nav class=md-nav data-md-component=collapsible data-md-level=3> <label class=md-nav__title for=nav-8-2-2> Linux </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../tech/config/linux/2019-12-18-manjaro/ title="Manjaro 个人新装配置" class=md-nav__link> Manjaro 个人新装配置 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/config/linux/2020-02-23-archer-s-arch/ title="Archer`s Arch" class=md-nav__link> Archer`s Arch </a> </li> <li class=md-nav__item> <a href=../../../../../tech/config/linux/fontconfig/ title="Arch Emoji fontconfig" class=md-nav__link> Arch Emoji fontconfig </a> </li> <li class=md-nav__item> <a href=../../../../../tech/config/linux/softwares/ title=各种工具 class=md-nav__link> 各种工具 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-8-2-3 type=checkbox id=nav-8-2-3> <label class=md-nav__link for=nav-8-2-3> Tools </label> <nav class=md-nav data-md-component=collapsible data-md-level=3> <label class=md-nav__title for=nav-8-2-3> Tools </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../tech/config/tools/cz-conventional-changelog/ title=cz-conventional-changelog class=md-nav__link> cz-conventional-changelog </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-8-2-4 type=checkbox id=nav-8-2-4> <label class=md-nav__link for=nav-8-2-4> Undefined </label> <nav class=md-nav data-md-component=collapsible data-md-level=3> <label class=md-nav__title for=nav-8-2-4> Undefined </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../tech/config/undefined/2018-03-31-Generator-SpringBoot-Gradle/ title="MyBatis Generator + Spring Boot + Gradle 配置" class=md-nav__link> MyBatis Generator + Spring Boot + Gradle 配置 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/config/undefined/2018-06-25-VS-Code-Python/ title="VS Code 写 Python" class=md-nav__link> VS Code 写 Python </a> </li> <li class=md-nav__item> <a href=../../../../../tech/config/undefined/2018-06-26-linux-kawa/ title="在 Linux 上使用 kawa" class=md-nav__link> 在 Linux 上使用 kawa </a> </li> <li class=md-nav__item> <a href=../../../../../tech/config/undefined/2018-11-25-mysql/ title="【转】在 CentOS 上部署 MySQL 解压版" class=md-nav__link> 【转】在 CentOS 上部署 MySQL 解压版 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/config/undefined/2019-04-03-Redis-lock/ title="Redis 的分布式锁实现" class=md-nav__link> Redis 的分布式锁实现 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/config/undefined/2019-07-28-picGo/ title="Github + picGo ——有图床了" class=md-nav__link> Github + picGo ——有图床了 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/config/undefined/2019-11-18-linux-mount/ title="Linux 挂载分区/磁盘" class=md-nav__link> Linux 挂载分区/磁盘 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/config/undefined/2020-02-03-terminal-wifi/ title=把显卡驱动删了后在终端连热点 class=md-nav__link> 把显卡驱动删了后在终端连热点 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/config/undefined/2020-02-12-css/ title=一个引号引发的惨案 class=md-nav__link> 一个引号引发的惨案 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/config/undefined/2020-02-23-archer-s-arch/ title="Archer`s Arch" class=md-nav__link> Archer`s Arch </a> </li> <li class=md-nav__item> <a href=../../../../../tech/config/undefined/2020-03-12-electron-vue/ title="用 Vue 写 Electron 的一次问题解决" class=md-nav__link> 用 Vue 写 Electron 的一次问题解决 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/config/undefined/2020-03-12-ttrss/ title="部署 TTRSS 遇到的一些有趣的东西" class=md-nav__link> 部署 TTRSS 遇到的一些有趣的东西 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/config/undefined/2020-04-02-hexo-asset-image/ title="hexo-next-theme 开启 lazyload 使用 hexo-asset-image 出问题了" class=md-nav__link> hexo-next-theme 开启 lazyload 使用 hexo-asset-image 出问题了 </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-8-3 type=checkbox id=nav-8-3> <label class=md-nav__link for=nav-8-3> Project </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-8-3> Project </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../tech/project/2017-12-21-xiao-zong-jie/ title=做个小小的总结 class=md-nav__link> 做个小小的总结 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/project/2018-05-07-big-data/ title="大数据 Demo （采集、处理、应用）复盘" class=md-nav__link> 大数据 Demo （采集、处理、应用）复盘 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/project/2018-06-25-tencent-news-spider-py/ title=腾讯新闻爬虫 class=md-nav__link> 腾讯新闻爬虫 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/project/2018-09-13-lite-terminal-home-page/ title=简单的仿终端主页 class=md-nav__link> 简单的仿终端主页 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/project/2019-01-11-tank/ title=花里胡哨的坦克大战 class=md-nav__link> 花里胡哨的坦克大战 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/project/2019-02-05-new-year/ title=大年初一（爬取豆瓣条目及吐槽） class=md-nav__link> 大年初一（爬取豆瓣条目及吐槽） </a> </li> <li class=md-nav__item> <a href=../../../../../tech/project/2019-04-03-blog-project/ title=写博客 class=md-nav__link> 写博客 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/project/2019-06-17-nodejs/ title="MarkAll 导入豆瓣数据 —— NodeJS 写爬虫" class=md-nav__link> MarkAll 导入豆瓣数据 —— NodeJS 写爬虫 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/project/2019-11-15-Autumn-Json/ title="Autumn-From-Spring 自定义 BeanDefinitionReader" class=md-nav__link> Autumn-From-Spring 自定义 BeanDefinitionReader </a> </li> <li class=md-nav__item> <a href=../../../../../tech/project/2019-11-15-bookmarkdown/ title="Chrome 插件——书签转 MarkDown" class=md-nav__link> Chrome 插件——书签转 MarkDown </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-8-4 type=checkbox id=nav-8-4> <label class=md-nav__link for=nav-8-4> Undefined </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-8-4> Undefined </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../tech/undefined/2017-08-10-then-start/ title=那就开始吧 class=md-nav__link> 那就开始吧 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/undefined/2017-08-16-Writing-is%20the-reward-of-writing-itself/ title=写就是写本身的报酬 class=md-nav__link> 写就是写本身的报酬 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/undefined/2017-11-19-change-my-blog/ title=【过时内容】嘿，我转移博客啦！ class=md-nav__link> 【过时内容】嘿，我转移博客啦！ </a> </li> <li class=md-nav__item> <a href=../../../../../tech/undefined/2017-12-08-yao-guai-ji-yu-you-ren-bo/ title=妖怪唧唧与友人波波 class=md-nav__link> 妖怪唧唧与友人波波 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/undefined/2018-01-01-ubuntu/ title="折腾 ubuntu 与 win10 共存" class=md-nav__link> 折腾 ubuntu 与 win10 共存 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/undefined/2018-02-09-pc-system/ title="黑苹果与 Ubuntu 及 PC 折腾系统" class=md-nav__link> 黑苹果与 Ubuntu 及 PC 折腾系统 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/undefined/2018-03-12-install-Vmware-on-linux/ title="deepin 安装 VMware" class=md-nav__link> deepin 安装 VMware </a> </li> <li class=md-nav__item> <a href=../../../../../tech/undefined/2018-03-31-SQL/ title="Spring Boot 开发遇到一些 SQL 问题" class=md-nav__link> Spring Boot 开发遇到一些 SQL 问题 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/undefined/2018-04-06-jquery-confrim/ title="JQuery-Confrim 的一点问题" class=md-nav__link> JQuery-Confrim 的一点问题 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/undefined/2018-04-06-some-plugins/ title="ECharts + PageHelper + Bootstrap Table" class=md-nav__link> ECharts + PageHelper + Bootstrap Table </a> </li> <li class=md-nav__item> <a href=../../../../../tech/undefined/2018-04-09-js-in-thymeleaf/ title="Thymeleaf 里使用 JavaScript 时的注意事项" class=md-nav__link> Thymeleaf 里使用 JavaScript 时的注意事项 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/undefined/2018-04-09-spring-boot-gradle-yml-log4j2/ title="Spring Boot + Gradle + yml 配置 log4j2" class=md-nav__link> Spring Boot + Gradle + yml 配置 log4j2 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/undefined/2018-05-09-softwares/ title="Linux 常用软件" class=md-nav__link> Linux 常用软件 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/undefined/2018-05-30-hexo-image/ title="【可能过时】Hexo 一点问题（生成博文插入本地图片,修改文章路径）" class=md-nav__link> 【可能过时】Hexo 一点问题（生成博文插入本地图片,修改文章路径） </a> </li> <li class=md-nav__item> <a href=../../../../../tech/undefined/2018-05-30-show/ title=如果给文章提供多种渲染方式 class=md-nav__link> 如果给文章提供多种渲染方式 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/undefined/2018-08-30-vue-music/ title="简单的单页应用(Vue CLI2 的简单使用)" class=md-nav__link> 简单的单页应用(Vue CLI2 的简单使用) </a> </li> <li class=md-nav__item> <a href=../../../../../tech/undefined/2018-09-23-word-count/ title="WordCount 项目总结" class=md-nav__link> WordCount 项目总结 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/undefined/2020-02-06-markall-douban-backup/ title=豆瓣标记数据备份插件 class=md-nav__link> 豆瓣标记数据备份插件 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/undefined/2020-02-07-markall-douban-backup-yes/ title=【过时】又一个——豆瓣标记数据备份插件 class=md-nav__link> 【过时】又一个——豆瓣标记数据备份插件 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/undefined/2020-02-13-blog/ title=从分析本网站的网络请求谈起 class=md-nav__link> 从分析本网站的网络请求谈起 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/undefined/draft/ title=Draft class=md-nav__link> Draft </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary"> <label class=md-nav__title for=__toc>目录</label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=#_2 class=md-nav__link> 泛型和类型安全的集合 </a> </li> <li class=md-nav__item> <a href=#_3 class=md-nav__link> 基本概念 </a> </li> <li class=md-nav__item> <a href=#_4 class=md-nav__link> 添加元素组 </a> </li> <li class=md-nav__item> <a href=#_5 class=md-nav__link> 集合的打印 </a> </li> <li class=md-nav__item> <a href=#list class=md-nav__link> 列表List </a> </li> <li class=md-nav__item> <a href=#iterators class=md-nav__link> 迭代器Iterators </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#listiterator class=md-nav__link> ListIterator </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#linkedlist class=md-nav__link> 链表LinkedList </a> </li> <li class=md-nav__item> <a href=#stack class=md-nav__link> 堆栈Stack </a> </li> <li class=md-nav__item> <a href=#set class=md-nav__link> 集合Set </a> </li> <li class=md-nav__item> <a href=#map class=md-nav__link> 映射Map </a> </li> <li class=md-nav__item> <a href=#queue class=md-nav__link> 队列Queue </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#priorityqueue class=md-nav__link> 优先级队列PriorityQueue </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_6 class=md-nav__link> 集合与迭代器 </a> </li> <li class=md-nav__item> <a href=#for-in class=md-nav__link> for-in和迭代器 </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_7 class=md-nav__link> 适配器方法惯用法 </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_8 class=md-nav__link> 本章小结 </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_9 class=md-nav__link> 简单集合分类 </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content> <article class="md-content__inner md-typeset"> <a href=https://github.com/hqweay/my-mkdocs/edit/master/docs/book/OnJava8/docs/book/12-Collections.md title=编辑此页 class="md-icon md-content__icon">&#xE3C9;</a> <div class=toc> <ul> <li><a href=#_1>第十二章 集合</a><ul> <li><a href=#_2>泛型和类型安全的集合</a></li> <li><a href=#_3>基本概念</a></li> <li><a href=#_4>添加元素组</a></li> <li><a href=#_5>集合的打印</a></li> <li><a href=#list>列表List</a></li> <li><a href=#iterators>迭代器Iterators</a><ul> <li><a href=#listiterator>ListIterator</a></li> </ul> </li> <li><a href=#linkedlist>链表LinkedList</a></li> <li><a href=#stack>堆栈Stack</a></li> <li><a href=#set>集合Set</a></li> <li><a href=#map>映射Map</a></li> <li><a href=#queue>队列Queue</a><ul> <li><a href=#priorityqueue>优先级队列PriorityQueue</a></li> </ul> </li> <li><a href=#_6>集合与迭代器</a></li> <li><a href=#for-in>for-in和迭代器</a><ul> <li><a href=#_7>适配器方法惯用法</a></li> </ul> </li> <li><a href=#_8>本章小结</a><ul> <li><a href=#_9>简单集合分类</a></li> </ul> </li> </ul> </li> </ul> </div> <!-- Collections --> <h1 id=_1>第十二章 集合<a class=headerlink href=#_1 title="Permanent link">#</a></h1> <blockquote> <p>如果一个程序只包含固定数量的对象且对象的生命周期都是已知的，那么这是一个非常简单的程序。</p> </blockquote> <p>通常，程序总是根据运行时才知道的某些条件去创建新的对象。在此之前，无法知道所需对象的数量甚至确切类型。为了解决这个普遍的编程问题，需要在任意时刻和任意位置创建任意数量的对象。因此，不能依靠创建命名的引用来持有每一个对象： <div class=highlight><pre><span></span><code><span class=n>MyType</span> <span class=n>aReference</span><span class=p>;</span>
</code></pre></div> 因为从来不会知道实际需要多少个这样的引用。</p> <p>大多数编程语言都提供了某种方法来解决这个基本问题。Java有多种方式保存对象（确切地说，是对象的引用）。例如前边曾经学习过的数组，它是编译器支持的类型。数组是保存一组对象的最有效的方式，如果想要保存一组基本类型数据，也推荐使用数组。但是数组具有固定的大小尺寸，而且在更一般的情况下，在写程序的时候并不知道将需要多少个对象，或者是否需要更复杂的方式来存储对象，因此数组尺寸固定这一限制就显得太过受限了。</p> <p><strong>java.util</strong> 库提供了一套相当完整的<em>集合类</em>（collection classes）来解决这个问题，其中基本的类型有 <strong>List</strong> 、 <strong>Set</strong> 、 <strong>Queue</strong> 和 <strong>Map</strong>。这些类型也被称作<em>容器类</em>（container classes），但我将使用Java类库使用的术语。集合提供了完善的方法来保存对象，可以使用这些工具来解决大量的问题。</p> <p>集合还有一些其它特性。例如， <strong>Set</strong> 对于每个值都只保存一个对象， <strong>Map</strong> 是一个关联数组，允许将某些对象与其他对象关联起来。Java集合类都可以自动地调整自己的大小。因此，与数组不同，在编程时，可以将任意数量的对象放置在集合中，而不用关心集合应该有多大。</p> <p>尽管在 Java 中没有直接的关键字支持，<sup id=fnref:1><a class=footnote-ref href=#fn:1>1</a></sup>但集合类仍然是可以显著增强编程能力的基本工具。在本章中，将介绍 Java 集合类库的基本知识，并重点介绍一些典型用法。这里将专注于在日常编程中使用的集合。稍后，在<a href>附录：集合主题</a>中，还将学习到其余的那些集合和相关功能，以及如何使用它们的更多详细信息。</p> <!-- Generics and Type-Safe Collections --> <h2 id=_2>泛型和类型安全的集合<a class=headerlink href=#_2 title="Permanent link">#</a></h2> <p>使用 Java 5 之前的集合的一个主要问题是编译器允许你向集合中插入不正确的类型。例如，考虑一个 <strong>Apple</strong> 对象的集合，这里使用最基本最可靠的 <strong>ArrayList</strong> 。现在，可以把 <strong>ArrayList</strong> 看作“可以自动扩充自身尺寸的数组”来看待。使用 <strong>ArrayList</strong> 相当简单：创建一个实例，用 <code>add()</code> 插入对象；然后用 <code>get()</code> 来访问这些对象，此时需要使用索引，就像数组那样，但是不需要方括号。<sup id=fnref:2><a class=footnote-ref href=#fn:2>2</a></sup> <strong>ArrayList</strong> 还有一个 <code>size()</code> 方法，来说明集合中包含了多少个元素，所以不会不小心因数组越界而引发错误（通过抛出<em>运行时异常</em>，<a href>异常</a>章节介绍了异常）。</p> <p>在本例中， <strong>Apple</strong> 和 <strong>Orange</strong> 都被放到了集合中，然后将它们取出。正常情况下，Java编译器会给出警告，因为这个示例没有使用泛型。在这里，使用特定的注解来抑制警告信息。注解以“@”符号开头，可以带参数。这里的 <code>@SuppressWarning</code> 注解及其参数表示只抑制“unchecked”类型的警告（<a href>注解</a>章节将介绍更多有关注解的信息）：</p> <div class=highlight><pre><span></span><code><span class=c1>// collections/ApplesAndOrangesWithoutGenerics.java</span>
<span class=c1>// Simple collection use (suppressing compiler warnings)</span>
<span class=c1>// {ThrowsException}</span>
<span class=kn>import</span> <span class=nn>java.util.*</span><span class=p>;</span>

<span class=kd>class</span> <span class=nc>Apple</span> <span class=p>{</span>
  <span class=kd>private</span> <span class=kd>static</span> <span class=kt>long</span> <span class=n>counter</span><span class=p>;</span>
  <span class=kd>private</span> <span class=kd>final</span> <span class=kt>long</span> <span class=n>id</span> <span class=o>=</span> <span class=n>counter</span><span class=o>++</span><span class=p>;</span>
  <span class=kd>public</span> <span class=kt>long</span> <span class=nf>id</span><span class=p>()</span> <span class=p>{</span> <span class=k>return</span> <span class=n>id</span><span class=p>;</span> <span class=p>}</span>
<span class=p>}</span>

<span class=kd>class</span> <span class=nc>Orange</span> <span class=p>{}</span>

<span class=kd>public</span> <span class=kd>class</span> <span class=nc>ApplesAndOrangesWithoutGenerics</span> <span class=p>{</span>
  <span class=nd>@SuppressWarnings</span><span class=p>(</span><span class=s>&quot;unchecked&quot;</span><span class=p>)</span>
  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=p>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>ArrayList</span> <span class=n>apples</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ArrayList</span><span class=p>();</span>
    <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=mi>3</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span>
      <span class=n>apples</span><span class=p>.</span><span class=na>add</span><span class=p>(</span><span class=k>new</span> <span class=n>Apple</span><span class=p>());</span>
    <span class=c1>// No problem adding an Orange to apples:</span>
    <span class=n>apples</span><span class=p>.</span><span class=na>add</span><span class=p>(</span><span class=k>new</span> <span class=n>Orange</span><span class=p>());</span>
    <span class=k>for</span><span class=p>(</span><span class=n>Object</span> <span class=n>apple</span> <span class=p>:</span> <span class=n>apples</span><span class=p>)</span> <span class=p>{</span>
      <span class=p>((</span><span class=n>Apple</span><span class=p>)</span> <span class=n>apple</span><span class=p>).</span><span class=na>id</span><span class=p>();</span>
      <span class=c1>// Orange is detected only at run time</span>
    <span class=p>}</span>
  <span class=p>}</span>
<span class=p>}</span>
<span class=cm>/* Output:</span>
<span class=cm>___[ Error Output ]___</span>
<span class=cm>Exception in thread &quot;main&quot;</span>
<span class=cm>java.lang.ClassCastException: Orange cannot be cast to</span>
<span class=cm>Apple</span>
<span class=cm>        at ApplesAndOrangesWithoutGenerics.main(ApplesA</span>
<span class=cm>ndOrangesWithoutGenerics.java:23)</span>
<span class=cm>*/</span>
</code></pre></div> <p><strong>Apple</strong> 和 <strong>Orange</strong> 是截然不同的，它们除了都是 <strong>Object</strong> 之外没有任何共同点（如果一个类没有显式地声明继承自哪个类，那么它就自动继承自 <strong>Object</strong>）。因为 <strong>ArrayList</strong> 保存的是 <strong>Object</strong> ，所以不仅可以通过 <strong>ArrayList</strong> 的 <code>add()</code> 方法将 <strong>Apple</strong> 对象放入这个集合，而且可以放入 <strong>Orange</strong> 对象，这无论在编译期还是运行时都不会有问题。当使用 <strong>ArrayList</strong> 的 <code>get()</code> 方法来取出你认为是 <strong>Apple</strong> 的对象时，得到的只是 <strong>Object</strong> 引用，必须将其转型为 <strong>Apple</strong>。然后需要将整个表达式用括号括起来，以便在调用 <strong>Apple</strong> 的 <code>id()</code> 方法之前，强制执行转型。否则，将会产生语法错误。</p> <p>在运行时，当尝试将 <strong>Orange</strong> 对象转为 <strong>Apple</strong> 时，会出现输出中显示的错误。</p> <p>在<a href>泛型</a>章节中，你将了解到使用 Java 泛型来创建类可能很复杂。但是，使用预先定义的泛型类却相当简单。例如，要定义一个用于保存 <strong>Apple</strong> 对象的 <strong>ArrayList</strong> ，只需要使用 <strong>ArrayList\&lt;Apple></strong> 来代替 <strong>ArrayList</strong> 。尖括号括起来的是<em>类型参数</em>（可能会有多个），它指定了这个集合实例可以保存的类型。</p> <p>通过使用泛型，就可以在编译期防止将错误类型的对象放置到集合中。<sup id=fnref:3><a class=footnote-ref href=#fn:3>3</a></sup>下面还是这个示例，但是使用了泛型： <div class=highlight><pre><span></span><code><span class=c1>// collections/ApplesAndOrangesWithGenerics.java</span>
<span class=kn>import</span> <span class=nn>java.util.*</span><span class=p>;</span>

<span class=kd>public</span> <span class=kd>class</span> <span class=nc>ApplesAndOrangesWithGenerics</span> <span class=p>{</span>
  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=p>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>ArrayList</span><span class=o>&lt;</span><span class=n>Apple</span><span class=o>&gt;</span> <span class=n>apples</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ArrayList</span><span class=o>&lt;&gt;</span><span class=p>();</span>
    <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=mi>3</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span>
      <span class=n>apples</span><span class=p>.</span><span class=na>add</span><span class=p>(</span><span class=k>new</span> <span class=n>Apple</span><span class=p>());</span>
    <span class=c1>// Compile-time error:</span>
    <span class=c1>// apples.add(new Orange());</span>
    <span class=k>for</span><span class=p>(</span><span class=n>Apple</span> <span class=n>apple</span> <span class=p>:</span> <span class=n>apples</span><span class=p>)</span> <span class=p>{</span>
      <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>apple</span><span class=p>.</span><span class=na>id</span><span class=p>());</span>
    <span class=p>}</span>
  <span class=p>}</span>
<span class=p>}</span>
<span class=cm>/* Output:</span>
<span class=cm>0</span>
<span class=cm>1</span>
<span class=cm>2</span>
<span class=cm>*/</span>
</code></pre></div></p> <p>在 <strong>apples</strong> 定义的右侧，可以看到 <code>new ArrayList&lt;&gt;()</code> 。这有时被称为“菱形语法”（diamond syntax）。在 Java 7 之前，必须要在两端都进行类型声明，如下所示：</p> <div class=highlight><pre><span></span><code><span class=n>ArrayList</span><span class=o>&lt;</span><span class=n>Apple</span><span class=o>&gt;</span> <span class=n>apples</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ArrayList</span><span class=o>&lt;</span><span class=n>Apple</span><span class=o>&gt;</span><span class=p>();</span>
</code></pre></div> <p>随着类型变得越来越复杂，这种重复产生的代码非常混乱且难以阅读。程序员发现所有类型信息都可以从左侧获得，因此，编译器没有理由强迫右侧再重复这些。虽然<em>类型推断</em>（type inference）只是个很小的请求，Java 语言团队仍然欣然接受并进行了改进。</p> <p>有了 <strong>ArrayList</strong> 声明中的类型指定，编译器会阻止将 <strong>Orange</strong> 放入 <strong>apples</strong> ，因此，这会成为一个编译期错误而不是运行时错误。</p> <p>使用泛型，从 <strong>List</strong> 中获取元素不需要强制类型转换。因为 <strong>List</strong> 知道它持有什么类型，因此当调用 <code>get()</code> 时，它会替你执行转型。因此，使用泛型，你不仅知道编译器将检查放入集合的对象类型，而且在使用集合中的对象时也可以获得更清晰的语法。</p> <p>当指定了某个类型为泛型参数时，并不仅限于只能将确切类型的对象放入集合中。向上转型也可以像作用于其他类型一样作用于泛型： <div class=highlight><pre><span></span><code><span class=c1>// collections/GenericsAndUpcasting.java</span>
<span class=kn>import</span> <span class=nn>java.util.*</span><span class=p>;</span>

<span class=kd>class</span> <span class=nc>GrannySmith</span> <span class=kd>extends</span> <span class=n>Apple</span> <span class=p>{}</span>
<span class=kd>class</span> <span class=nc>Gala</span> <span class=kd>extends</span> <span class=n>Apple</span> <span class=p>{}</span>
<span class=kd>class</span> <span class=nc>Fuji</span> <span class=kd>extends</span> <span class=n>Apple</span> <span class=p>{}</span>
<span class=kd>class</span> <span class=nc>Braeburn</span> <span class=kd>extends</span> <span class=n>Apple</span> <span class=p>{}</span>

<span class=kd>public</span> <span class=kd>class</span> <span class=nc>GenericsAndUpcasting</span> <span class=p>{</span>
  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=p>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>ArrayList</span><span class=o>&lt;</span><span class=n>Apple</span><span class=o>&gt;</span> <span class=n>apples</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ArrayList</span><span class=o>&lt;&gt;</span><span class=p>();</span>
    <span class=n>apples</span><span class=p>.</span><span class=na>add</span><span class=p>(</span><span class=k>new</span> <span class=n>GrannySmith</span><span class=p>());</span>
    <span class=n>apples</span><span class=p>.</span><span class=na>add</span><span class=p>(</span><span class=k>new</span> <span class=n>Gala</span><span class=p>());</span>
    <span class=n>apples</span><span class=p>.</span><span class=na>add</span><span class=p>(</span><span class=k>new</span> <span class=n>Fuji</span><span class=p>());</span>
    <span class=n>apples</span><span class=p>.</span><span class=na>add</span><span class=p>(</span><span class=k>new</span> <span class=n>Braeburn</span><span class=p>());</span>
    <span class=k>for</span><span class=p>(</span><span class=n>Apple</span> <span class=n>apple</span> <span class=p>:</span> <span class=n>apples</span><span class=p>)</span>
      <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>apple</span><span class=p>);</span>
  <span class=p>}</span>
<span class=p>}</span>
<span class=cm>/* Output:</span>
<span class=cm>GrannySmith@15db9742</span>
<span class=cm>Gala@6d06d69c</span>
<span class=cm>Fuji@7852e922</span>
<span class=cm>Braeburn@4e25154f</span>
<span class=cm>*/</span>
</code></pre></div></p> <p>因此，可以将 <strong>Apple</strong> 的子类型添加到被指定为保存 <strong>Apple</strong> 对象的集合中。</p> <p>程序的输出是从 <strong>Object</strong> 默认的 <code>toString()</code> 方法产生的，该方法打印类名，后边跟着对象的散列码的无符号十六进制表示（这个散列码是通过 <code>hashCode()</code> 方法产生的）。将在<a href>附录：理解equals和hashCode方法</a>中了解有关散列码的内容。</p> <!-- Basic Concepts --> <h2 id=_3>基本概念<a class=headerlink href=#_3 title="Permanent link">#</a></h2> <p>Java集合类库采用“持有对象”（holding objects）的思想，并将其分为两个不同的概念，表示为类库的基本接口：</p> <ol> <li><strong>集合（Collection）</strong> ：一个独立元素的序列，这些元素都服从一条或多条规则。<strong>List</strong> 必须以插入的顺序保存元素， <strong>Set</strong> 不能包含重复元素， <strong>Queue</strong> 按照<em>排队规则</em>来确定对象产生的顺序（通常与它们被插入的顺序相同）。</li> <li><strong>映射（Map）</strong> ： 一组成对的“键值对”对象，允许使用键来查找值。 <strong>ArrayList</strong> 使用数字来查找对象，因此在某种意义上讲，它是将数字和对象关联在一起。 <strong>map</strong> 允许我们使用一个对象来查找另一个对象，它也被称作<em>关联数组</em>（associative array），因为它将对象和其它对象关联在一起；或者称作<em>字典</em>（dictionary），因为可以使用一个键对象来查找值对象，就像在字典中使用单词查找定义一样。 <strong>Map</strong> 是强大的编程工具。</li> </ol> <p>尽管并非总是可行，但在理想情况下，你编写的大部分代码都在与这些接口打交道，并且唯一需要指定所使用的精确类型的地方就是在创建的时候。因此，可以像下面这样创建一个 <strong>List</strong> ：</p> <div class=highlight><pre><span></span><code><span class=n>List</span><span class=o>&lt;</span><span class=n>Apple</span><span class=o>&gt;</span> <span class=n>apples</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ArrayList</span><span class=o>&lt;&gt;</span><span class=p>();</span>
</code></pre></div> <p>请注意， <strong>ArrayList</strong> 已经被向上转型为了 <strong>List</strong> ，这与之前示例中的处理方式正好相反。使用接口的目的是，如果想要改变具体实现，只需在创建时修改它就行了，就像下面这样：</p> <div class=highlight><pre><span></span><code><span class=n>List</span><span class=o>&lt;</span><span class=n>Apple</span><span class=o>&gt;</span> <span class=n>apples</span> <span class=o>=</span> <span class=k>new</span> <span class=n>LinkedList</span><span class=o>&lt;&gt;</span><span class=p>();</span>
</code></pre></div> <p>因此，应该创建一个具体类的对象，将其向上转型为对应的接口，然后在其余代码中都是用这个接口。</p> <p>这种方式并非总是有效的，因为某些具体类有额外的功能。例如， <strong>LinkedList</strong> 具有 <strong>List</strong> 接口中未包含的额外方法，而 <strong>TreeMap</strong> 也具有在 <strong>Map</strong> 接口中未包含的方法。如果需要使用这些方法，就不能将它们向上转型为更通用的接口。</p> <p><strong>Collection</strong> 接口概括了<em>序列</em>的概念——一种存放一组对象的方式。下面是个简单的示例，用 <strong>Integer</strong> 对象填充了一个 <strong>Collection</strong> （这里用 <strong>ArrayList</strong> 表示），然后打印集合中的每个元素： <div class=highlight><pre><span></span><code><span class=c1>// collections/SimpleCollection.java</span>
<span class=kn>import</span> <span class=nn>java.util.*</span><span class=p>;</span>

<span class=kd>public</span> <span class=kd>class</span> <span class=nc>SimpleCollection</span> <span class=p>{</span>
  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=p>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>Collection</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>&gt;</span> <span class=n>c</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ArrayList</span><span class=o>&lt;&gt;</span><span class=p>();</span>
    <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=mi>10</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span>
      <span class=n>c</span><span class=p>.</span><span class=na>add</span><span class=p>(</span><span class=n>i</span><span class=p>);</span> <span class=c1>// Autoboxing</span>
    <span class=k>for</span><span class=p>(</span><span class=n>Integer</span> <span class=n>i</span> <span class=p>:</span> <span class=n>c</span><span class=p>)</span>
      <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>print</span><span class=p>(</span><span class=n>i</span> <span class=o>+</span> <span class=s>&quot;, &quot;</span><span class=p>);</span>
  <span class=p>}</span>
<span class=p>}</span>
<span class=cm>/* Output:</span>
<span class=cm>0, 1, 2, 3, 4, 5, 6, 7, 8, 9,</span>
<span class=cm>*/</span>
</code></pre></div></p> <p>这个例子仅使用了 <strong>Collection</strong> 中的方法（即 <code>add()</code> ），所以使用任何继承自 <strong>Collection</strong> 的类的对象都可以正常工作。但是 <strong>ArrayList</strong> 是最基本的序列类型。</p> <p><code>add()</code> 方法的名称就表明它是在 <strong>Collection</strong> 中添加一个新元素。但是，文档中非常详细地叙述到 <code>add()</code> “要确保这个 <strong>Collection</strong> 包含指定的元素。”这是因为考虑到了 <strong>Set</strong> 的含义，因为在 <strong>Set</strong>中，只有当元素不存在时才会添加元素。在使用 <strong>ArrayList</strong> ，或任何其他类型的 <strong>List</strong> 时，<code>add()</code> 总是表示“把它放进去”，因为 <strong>List</strong> 不关心是否存在重复元素。</p> <p>可以使用 <em>for-in</em> 语法来遍历所有的 <strong>Collection</strong> ，就像这里所展示的那样。在本章的后续部分，还将学习到一个更灵活的概念，<em>迭代器</em>。</p> <!-- Adding Groups of Elements --> <h2 id=_4>添加元素组<a class=headerlink href=#_4 title="Permanent link">#</a></h2> <p>在 <strong>java.util</strong> 包中的 <strong>Arrays</strong> 和 <strong>Collections</strong> 类中都有很多实用的方法，可以在一个 <strong>Collection</strong> 中添加一组元素。</p> <p><code>Arrays.asList()</code> 方法接受一个数组或是逗号分隔的元素列表（使用可变参数），并将其转换为 <strong>List</strong> 对象。 <code>Collections.addAll()</code> 方法接受一个 <strong>Collection</strong> 对象，以及一个数组或是一个逗号分隔的列表，将其中元素添加到 <strong>Collection</strong> 中。下边的示例展示了这两个方法，以及更通用的 、所有 <strong>Collection</strong> 类型都包含的<code>addAll()</code> 方法：</p> <div class=highlight><pre><span></span><code><span class=c1>// collections/AddingGroups.java</span>
<span class=c1>// Adding groups of elements to Collection objects</span>
<span class=kn>import</span> <span class=nn>java.util.*</span><span class=p>;</span>

<span class=kd>public</span> <span class=kd>class</span> <span class=nc>AddingGroups</span> <span class=p>{</span>
  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=p>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>Collection</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>&gt;</span> <span class=n>collection</span> <span class=o>=</span>
      <span class=k>new</span> <span class=n>ArrayList</span><span class=o>&lt;&gt;</span><span class=p>(</span><span class=n>Arrays</span><span class=p>.</span><span class=na>asList</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>));</span>
    <span class=n>Integer</span><span class=o>[]</span> <span class=n>moreInts</span> <span class=o>=</span> <span class=p>{</span> <span class=mi>6</span><span class=p>,</span> <span class=mi>7</span><span class=p>,</span> <span class=mi>8</span><span class=p>,</span> <span class=mi>9</span><span class=p>,</span> <span class=mi>10</span> <span class=p>};</span>
    <span class=n>collection</span><span class=p>.</span><span class=na>addAll</span><span class=p>(</span><span class=n>Arrays</span><span class=p>.</span><span class=na>asList</span><span class=p>(</span><span class=n>moreInts</span><span class=p>));</span>
    <span class=c1>// Runs significantly faster, but you can&#39;t</span>
    <span class=c1>// construct a Collection this way:</span>
    <span class=n>Collections</span><span class=p>.</span><span class=na>addAll</span><span class=p>(</span><span class=n>collection</span><span class=p>,</span> <span class=mi>11</span><span class=p>,</span> <span class=mi>12</span><span class=p>,</span> <span class=mi>13</span><span class=p>,</span> <span class=mi>14</span><span class=p>,</span> <span class=mi>15</span><span class=p>);</span>
    <span class=n>Collections</span><span class=p>.</span><span class=na>addAll</span><span class=p>(</span><span class=n>collection</span><span class=p>,</span> <span class=n>moreInts</span><span class=p>);</span>
    <span class=c1>// Produces a list &quot;backed by&quot; an array:</span>
    <span class=n>List</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>&gt;</span> <span class=n>list</span> <span class=o>=</span> <span class=n>Arrays</span><span class=p>.</span><span class=na>asList</span><span class=p>(</span><span class=mi>16</span><span class=p>,</span><span class=mi>17</span><span class=p>,</span><span class=mi>18</span><span class=p>,</span><span class=mi>19</span><span class=p>,</span><span class=mi>20</span><span class=p>);</span>
    <span class=n>list</span><span class=p>.</span><span class=na>set</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>99</span><span class=p>);</span> <span class=c1>// OK -- modify an element</span>
    <span class=c1>// list.add(21); // Runtime error; the underlying</span>
                     <span class=c1>// array cannot be resized.</span>
  <span class=p>}</span>
<span class=p>}</span>
</code></pre></div> <p><strong>Collection</strong> 的构造器可以接受另一个 <strong>Collection</strong>，用它来将自身初始化。因此，可以使用 <code>Arrays.asList()</code> 来为这个构造器产生输入。但是， <code>Collections.addAll()</code> 运行得更快，而且很容易构建一个不包含元素的 <strong>Collection</strong> ，然后调用 <code>Collections.addAll()</code> ，因此这是首选方式。</p> <p><code>Collection.addAll()</code> 方法只能接受另一个 <strong>Collection</strong> 作为参数，因此它没有 <code>Arrays.asList()</code> 或 <code>Collections.addAll()</code> 灵活。这两个方法都使用可变参数列表。</p> <p>也可以直接使用 <code>Arrays.asList()</code> 的输出作为一个 <strong>List</strong> ，但是这里的底层实现是数组，没法调整大小。如果尝试在这个 <strong>List</strong> 上调用 <code>add()</code> 或 <code>remove()</code>，由于这两个方法会尝试修改数组大小，所以会在运行时得到“Unsupported Operation（不支持的操作）”错误：</p> <div class=highlight><pre><span></span><code><span class=c1>// collections/AsListInference.java</span>
<span class=kn>import</span> <span class=nn>java.util.*</span><span class=p>;</span>

<span class=kd>class</span> <span class=nc>Snow</span> <span class=p>{}</span>
<span class=kd>class</span> <span class=nc>Powder</span> <span class=kd>extends</span> <span class=n>Snow</span> <span class=p>{}</span>
<span class=kd>class</span> <span class=nc>Light</span> <span class=kd>extends</span> <span class=n>Powder</span> <span class=p>{}</span>
<span class=kd>class</span> <span class=nc>Heavy</span> <span class=kd>extends</span> <span class=n>Powder</span> <span class=p>{}</span>
<span class=kd>class</span> <span class=nc>Crusty</span> <span class=kd>extends</span> <span class=n>Snow</span> <span class=p>{}</span>
<span class=kd>class</span> <span class=nc>Slush</span> <span class=kd>extends</span> <span class=n>Snow</span> <span class=p>{}</span>

<span class=kd>public</span> <span class=kd>class</span> <span class=nc>AsListInference</span> <span class=p>{</span>
  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=p>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>List</span><span class=o>&lt;</span><span class=n>Snow</span><span class=o>&gt;</span> <span class=n>snow1</span> <span class=o>=</span> <span class=n>Arrays</span><span class=p>.</span><span class=na>asList</span><span class=p>(</span>
      <span class=k>new</span> <span class=n>Crusty</span><span class=p>(),</span> <span class=k>new</span> <span class=n>Slush</span><span class=p>(),</span> <span class=k>new</span> <span class=n>Powder</span><span class=p>());</span>
    <span class=c1>//- snow1.add(new Heavy()); // Exception</span>

    <span class=n>List</span><span class=o>&lt;</span><span class=n>Snow</span><span class=o>&gt;</span> <span class=n>snow2</span> <span class=o>=</span> <span class=n>Arrays</span><span class=p>.</span><span class=na>asList</span><span class=p>(</span>
      <span class=k>new</span> <span class=n>Light</span><span class=p>(),</span> <span class=k>new</span> <span class=n>Heavy</span><span class=p>());</span>
    <span class=c1>//- snow2.add(new Slush()); // Exception</span>

    <span class=n>List</span><span class=o>&lt;</span><span class=n>Snow</span><span class=o>&gt;</span> <span class=n>snow3</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ArrayList</span><span class=o>&lt;&gt;</span><span class=p>();</span>
    <span class=n>Collections</span><span class=p>.</span><span class=na>addAll</span><span class=p>(</span><span class=n>snow3</span><span class=p>,</span>
      <span class=k>new</span> <span class=n>Light</span><span class=p>(),</span> <span class=k>new</span> <span class=n>Heavy</span><span class=p>(),</span> <span class=k>new</span> <span class=n>Powder</span><span class=p>());</span>
    <span class=n>snow3</span><span class=p>.</span><span class=na>add</span><span class=p>(</span><span class=k>new</span> <span class=n>Crusty</span><span class=p>());</span>

    <span class=c1>// Hint with explicit type argument specification:</span>
    <span class=n>List</span><span class=o>&lt;</span><span class=n>Snow</span><span class=o>&gt;</span> <span class=n>snow4</span> <span class=o>=</span> <span class=n>Arrays</span><span class=p>.</span><span class=o>&lt;</span><span class=n>Snow</span><span class=o>&gt;</span><span class=n>asList</span><span class=p>(</span>
       <span class=k>new</span> <span class=n>Light</span><span class=p>(),</span> <span class=k>new</span> <span class=n>Heavy</span><span class=p>(),</span> <span class=k>new</span> <span class=n>Slush</span><span class=p>());</span>
    <span class=c1>//- snow4.add(new Powder()); // Exception</span>
  <span class=p>}</span>
<span class=p>}</span>
</code></pre></div> <p>在 <strong>snow4</strong> 中，注意 <code>Arrays.asList()</code> 中间的“暗示”（即 <code>&lt;Snow&gt;</code> ），告诉编译器 <code>Arrays.asList()</code> 生成的结果 <strong>List</strong> 类型的实际目标类型是什么。这称为<em>显式类型参数说明</em>（explicit type argument specification）。</p> <!-- Printing Collections --> <h2 id=_5>集合的打印<a class=headerlink href=#_5 title="Permanent link">#</a></h2> <p>必须使用 <code>Arrays.toString()</code> 来生成数组的可打印形式。但是打印集合无需任何帮助。下面是一个例子，这个例子中也介绍了基本的Java集合： <div class=highlight><pre><span></span><code><span class=c1>// collections/PrintingCollections.java</span>
<span class=c1>// Collections print themselves automatically</span>
<span class=kn>import</span> <span class=nn>java.util.*</span><span class=p>;</span>

<span class=kd>public</span> <span class=kd>class</span> <span class=nc>PrintingCollections</span> <span class=p>{</span>
  <span class=kd>static</span> <span class=n>Collection</span>
  <span class=nf>fill</span><span class=p>(</span><span class=n>Collection</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;</span> <span class=n>collection</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>collection</span><span class=p>.</span><span class=na>add</span><span class=p>(</span><span class=s>&quot;rat&quot;</span><span class=p>);</span>
    <span class=n>collection</span><span class=p>.</span><span class=na>add</span><span class=p>(</span><span class=s>&quot;cat&quot;</span><span class=p>);</span>
    <span class=n>collection</span><span class=p>.</span><span class=na>add</span><span class=p>(</span><span class=s>&quot;dog&quot;</span><span class=p>);</span>
    <span class=n>collection</span><span class=p>.</span><span class=na>add</span><span class=p>(</span><span class=s>&quot;dog&quot;</span><span class=p>);</span>
    <span class=k>return</span> <span class=n>collection</span><span class=p>;</span>
  <span class=p>}</span>
  <span class=kd>static</span> <span class=n>Map</span> <span class=nf>fill</span><span class=p>(</span><span class=n>Map</span><span class=o>&lt;</span><span class=n>String</span><span class=p>,</span> <span class=n>String</span><span class=o>&gt;</span> <span class=n>map</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>map</span><span class=p>.</span><span class=na>put</span><span class=p>(</span><span class=s>&quot;rat&quot;</span><span class=p>,</span> <span class=s>&quot;Fuzzy&quot;</span><span class=p>);</span>
    <span class=n>map</span><span class=p>.</span><span class=na>put</span><span class=p>(</span><span class=s>&quot;cat&quot;</span><span class=p>,</span> <span class=s>&quot;Rags&quot;</span><span class=p>);</span>
    <span class=n>map</span><span class=p>.</span><span class=na>put</span><span class=p>(</span><span class=s>&quot;dog&quot;</span><span class=p>,</span> <span class=s>&quot;Bosco&quot;</span><span class=p>);</span>
    <span class=n>map</span><span class=p>.</span><span class=na>put</span><span class=p>(</span><span class=s>&quot;dog&quot;</span><span class=p>,</span> <span class=s>&quot;Spot&quot;</span><span class=p>);</span>
    <span class=k>return</span> <span class=n>map</span><span class=p>;</span>
  <span class=p>}</span>
  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=p>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>fill</span><span class=p>(</span><span class=k>new</span> <span class=n>ArrayList</span><span class=o>&lt;&gt;</span><span class=p>()));</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>fill</span><span class=p>(</span><span class=k>new</span> <span class=n>LinkedList</span><span class=o>&lt;&gt;</span><span class=p>()));</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>fill</span><span class=p>(</span><span class=k>new</span> <span class=n>HashSet</span><span class=o>&lt;&gt;</span><span class=p>()));</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>fill</span><span class=p>(</span><span class=k>new</span> <span class=n>TreeSet</span><span class=o>&lt;&gt;</span><span class=p>()));</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>fill</span><span class=p>(</span><span class=k>new</span> <span class=n>LinkedHashSet</span><span class=o>&lt;&gt;</span><span class=p>()));</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>fill</span><span class=p>(</span><span class=k>new</span> <span class=n>HashMap</span><span class=o>&lt;&gt;</span><span class=p>()));</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>fill</span><span class=p>(</span><span class=k>new</span> <span class=n>TreeMap</span><span class=o>&lt;&gt;</span><span class=p>()));</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>fill</span><span class=p>(</span><span class=k>new</span> <span class=n>LinkedHashMap</span><span class=o>&lt;&gt;</span><span class=p>()));</span>
  <span class=p>}</span>
<span class=p>}</span>
<span class=cm>/* Output:</span>
<span class=cm>[rat, cat, dog, dog]</span>
<span class=cm>[rat, cat, dog, dog]</span>
<span class=cm>[rat, cat, dog]</span>
<span class=cm>[cat, dog, rat]</span>
<span class=cm>[rat, cat, dog]</span>
<span class=cm>{rat=Fuzzy, cat=Rags, dog=Spot}</span>
<span class=cm>{cat=Rags, dog=Spot, rat=Fuzzy}</span>
<span class=cm>{rat=Fuzzy, cat=Rags, dog=Spot}</span>
<span class=cm>*/</span>
</code></pre></div></p> <p>这显示了Java集合库中的两个主要类型。它们的区别在于集合中的每个“槽”（slot）保存的元素个数。 <strong>Collection</strong> 类型在每个槽中只能保存一个元素。此类集合包括： <strong>List</strong> ，它以特定的顺序保存一组元素； <strong>Set</strong> ，其中元素不允许重复； <strong>Queue</strong> ，只能在集合一端插入对象，并从另一端移除对象（就本例而言，这只是查看序列的另一种方式，因此并没有显示它）。 <strong>Map</strong> 在每个槽中存放了两个元素，即<em>键</em>和与之关联的<em>值</em>。</p> <p>默认的打印行为，使用集合提供的 <code>toString()</code> 方法即可生成可读性很好的结果。 <strong>Collection</strong> 打印出的内容用方括号括住，每个元素由逗号分隔。 <strong>Map</strong> 则由大括号括住，每个键和值用等号连接（键在左侧，值在右侧）。</p> <p>第一个 <code>fill()</code> 方法适用于所有类型的 <strong>Collection</strong> ，这些类型都实现了 <code>add()</code> 方法以添加新元素。</p> <p><strong>ArrayList</strong> 和 <strong>LinkedList</strong> 都是 <strong>List</strong> 的类型，从输出中可以看出，它们都按插入顺序保存元素。两者之间的区别不仅在于执行某些类型的操作时的性能，而且 <strong>LinkedList</strong> 包含的操作多于 <strong>ArrayList</strong> 。本章后面将对这些内容进行更全面的探讨。</p> <p><strong>HashSet</strong> ， <strong>TreeSet</strong> 和 <strong>LinkedHashSet</strong> 是 <strong>Set</strong> 的类型。从输出中可以看到， <strong>Set</strong> 仅保存每个相同项中的一个，并且不同的 <strong>Set</strong> 实现存储元素的方式也不同。 <strong>HashSet</strong> 使用相当复杂的方法存储元素，这在<a href>附录：集合主题</a>中进行了探讨。现在只需要知道，这种技术是检索元素的最快方法，因此，存储顺序看上去没有什么意义（通常只关心某事物是否是 <strong>Set</strong> 的成员，而存储顺序并不重要）。如果存储顺序很重要，则可以使用 <strong>TreeSet</strong> ，它将按比较结果的升序保存对象）或 <strong>LinkedHashSet</strong> ，它按照被添加的先后顺序保存对象。</p> <p><strong>Map</strong> （也称为<em>关联数组</em>）使用<em>键</em>来查找对象，就像一个简单的数据库。所关联的对象称为<em>值</em>。 假设有一个 <strong>Map</strong> 将美国州名与它们的首府联系在一起，如果想要俄亥俄州（Ohio）的首府，可以用“Ohio”作为键来查找，几乎就像使用数组下标一样。正是由于这种行为，对于每个键， <strong>Map</strong> 只存储一次。</p> <p><code>Map.put(key, value)</code> 添加一个所想要添加的值并将它与一个键（用来查找值）相关联。 <code>Map.get(key)</code> 生成与该键相关联的值。上面的示例仅添加键值对，并没有执行查找。这将在稍后展示。</p> <p>请注意，这里没有指定（或考虑） <strong>Map</strong> 的大小，因为它会自动调整大小。 此外， <strong>Map</strong> 还知道如何打印自己，它会显示相关联的键和值。</p> <p>本例使用了 <strong>Map</strong> 的三种基本风格： <strong>HashMap</strong> ， <strong>TreeMap</strong> 和 <strong>LinkedHashMap</strong> 。</p> <p>键和值保存在 <strong>HashMap</strong> 中的顺序不是插入顺序，因为 <strong>HashMap</strong> 实现使用了非常快速的算法来控制顺序。 <strong>TreeMap</strong> 通过比较结果的升序来保存键， <strong>LinkedHashMap</strong> 在保持 <strong>HashMap</strong> 查找速度的同时按键的插入顺序保存键。</p> <!-- List --> <h2 id=list>列表List<a class=headerlink href=#list title="Permanent link">#</a></h2> <p><strong>List</strong>承诺将元素保存在特定的序列中。 <strong>List</strong> 接口在 <strong>Collection</strong> 的基础上添加了许多方法，允许在 <strong>List</strong> 的中间插入和删除元素。</p> <p>有两种类型的 <strong>List</strong> ：</p> <ul> <li>基本的 <strong>ArrayList</strong> ，擅长随机访问元素，但在 <strong>List</strong> 中间插入和删除元素时速度较慢。</li> <li><strong>LinkedList</strong> ，它通过代价较低的在 <strong>List</strong> 中间进行的插入和删除操作，提供了优化的顺序访问。 <strong>LinkedList</strong> 对于随机访问来说相对较慢，但它具有比 <strong>ArrayList</strong> 更大的特征集。</li> </ul> <p>下面的示例导入 <strong>typeinfo.pets</strong> ，超前使用了<a href>类型信息</a>一章中的类库。这个类库包含了 <strong>Pet</strong> 类层次结构，以及用于随机生成 <strong>Pet</strong> 对象的一些工具类。此时不需要了解完整的详细信息，只需要知道两点：</p> <ol> <li>有一个 <strong>Pet</strong> 类，以及 <strong>Pet</strong> 的各种子类型。</li> <li>静态的 <code>Pets.arrayList()</code> 方法返回一个填充了随机选取的 <strong>Pet</strong> 对象的 <strong>ArrayList</strong>：</li> </ol> <div class=highlight><pre><span></span><code><span class=c1>// collections/ListFeatures.java</span>
<span class=kn>import</span> <span class=nn>typeinfo.pets.*</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>java.util.*</span><span class=p>;</span>

<span class=kd>public</span> <span class=kd>class</span> <span class=nc>ListFeatures</span> <span class=p>{</span>
  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=p>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>Random</span> <span class=n>rand</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Random</span><span class=p>(</span><span class=mi>47</span><span class=p>);</span>
    <span class=n>List</span><span class=o>&lt;</span><span class=n>Pet</span><span class=o>&gt;</span> <span class=n>pets</span> <span class=o>=</span> <span class=n>Pets</span><span class=p>.</span><span class=na>list</span><span class=p>(</span><span class=mi>7</span><span class=p>);</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&quot;1: &quot;</span> <span class=o>+</span> <span class=n>pets</span><span class=p>);</span>
    <span class=n>Hamster</span> <span class=n>h</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Hamster</span><span class=p>();</span>
    <span class=n>pets</span><span class=p>.</span><span class=na>add</span><span class=p>(</span><span class=n>h</span><span class=p>);</span> <span class=c1>// Automatically resizes</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&quot;2: &quot;</span> <span class=o>+</span> <span class=n>pets</span><span class=p>);</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&quot;3: &quot;</span> <span class=o>+</span> <span class=n>pets</span><span class=p>.</span><span class=na>contains</span><span class=p>(</span><span class=n>h</span><span class=p>));</span>
    <span class=n>pets</span><span class=p>.</span><span class=na>remove</span><span class=p>(</span><span class=n>h</span><span class=p>);</span> <span class=c1>// Remove by object</span>
    <span class=n>Pet</span> <span class=n>p</span> <span class=o>=</span> <span class=n>pets</span><span class=p>.</span><span class=na>get</span><span class=p>(</span><span class=mi>2</span><span class=p>);</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span>
      <span class=s>&quot;4: &quot;</span> <span class=o>+</span>  <span class=n>p</span> <span class=o>+</span> <span class=s>&quot; &quot;</span> <span class=o>+</span> <span class=n>pets</span><span class=p>.</span><span class=na>indexOf</span><span class=p>(</span><span class=n>p</span><span class=p>));</span>
    <span class=n>Pet</span> <span class=n>cymric</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Cymric</span><span class=p>();</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&quot;5: &quot;</span> <span class=o>+</span> <span class=n>pets</span><span class=p>.</span><span class=na>indexOf</span><span class=p>(</span><span class=n>cymric</span><span class=p>));</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&quot;6: &quot;</span> <span class=o>+</span> <span class=n>pets</span><span class=p>.</span><span class=na>remove</span><span class=p>(</span><span class=n>cymric</span><span class=p>));</span>
    <span class=c1>// Must be the exact object:</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&quot;7: &quot;</span> <span class=o>+</span> <span class=n>pets</span><span class=p>.</span><span class=na>remove</span><span class=p>(</span><span class=n>p</span><span class=p>));</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&quot;8: &quot;</span> <span class=o>+</span> <span class=n>pets</span><span class=p>);</span>
    <span class=n>pets</span><span class=p>.</span><span class=na>add</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span> <span class=k>new</span> <span class=n>Mouse</span><span class=p>());</span> <span class=c1>// Insert at an index</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&quot;9: &quot;</span> <span class=o>+</span> <span class=n>pets</span><span class=p>);</span>
    <span class=n>List</span><span class=o>&lt;</span><span class=n>Pet</span><span class=o>&gt;</span> <span class=n>sub</span> <span class=o>=</span> <span class=n>pets</span><span class=p>.</span><span class=na>subList</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>4</span><span class=p>);</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&quot;subList: &quot;</span> <span class=o>+</span> <span class=n>sub</span><span class=p>);</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&quot;10: &quot;</span> <span class=o>+</span> <span class=n>pets</span><span class=p>.</span><span class=na>containsAll</span><span class=p>(</span><span class=n>sub</span><span class=p>));</span>
    <span class=n>Collections</span><span class=p>.</span><span class=na>sort</span><span class=p>(</span><span class=n>sub</span><span class=p>);</span> <span class=c1>// In-place sort</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&quot;sorted subList: &quot;</span> <span class=o>+</span> <span class=n>sub</span><span class=p>);</span>
    <span class=c1>// Order is not important in containsAll():</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&quot;11: &quot;</span> <span class=o>+</span> <span class=n>pets</span><span class=p>.</span><span class=na>containsAll</span><span class=p>(</span><span class=n>sub</span><span class=p>));</span>
    <span class=n>Collections</span><span class=p>.</span><span class=na>shuffle</span><span class=p>(</span><span class=n>sub</span><span class=p>,</span> <span class=n>rand</span><span class=p>);</span> <span class=c1>// Mix it up</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&quot;shuffled subList: &quot;</span> <span class=o>+</span> <span class=n>sub</span><span class=p>);</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&quot;12: &quot;</span> <span class=o>+</span> <span class=n>pets</span><span class=p>.</span><span class=na>containsAll</span><span class=p>(</span><span class=n>sub</span><span class=p>));</span>
    <span class=n>List</span><span class=o>&lt;</span><span class=n>Pet</span><span class=o>&gt;</span> <span class=n>copy</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ArrayList</span><span class=o>&lt;&gt;</span><span class=p>(</span><span class=n>pets</span><span class=p>);</span>
    <span class=n>sub</span> <span class=o>=</span> <span class=n>Arrays</span><span class=p>.</span><span class=na>asList</span><span class=p>(</span><span class=n>pets</span><span class=p>.</span><span class=na>get</span><span class=p>(</span><span class=mi>1</span><span class=p>),</span> <span class=n>pets</span><span class=p>.</span><span class=na>get</span><span class=p>(</span><span class=mi>4</span><span class=p>));</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&quot;sub: &quot;</span> <span class=o>+</span> <span class=n>sub</span><span class=p>);</span>
    <span class=n>copy</span><span class=p>.</span><span class=na>retainAll</span><span class=p>(</span><span class=n>sub</span><span class=p>);</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&quot;13: &quot;</span> <span class=o>+</span> <span class=n>copy</span><span class=p>);</span>
    <span class=n>copy</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ArrayList</span><span class=o>&lt;&gt;</span><span class=p>(</span><span class=n>pets</span><span class=p>);</span> <span class=c1>// Get a fresh copy</span>
    <span class=n>copy</span><span class=p>.</span><span class=na>remove</span><span class=p>(</span><span class=mi>2</span><span class=p>);</span> <span class=c1>// Remove by index</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&quot;14: &quot;</span> <span class=o>+</span> <span class=n>copy</span><span class=p>);</span>
    <span class=n>copy</span><span class=p>.</span><span class=na>removeAll</span><span class=p>(</span><span class=n>sub</span><span class=p>);</span> <span class=c1>// Only removes exact objects</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&quot;15: &quot;</span> <span class=o>+</span> <span class=n>copy</span><span class=p>);</span>
    <span class=n>copy</span><span class=p>.</span><span class=na>set</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=k>new</span> <span class=n>Mouse</span><span class=p>());</span> <span class=c1>// Replace an element</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&quot;16: &quot;</span> <span class=o>+</span> <span class=n>copy</span><span class=p>);</span>
    <span class=n>copy</span><span class=p>.</span><span class=na>addAll</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=n>sub</span><span class=p>);</span> <span class=c1>// Insert a list in the middle</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&quot;17: &quot;</span> <span class=o>+</span> <span class=n>copy</span><span class=p>);</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&quot;18: &quot;</span> <span class=o>+</span> <span class=n>pets</span><span class=p>.</span><span class=na>isEmpty</span><span class=p>());</span>
    <span class=n>pets</span><span class=p>.</span><span class=na>clear</span><span class=p>();</span> <span class=c1>// Remove all elements</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&quot;19: &quot;</span> <span class=o>+</span> <span class=n>pets</span><span class=p>);</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&quot;20: &quot;</span> <span class=o>+</span> <span class=n>pets</span><span class=p>.</span><span class=na>isEmpty</span><span class=p>());</span>
    <span class=n>pets</span><span class=p>.</span><span class=na>addAll</span><span class=p>(</span><span class=n>Pets</span><span class=p>.</span><span class=na>list</span><span class=p>(</span><span class=mi>4</span><span class=p>));</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&quot;21: &quot;</span> <span class=o>+</span> <span class=n>pets</span><span class=p>);</span>
    <span class=n>Object</span><span class=o>[]</span> <span class=n>o</span> <span class=o>=</span> <span class=n>pets</span><span class=p>.</span><span class=na>toArray</span><span class=p>();</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&quot;22: &quot;</span> <span class=o>+</span> <span class=n>o</span><span class=o>[</span><span class=mi>3</span><span class=o>]</span><span class=p>);</span>
    <span class=n>Pet</span><span class=o>[]</span> <span class=n>pa</span> <span class=o>=</span> <span class=n>pets</span><span class=p>.</span><span class=na>toArray</span><span class=p>(</span><span class=k>new</span> <span class=n>Pet</span><span class=o>[</span><span class=mi>0</span><span class=o>]</span><span class=p>);</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&quot;23: &quot;</span> <span class=o>+</span> <span class=n>pa</span><span class=o>[</span><span class=mi>3</span><span class=o>]</span><span class=p>.</span><span class=na>id</span><span class=p>());</span>
  <span class=p>}</span>
<span class=p>}</span>
<span class=cm>/* Output:</span>
<span class=cm>1: [Rat, Manx, Cymric, Mutt, Pug, Cymric, Pug]</span>
<span class=cm>2: [Rat, Manx, Cymric, Mutt, Pug, Cymric, Pug, Hamster]</span>
<span class=cm>3: true</span>
<span class=cm>4: Cymric 2</span>
<span class=cm>5: -1</span>
<span class=cm>6: false</span>
<span class=cm>7: true</span>
<span class=cm>8: [Rat, Manx, Mutt, Pug, Cymric, Pug]</span>
<span class=cm>9: [Rat, Manx, Mutt, Mouse, Pug, Cymric, Pug]</span>
<span class=cm>subList: [Manx, Mutt, Mouse]</span>
<span class=cm>10: true</span>
<span class=cm>sorted subList: [Manx, Mouse, Mutt]</span>
<span class=cm>11: true</span>
<span class=cm>shuffled subList: [Mouse, Manx, Mutt]</span>
<span class=cm>12: true</span>
<span class=cm>sub: [Mouse, Pug]</span>
<span class=cm>13: [Mouse, Pug]</span>
<span class=cm>14: [Rat, Mouse, Mutt, Pug, Cymric, Pug]</span>
<span class=cm>15: [Rat, Mutt, Cymric, Pug]</span>
<span class=cm>16: [Rat, Mouse, Cymric, Pug]</span>
<span class=cm>17: [Rat, Mouse, Mouse, Pug, Cymric, Pug]</span>
<span class=cm>18: false</span>
<span class=cm>19: []</span>
<span class=cm>20: true</span>
<span class=cm>21: [Manx, Cymric, Rat, EgyptianMau]</span>
<span class=cm>22: EgyptianMau</span>
<span class=cm>23: 14</span>
<span class=cm>*/</span>
</code></pre></div> <p>打印行都编了号，因此可从输出追溯到源代码。 第 1 行输出展示了原始的由 <strong>Pet</strong> 组成的 <strong>List</strong> 。 与数组不同， <strong>List</strong> 可以在创建后添加或删除元素，并自行调整大小。这正是它的重要价值：一种可修改的序列。在第 2 行输出中可以看到添加一个 <strong>Hamster</strong> 的结果，该对象将被追加到列表的末尾。</p> <p>可以使用 <code>contains()</code> 方法确定对象是否在列表中。如果要删除一个对象，可以将该对象的引用传递给 <code>remove()</code> 方法。同样，如果有一个对象的引用，可以使用 <code>indexOf()</code> 在 <strong>List</strong> 中找到该对象所在位置的下标号，如第 4 行输出所示中所示。</p> <p>当确定元素是否是属于某个 <strong>List</strong> ，寻找某个元素的索引，以及通过引用从 <strong>List</strong> 中删除元素时，都会用到 <code>equals()</code> 方法（根类 <strong>Object</strong> 的一个方法）。每个 <strong>Pet</strong> 被定义为一个唯一的对象，所以即使列表中已经有两个 <strong>Cymrics</strong> ，如果再创建一个新的 <strong>Cymric</strong> 对象并将其传递给 <code>indexOf()</code> 方法，结果仍为 <strong>-1</strong> （表示未找到），并且尝试调用 <code>remove()</code> 方法来删除这个对象将返回 <strong>false</strong> 。对于其他类， <code>equals()</code> 的定义可能有所不同。例如，如果两个 <strong>String</strong> 的内容相同，则这两个 <strong>String</strong> 相等。因此，为了防止出现意外，请务必注意 <strong>List</strong> 行为会根据 <code>equals()</code> 行为而发生变化。</p> <p>第 7、8 行输出展示了删除与 <strong>List</strong> 中的对象完全匹配的对象是成功的。</p> <p>可以在 <strong>List</strong> 的中间插入一个元素，就像在第 9 行输出和它之前的代码那样。但这会带来一个问题：对于 <strong>LinkedList</strong> ，在列表中间插入和删除都是廉价操作（在本例中，除了对列表中间进行的真正的随机访问），但对于 <strong>ArrayList</strong> ，这可是代价高昂的操作。这是否意味着永远不应该在 <strong>ArrayList</strong> 的中间插入元素，并最好是转换为 <strong>LinkedList</strong> ？不，它只是意味着你应该意识到这个问题，如果你开始在某个 <strong>ArrayList</strong> 中间执行很多插入操作，并且程序开始变慢，那么你应该看看你的 <strong>List</strong> 实现有可能就是罪魁祸首（发现此类瓶颈的最佳方式是使用分析器 profiler）。优化是一个很棘手的问题，最好的策略就是置之不顾，直到发现必须要去担心它了（尽管去理解这些问题总是一个很好的主意）。</p> <p><code>subList()</code> 方法可以轻松地从更大的列表中创建切片，当将切片结果传递给原来这个较大的列表的 <code>containsAll()</code> 方法时，很自然地会得到 <strong>true</strong>。请注意，顺序并不重要，在第 11、12 行输出中可以看到，在 <strong>sub</strong> 上调用直观命名的 <code>Collections.sort()</code> 和 <code>Collections.shuffle()</code> 方法，不会影响 <code>containsAll()</code> 的结果。 <code>subList()</code> 所产生的列表的幕后支持就是原始列表。因此，对所返回列表的更改都将会反映在原始列表中，反之亦然。</p> <p><code>retainAll()</code> 方法实际上是一个“集合交集”操作，在本例中，它保留了同时在 <strong>copy</strong> 和 <strong>sub</strong> 中的所有元素。请再次注意，所产生的结果行为依赖于 <code>equals()</code> 方法。</p> <p>第 14 行输出展示了使用索引号来删除元素的结果，与通过对象引用来删除元素相比，它显得更加直观，因为在使用索引时，不必担心 <code>equals()</code> 的行为。</p> <p><code>removeAll()</code> 方法也是基于 <code>equals()</code> 方法运行的。 顾名思义，它会从 <strong>List</strong> 中删除在参数 <strong>List</strong> 中的所有元素。</p> <p><code>set()</code> 方法的命名显得很不合时宜，因为它与 <strong>Set</strong> 类存在潜在的冲突。在这里使用“replace”可能更适合，因为它的功能是用第二个参数替换索引处的元素（第一个参数）。</p> <p>第 17 行输出表明，对于 <strong>List</strong> ，有一个重载的 <code>addAll()</code> 方法可以将新列表插入到原始列表的中间位置，而不是仅能用 <strong>Collection</strong> 的 <code>addAll()</code> 方法将其追加到列表的末尾。</p> <p>第 18 - 20 行输出展示了 <code>isEmpty()</code> 和 <code>clear()</code> 方法的效果。</p> <p>第 22、23 行输出展示了如何使用 <code>toArray()</code> 方法将任意的 <strong>Collection</strong> 转换为数组。这是一个重载方法，其无参版本返回一个 <strong>Object</strong> 数组，但是如果将目标类型的数组传递给这个重载版本，那么它会生成一个指定类型的数组（假设它通过了类型检查）。如果参数数组太小而无法容纳 <strong>List</strong> 中的所有元素（就像本例一样），则 <code>toArray()</code> 会创建一个具有合适尺寸的新数组。 <strong>Pet</strong> 对象有一个 <code>id()</code> 方法，可以在所产生的数组中的对象上调用这个方法。</p> <!-- Iterators --> <h2 id=iterators>迭代器Iterators<a class=headerlink href=#iterators title="Permanent link">#</a></h2> <p>在任何集合中，都必须有某种方式可以插入元素并再次获取它们。毕竟，保存事物是集合最基本的工作。对于 <strong>List</strong> ， <code>add()</code> 是插入元素的一种方式， <code>get()</code> 是获取元素的一种方式。</p> <p>如果从更高层次的角度考虑，会发现这里有个缺点：要使用集合，必须对集合的确切类型编程。这一开始可能看起来不是很糟糕，但是考虑下面的情况：如果原本是对 <strong>List</strong> 编码的，但是后来发现如果能够将相同的代码应用于 <strong>Set</strong> 会更方便，此时应该怎么做？或者假设想从一开始就编写一段通用代码，它不知道或不关心它正在使用什么类型的集合，因此它可以用于不同类型的集合，那么如何才能不重写代码就可以应用于不同类型的集合？</p> <p><em>迭代器</em>（也是一种设计模式）的概念实现了这种抽象。迭代器是一个对象，它在一个序列中移动并选择该序列中的每个对象，而客户端程序员不知道或不关心该序列的底层结构。另外，迭代器通常被称为<em>轻量级对象</em>（lightweight object）：创建它的代价小。因此，经常可以看到一些对迭代器有些奇怪的约束。例如，Java 的 <strong>Iterator</strong> 只能单向移动。这个 <strong>Iterator</strong> 只能用来：</p> <ol> <li>使用 <code>iterator()</code> 方法要求集合返回一个 <strong>Iterator</strong>。 <strong>Iterator</strong> 将准备好返回序列中的第一个元素。</li> <li>使用 <code>next()</code> 方法获得序列中的下一个元素。</li> <li>使用 <code>hasNext()</code> 方法检查序列中是否还有元素。</li> <li>使用 <code>remove()</code> 方法将迭代器最近返回的那个元素删除。</li> </ol> <p>为了观察它的工作方式，这里再次使用<a href>类型信息</a>章节中的 <strong>Pet</strong> 工具：</p> <div class=highlight><pre><span></span><code><span class=c1>// collections/SimpleIteration.java</span>
<span class=kn>import</span> <span class=nn>typeinfo.pets.*</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>java.util.*</span><span class=p>;</span>

<span class=kd>public</span> <span class=kd>class</span> <span class=nc>SimpleIteration</span> <span class=p>{</span>
  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=p>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>List</span><span class=o>&lt;</span><span class=n>Pet</span><span class=o>&gt;</span> <span class=n>pets</span> <span class=o>=</span> <span class=n>Pets</span><span class=p>.</span><span class=na>list</span><span class=p>(</span><span class=mi>12</span><span class=p>);</span>
    <span class=n>Iterator</span><span class=o>&lt;</span><span class=n>Pet</span><span class=o>&gt;</span> <span class=n>it</span> <span class=o>=</span> <span class=n>pets</span><span class=p>.</span><span class=na>iterator</span><span class=p>();</span>
    <span class=k>while</span><span class=p>(</span><span class=n>it</span><span class=p>.</span><span class=na>hasNext</span><span class=p>())</span> <span class=p>{</span>
      <span class=n>Pet</span> <span class=n>p</span> <span class=o>=</span> <span class=n>it</span><span class=p>.</span><span class=na>next</span><span class=p>();</span>
      <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>print</span><span class=p>(</span><span class=n>p</span><span class=p>.</span><span class=na>id</span><span class=p>()</span> <span class=o>+</span> <span class=s>&quot;:&quot;</span> <span class=o>+</span> <span class=n>p</span> <span class=o>+</span> <span class=s>&quot; &quot;</span><span class=p>);</span>
    <span class=p>}</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>();</span>
    <span class=c1>// A simpler approach, when possible:</span>
    <span class=k>for</span><span class=p>(</span><span class=n>Pet</span> <span class=n>p</span> <span class=p>:</span> <span class=n>pets</span><span class=p>)</span>
      <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>print</span><span class=p>(</span><span class=n>p</span><span class=p>.</span><span class=na>id</span><span class=p>()</span> <span class=o>+</span> <span class=s>&quot;:&quot;</span> <span class=o>+</span> <span class=n>p</span> <span class=o>+</span> <span class=s>&quot; &quot;</span><span class=p>);</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>();</span>
    <span class=c1>// An Iterator can also remove elements:</span>
    <span class=n>it</span> <span class=o>=</span> <span class=n>pets</span><span class=p>.</span><span class=na>iterator</span><span class=p>();</span>
    <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=mi>6</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
      <span class=n>it</span><span class=p>.</span><span class=na>next</span><span class=p>();</span>
      <span class=n>it</span><span class=p>.</span><span class=na>remove</span><span class=p>();</span>
    <span class=p>}</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>pets</span><span class=p>);</span>
  <span class=p>}</span>
<span class=p>}</span>
<span class=cm>/* Output:</span>
<span class=cm>0:Rat 1:Manx 2:Cymric 3:Mutt 4:Pug 5:Cymric 6:Pug</span>
<span class=cm>7:Manx 8:Cymric 9:Rat 10:EgyptianMau 11:Hamster</span>
<span class=cm>0:Rat 1:Manx 2:Cymric 3:Mutt 4:Pug 5:Cymric 6:Pug</span>
<span class=cm>7:Manx 8:Cymric 9:Rat 10:EgyptianMau 11:Hamster</span>
<span class=cm>[Pug, Manx, Cymric, Rat, EgyptianMau, Hamster]</span>
<span class=cm>*/</span>
</code></pre></div> <p>有了 <strong>Iterator</strong> ，就不必再为集合中元素的数量操心了。这是由 <code>hasNext()</code> 和 <code>next()</code> 关心的事情。</p> <p>如果只是想向前遍历 <strong>List</strong> ，并不打算修改 <strong>List</strong> 对象本身，那么使用 <em>for-in</em> 语法更加简洁。</p> <p><strong>Iterator</strong> 还可以删除由 <code>next()</code> 生成的最后一个元素，这意味着在调用 <code>remove()</code> 之前必须先调用 <code>next()</code> 。<sup id=fnref:4><a class=footnote-ref href=#fn:4>4</a></sup></p> <p>在集合中的每个对象上执行操作，这种思想十分强大，并且贯穿于本书。</p> <p>现在考虑创建一个 <code>display()</code> 方法，它不必知晓集合的确切类型：</p> <div class=highlight><pre><span></span><code><span class=c1>// collections/CrossCollectionIteration.java</span>
<span class=kn>import</span> <span class=nn>typeinfo.pets.*</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>java.util.*</span><span class=p>;</span>

<span class=kd>public</span> <span class=kd>class</span> <span class=nc>CrossCollectionIteration</span> <span class=p>{</span>
  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>display</span><span class=p>(</span><span class=n>Iterator</span><span class=o>&lt;</span><span class=n>Pet</span><span class=o>&gt;</span> <span class=n>it</span><span class=p>)</span> <span class=p>{</span>
    <span class=k>while</span><span class=p>(</span><span class=n>it</span><span class=p>.</span><span class=na>hasNext</span><span class=p>())</span> <span class=p>{</span>
      <span class=n>Pet</span> <span class=n>p</span> <span class=o>=</span> <span class=n>it</span><span class=p>.</span><span class=na>next</span><span class=p>();</span>
      <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>print</span><span class=p>(</span><span class=n>p</span><span class=p>.</span><span class=na>id</span><span class=p>()</span> <span class=o>+</span> <span class=s>&quot;:&quot;</span> <span class=o>+</span> <span class=n>p</span> <span class=o>+</span> <span class=s>&quot; &quot;</span><span class=p>);</span>
    <span class=p>}</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>();</span>
  <span class=p>}</span>
  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=p>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>List</span><span class=o>&lt;</span><span class=n>Pet</span><span class=o>&gt;</span> <span class=n>pets</span> <span class=o>=</span> <span class=n>Pets</span><span class=p>.</span><span class=na>list</span><span class=p>(</span><span class=mi>8</span><span class=p>);</span>
    <span class=n>LinkedList</span><span class=o>&lt;</span><span class=n>Pet</span><span class=o>&gt;</span> <span class=n>petsLL</span> <span class=o>=</span> <span class=k>new</span> <span class=n>LinkedList</span><span class=o>&lt;&gt;</span><span class=p>(</span><span class=n>pets</span><span class=p>);</span>
    <span class=n>HashSet</span><span class=o>&lt;</span><span class=n>Pet</span><span class=o>&gt;</span> <span class=n>petsHS</span> <span class=o>=</span> <span class=k>new</span> <span class=n>HashSet</span><span class=o>&lt;&gt;</span><span class=p>(</span><span class=n>pets</span><span class=p>);</span>
    <span class=n>TreeSet</span><span class=o>&lt;</span><span class=n>Pet</span><span class=o>&gt;</span> <span class=n>petsTS</span> <span class=o>=</span> <span class=k>new</span> <span class=n>TreeSet</span><span class=o>&lt;&gt;</span><span class=p>(</span><span class=n>pets</span><span class=p>);</span>
    <span class=n>display</span><span class=p>(</span><span class=n>pets</span><span class=p>.</span><span class=na>iterator</span><span class=p>());</span>
    <span class=n>display</span><span class=p>(</span><span class=n>petsLL</span><span class=p>.</span><span class=na>iterator</span><span class=p>());</span>
    <span class=n>display</span><span class=p>(</span><span class=n>petsHS</span><span class=p>.</span><span class=na>iterator</span><span class=p>());</span>
    <span class=n>display</span><span class=p>(</span><span class=n>petsTS</span><span class=p>.</span><span class=na>iterator</span><span class=p>());</span>
  <span class=p>}</span>
<span class=p>}</span>
<span class=cm>/* Output:</span>
<span class=cm>0:Rat 1:Manx 2:Cymric 3:Mutt 4:Pug 5:Cymric 6:Pug</span>
<span class=cm>7:Manx</span>
<span class=cm>0:Rat 1:Manx 2:Cymric 3:Mutt 4:Pug 5:Cymric 6:Pug</span>
<span class=cm>7:Manx</span>
<span class=cm>0:Rat 1:Manx 2:Cymric 3:Mutt 4:Pug 5:Cymric 6:Pug</span>
<span class=cm>7:Manx</span>
<span class=cm>5:Cymric 2:Cymric 7:Manx 1:Manx 3:Mutt 6:Pug 4:Pug</span>
<span class=cm>0:Rat</span>
<span class=cm>*/</span>
</code></pre></div> <p><code>display()</code> 方法不包含任何有关它所遍历的序列的类型信息。这也展示了 <strong>Iterator</strong> 的真正威力：能够将遍历序列的操作与该序列的底层结构分离。出于这个原因，我们有时会说：迭代器统一了对集合的访问方式。</p> <p>我们可以使用 <strong>Iterable</strong> 接口生成上一个示例的更简洁版本，该接口描述了“可以产生 <strong>Iterator</strong> 的任何东西”：</p> <div class=highlight><pre><span></span><code><span class=c1>// collections/CrossCollectionIteration2.java</span>
<span class=kn>import</span> <span class=nn>typeinfo.pets.*</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>java.util.*</span><span class=p>;</span>

<span class=kd>public</span> <span class=kd>class</span> <span class=nc>CrossCollectionIteration2</span> <span class=p>{</span>
  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>display</span><span class=p>(</span><span class=n>Iterable</span><span class=o>&lt;</span><span class=n>Pet</span><span class=o>&gt;</span> <span class=n>ip</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>Iterator</span><span class=o>&lt;</span><span class=n>Pet</span><span class=o>&gt;</span> <span class=n>it</span> <span class=o>=</span> <span class=n>ip</span><span class=p>.</span><span class=na>iterator</span><span class=p>();</span>
    <span class=k>while</span><span class=p>(</span><span class=n>it</span><span class=p>.</span><span class=na>hasNext</span><span class=p>())</span> <span class=p>{</span>
      <span class=n>Pet</span> <span class=n>p</span> <span class=o>=</span> <span class=n>it</span><span class=p>.</span><span class=na>next</span><span class=p>();</span>
      <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>print</span><span class=p>(</span><span class=n>p</span><span class=p>.</span><span class=na>id</span><span class=p>()</span> <span class=o>+</span> <span class=s>&quot;:&quot;</span> <span class=o>+</span> <span class=n>p</span> <span class=o>+</span> <span class=s>&quot; &quot;</span><span class=p>);</span>
    <span class=p>}</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>();</span>
  <span class=p>}</span>
  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=p>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>List</span><span class=o>&lt;</span><span class=n>Pet</span><span class=o>&gt;</span> <span class=n>pets</span> <span class=o>=</span> <span class=n>Pets</span><span class=p>.</span><span class=na>list</span><span class=p>(</span><span class=mi>8</span><span class=p>);</span>
    <span class=n>LinkedList</span><span class=o>&lt;</span><span class=n>Pet</span><span class=o>&gt;</span> <span class=n>petsLL</span> <span class=o>=</span> <span class=k>new</span> <span class=n>LinkedList</span><span class=o>&lt;&gt;</span><span class=p>(</span><span class=n>pets</span><span class=p>);</span>
    <span class=n>HashSet</span><span class=o>&lt;</span><span class=n>Pet</span><span class=o>&gt;</span> <span class=n>petsHS</span> <span class=o>=</span> <span class=k>new</span> <span class=n>HashSet</span><span class=o>&lt;&gt;</span><span class=p>(</span><span class=n>pets</span><span class=p>);</span>
    <span class=n>TreeSet</span><span class=o>&lt;</span><span class=n>Pet</span><span class=o>&gt;</span> <span class=n>petsTS</span> <span class=o>=</span> <span class=k>new</span> <span class=n>TreeSet</span><span class=o>&lt;&gt;</span><span class=p>(</span><span class=n>pets</span><span class=p>);</span>
    <span class=n>display</span><span class=p>(</span><span class=n>pets</span><span class=p>);</span>
    <span class=n>display</span><span class=p>(</span><span class=n>petsLL</span><span class=p>);</span>
    <span class=n>display</span><span class=p>(</span><span class=n>petsHS</span><span class=p>);</span>
    <span class=n>display</span><span class=p>(</span><span class=n>petsTS</span><span class=p>);</span>
  <span class=p>}</span>
<span class=p>}</span>
<span class=cm>/* Output:</span>
<span class=cm>0:Rat 1:Manx 2:Cymric 3:Mutt 4:Pug 5:Cymric 6:Pug</span>
<span class=cm>7:Manx</span>
<span class=cm>0:Rat 1:Manx 2:Cymric 3:Mutt 4:Pug 5:Cymric 6:Pug</span>
<span class=cm>7:Manx</span>
<span class=cm>0:Rat 1:Manx 2:Cymric 3:Mutt 4:Pug 5:Cymric 6:Pug</span>
<span class=cm>7:Manx</span>
<span class=cm>5:Cymric 2:Cymric 7:Manx 1:Manx 3:Mutt 6:Pug 4:Pug</span>
<span class=cm>0:Rat</span>
<span class=cm>*/</span>
</code></pre></div> <p>这里所有的类都是 <strong>Iterable</strong> ，所以现在对 <code>display()</code> 的调用显然更简单。</p> <!-- ListIterator --> <h3 id=listiterator>ListIterator<a class=headerlink href=#listiterator title="Permanent link">#</a></h3> <p><strong>ListIterator</strong> 是一个更强大的 <strong>Iterator</strong> 子类型，它只能由各种 <strong>List</strong> 类生成。 <strong>Iterator</strong> 只能向前移动，而 <strong>ListIterator</strong> 可以双向移动。它可以生成迭代器在列表中指向位置的后一个和前一个元素的索引，并且可以使用 <code>set()</code> 方法替换它访问过的最近一个元素。可以通过调用 <code>listIterator()</code> 方法来生成指向 <strong>List</strong> 开头处的 <strong>ListIterator</strong> ，还可以通过调用 <code>listIterator(n)</code> 创建一个一开始就指向列表索引号为 <strong>n</strong> 的元素处的 <strong>ListIterator</strong> 。 下面的示例演示了所有这些能力：</p> <div class=highlight><pre><span></span><code><span class=c1>// collections/ListIteration.java</span>
<span class=kn>import</span> <span class=nn>typeinfo.pets.*</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>java.util.*</span><span class=p>;</span>

<span class=kd>public</span> <span class=kd>class</span> <span class=nc>ListIteration</span> <span class=p>{</span>
  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=p>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>List</span><span class=o>&lt;</span><span class=n>Pet</span><span class=o>&gt;</span> <span class=n>pets</span> <span class=o>=</span> <span class=n>Pets</span><span class=p>.</span><span class=na>list</span><span class=p>(</span><span class=mi>8</span><span class=p>);</span>
    <span class=n>ListIterator</span><span class=o>&lt;</span><span class=n>Pet</span><span class=o>&gt;</span> <span class=n>it</span> <span class=o>=</span> <span class=n>pets</span><span class=p>.</span><span class=na>listIterator</span><span class=p>();</span>
    <span class=k>while</span><span class=p>(</span><span class=n>it</span><span class=p>.</span><span class=na>hasNext</span><span class=p>())</span>
      <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>print</span><span class=p>(</span><span class=n>it</span><span class=p>.</span><span class=na>next</span><span class=p>()</span> <span class=o>+</span>
        <span class=s>&quot;, &quot;</span> <span class=o>+</span> <span class=n>it</span><span class=p>.</span><span class=na>nextIndex</span><span class=p>()</span> <span class=o>+</span>
        <span class=s>&quot;, &quot;</span> <span class=o>+</span> <span class=n>it</span><span class=p>.</span><span class=na>previousIndex</span><span class=p>()</span> <span class=o>+</span> <span class=s>&quot;; &quot;</span><span class=p>);</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>();</span>
    <span class=c1>// Backwards:</span>
    <span class=k>while</span><span class=p>(</span><span class=n>it</span><span class=p>.</span><span class=na>hasPrevious</span><span class=p>())</span>
      <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>print</span><span class=p>(</span><span class=n>it</span><span class=p>.</span><span class=na>previous</span><span class=p>().</span><span class=na>id</span><span class=p>()</span> <span class=o>+</span> <span class=s>&quot; &quot;</span><span class=p>);</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>();</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>pets</span><span class=p>);</span>
    <span class=n>it</span> <span class=o>=</span> <span class=n>pets</span><span class=p>.</span><span class=na>listIterator</span><span class=p>(</span><span class=mi>3</span><span class=p>);</span>
    <span class=k>while</span><span class=p>(</span><span class=n>it</span><span class=p>.</span><span class=na>hasNext</span><span class=p>())</span> <span class=p>{</span>
      <span class=n>it</span><span class=p>.</span><span class=na>next</span><span class=p>();</span>
      <span class=n>it</span><span class=p>.</span><span class=na>set</span><span class=p>(</span><span class=n>Pets</span><span class=p>.</span><span class=na>get</span><span class=p>());</span>
    <span class=p>}</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>pets</span><span class=p>);</span>
  <span class=p>}</span>
<span class=p>}</span>
<span class=cm>/* Output:</span>
<span class=cm>Rat, 1, 0; Manx, 2, 1; Cymric, 3, 2; Mutt, 4, 3; Pug,</span>
<span class=cm>5, 4; Cymric, 6, 5; Pug, 7, 6; Manx, 8, 7;</span>
<span class=cm>7 6 5 4 3 2 1 0</span>
<span class=cm>[Rat, Manx, Cymric, Mutt, Pug, Cymric, Pug, Manx]</span>
<span class=cm>[Rat, Manx, Cymric, Cymric, Rat, EgyptianMau, Hamster,</span>
<span class=cm>EgyptianMau]</span>
<span class=cm>*/</span>
</code></pre></div> <p><code>Pets.get()</code> 方法用来从位置 3 开始替换 <strong>List</strong> 中的所有 Pet 对象。</p> <!-- LinkedList --> <h2 id=linkedlist>链表LinkedList<a class=headerlink href=#linkedlist title="Permanent link">#</a></h2> <p><strong>LinkedList</strong> 也像 <strong>ArrayList</strong> 一样实现了基本的 <strong>List</strong> 接口，但它在 <strong>List</strong> 中间执行插入和删除操作时比 <strong>ArrayList</strong> 更高效。然而,它在随机访问操作效率方面却要逊色一些。</p> <p><strong>LinkedList 还添加了一些方法，使其可以被用作栈、队列或双端队列（deque）</strong> 。在这些方法中，有些彼此之间可能只是名称有些差异，或者只存在些许差异，以使得这些名字在特定用法的上下文环境中更加适用（特别是在 <strong>Queue</strong> 中）。例如：</p> <ul> <li><code>getFirst()</code> 和 <code>element()</code> 是相同的，它们都返回列表的头部（第一个元素）而并不删除它，如果 <strong>List</strong> 为空，则抛出 <strong>NoSuchElementException</strong> 异常。 <code>peek()</code> 方法与这两个方法只是稍有差异，它在列表为空时返回 <strong>null</strong> 。</li> <li><code>removeFirst()</code> 和 <code>remove()</code> 也是相同的，它们删除并返回列表的头部元素，并在列表为空时抛出 <strong>NoSuchElementException</strong> 异常。 <code>poll()</code> 稍有差异，它在列表为空时返回 <strong>null</strong> 。</li> <li><code>addFirst()</code> 在列表的开头插入一个元素。</li> <li><code>offer()</code> 与 <code>add()</code> 和 <code>addLast()</code> 相同。 它们都在列表的尾部（末尾）添加一个元素。</li> <li><code>removeLast()</code> 删除并返回列表的最后一个元素。</li> </ul> <p>下面的示例展示了这些功能之间基本的相似性和差异性。它并不是重复执行 <strong>ListFeatures.java</strong> 中所示的行为：</p> <div class=highlight><pre><span></span><code><span class=c1>// collections/LinkedListFeatures.java</span>
<span class=kn>import</span> <span class=nn>typeinfo.pets.*</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>java.util.*</span><span class=p>;</span>

<span class=kd>public</span> <span class=kd>class</span> <span class=nc>LinkedListFeatures</span> <span class=p>{</span>
  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=p>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>LinkedList</span><span class=o>&lt;</span><span class=n>Pet</span><span class=o>&gt;</span> <span class=n>pets</span> <span class=o>=</span>
      <span class=k>new</span> <span class=n>LinkedList</span><span class=o>&lt;&gt;</span><span class=p>(</span><span class=n>Pets</span><span class=p>.</span><span class=na>list</span><span class=p>(</span><span class=mi>5</span><span class=p>));</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>pets</span><span class=p>);</span>
    <span class=c1>// Identical:</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span>
      <span class=s>&quot;pets.getFirst(): &quot;</span> <span class=o>+</span> <span class=n>pets</span><span class=p>.</span><span class=na>getFirst</span><span class=p>());</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span>
      <span class=s>&quot;pets.element(): &quot;</span> <span class=o>+</span> <span class=n>pets</span><span class=p>.</span><span class=na>element</span><span class=p>());</span>
    <span class=c1>// Only differs in empty-list behavior:</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&quot;pets.peek(): &quot;</span> <span class=o>+</span> <span class=n>pets</span><span class=p>.</span><span class=na>peek</span><span class=p>());</span>
    <span class=c1>// Identical; remove and return the first element:</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span>
      <span class=s>&quot;pets.remove(): &quot;</span> <span class=o>+</span> <span class=n>pets</span><span class=p>.</span><span class=na>remove</span><span class=p>());</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span>
      <span class=s>&quot;pets.removeFirst(): &quot;</span> <span class=o>+</span> <span class=n>pets</span><span class=p>.</span><span class=na>removeFirst</span><span class=p>());</span>
    <span class=c1>// Only differs in empty-list behavior:</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&quot;pets.poll(): &quot;</span> <span class=o>+</span> <span class=n>pets</span><span class=p>.</span><span class=na>poll</span><span class=p>());</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>pets</span><span class=p>);</span>
    <span class=n>pets</span><span class=p>.</span><span class=na>addFirst</span><span class=p>(</span><span class=k>new</span> <span class=n>Rat</span><span class=p>());</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&quot;After addFirst(): &quot;</span> <span class=o>+</span> <span class=n>pets</span><span class=p>);</span>
    <span class=n>pets</span><span class=p>.</span><span class=na>offer</span><span class=p>(</span><span class=n>Pets</span><span class=p>.</span><span class=na>get</span><span class=p>());</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&quot;After offer(): &quot;</span> <span class=o>+</span> <span class=n>pets</span><span class=p>);</span>
    <span class=n>pets</span><span class=p>.</span><span class=na>add</span><span class=p>(</span><span class=n>Pets</span><span class=p>.</span><span class=na>get</span><span class=p>());</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&quot;After add(): &quot;</span> <span class=o>+</span> <span class=n>pets</span><span class=p>);</span>
    <span class=n>pets</span><span class=p>.</span><span class=na>addLast</span><span class=p>(</span><span class=k>new</span> <span class=n>Hamster</span><span class=p>());</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&quot;After addLast(): &quot;</span> <span class=o>+</span> <span class=n>pets</span><span class=p>);</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span>
      <span class=s>&quot;pets.removeLast(): &quot;</span> <span class=o>+</span> <span class=n>pets</span><span class=p>.</span><span class=na>removeLast</span><span class=p>());</span>
  <span class=p>}</span>
<span class=p>}</span>
<span class=cm>/* Output:</span>
<span class=cm>[Rat, Manx, Cymric, Mutt, Pug]</span>
<span class=cm>pets.getFirst(): Rat</span>
<span class=cm>pets.element(): Rat</span>
<span class=cm>pets.peek(): Rat</span>
<span class=cm>pets.remove(): Rat</span>
<span class=cm>pets.removeFirst(): Manx</span>
<span class=cm>pets.poll(): Cymric</span>
<span class=cm>[Mutt, Pug]</span>
<span class=cm>After addFirst(): [Rat, Mutt, Pug]</span>
<span class=cm>After offer(): [Rat, Mutt, Pug, Cymric]</span>
<span class=cm>After add(): [Rat, Mutt, Pug, Cymric, Pug]</span>
<span class=cm>After addLast(): [Rat, Mutt, Pug, Cymric, Pug, Hamster]</span>
<span class=cm>pets.removeLast(): Hamster</span>
<span class=cm>*/</span>
</code></pre></div> <p><code>Pets.list()</code> 的结果被传递给 <strong>LinkedList</strong> 的构造器，以便使用它来填充 <strong>LinkedList</strong> 。如果查看 <strong>Queue</strong> 接口就会发现，它在 <strong>LinkedList</strong> 的基础上添加了 <code>element()</code> ， <code>offer()</code> ， <code>peek()</code> ， <code>poll()</code> 和 <code>remove()</code> 方法，以使其可以成为一个 <strong>Queue</strong> 的实现。 <strong>Queue</strong> 的完整示例将在本章稍后给出。</p> <!-- Stack --> <h2 id=stack>堆栈Stack<a class=headerlink href=#stack title="Permanent link">#</a></h2> <p>堆栈是“后进先出”（LIFO）集合。它有时被称为<em>叠加栈</em>（pushdown stack），因为最后“压入”（push）栈的元素，第一个被“弹出”（pop）栈。经常用来类比栈的事物是带有弹簧支架的自助餐厅托盘。最后装入的托盘总是最先拿出来使用的。</p> <p>Java 1.0 中附带了一个 <strong>Stack</strong> 类，结果设计得很糟糕（为了向后兼容，我们永远坚持 Java 中的旧设计错误）。Java 6 添加了 <strong>ArrayDeque</strong> ，其中包含直接实现堆栈功能的方法：</p> <div class=highlight><pre><span></span><code><span class=c1>// collections/StackTest.java</span>
<span class=kn>import</span> <span class=nn>java.util.*</span><span class=p>;</span>

<span class=kd>public</span> <span class=kd>class</span> <span class=nc>StackTest</span> <span class=p>{</span>
  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=p>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>Deque</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;</span> <span class=n>stack</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ArrayDeque</span><span class=o>&lt;&gt;</span><span class=p>();</span>
    <span class=k>for</span><span class=p>(</span><span class=n>String</span> <span class=n>s</span> <span class=p>:</span> <span class=s>&quot;My dog has fleas&quot;</span><span class=p>.</span><span class=na>split</span><span class=p>(</span><span class=s>&quot; &quot;</span><span class=p>))</span>
      <span class=n>stack</span><span class=p>.</span><span class=na>push</span><span class=p>(</span><span class=n>s</span><span class=p>);</span>
    <span class=k>while</span><span class=p>(</span><span class=o>!</span><span class=n>stack</span><span class=p>.</span><span class=na>isEmpty</span><span class=p>())</span>
      <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>print</span><span class=p>(</span><span class=n>stack</span><span class=p>.</span><span class=na>pop</span><span class=p>()</span> <span class=o>+</span> <span class=s>&quot; &quot;</span><span class=p>);</span>
  <span class=p>}</span>
<span class=p>}</span>
<span class=cm>/* Output:</span>
<span class=cm>fleas has dog My</span>
<span class=cm>*/</span>
</code></pre></div> <p>即使它是作为一个堆栈在使用，我们仍然必须将其声明为 <strong>Deque</strong> 。有时一个名为 <strong>Stack</strong> 的类更能把事情讲清楚：</p> <div class=highlight><pre><span></span><code><span class=c1>// onjava/Stack.java</span>
<span class=c1>// A Stack class built with an ArrayDeque</span>
<span class=kn>package</span> <span class=nn>onjava</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>java.util.Deque</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>java.util.ArrayDeque</span><span class=p>;</span>

<span class=kd>public</span> <span class=kd>class</span> <span class=nc>Stack</span><span class=o>&lt;</span><span class=n>T</span><span class=o>&gt;</span> <span class=p>{</span>
  <span class=kd>private</span> <span class=n>Deque</span><span class=o>&lt;</span><span class=n>T</span><span class=o>&gt;</span> <span class=n>storage</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ArrayDeque</span><span class=o>&lt;&gt;</span><span class=p>();</span>
  <span class=kd>public</span> <span class=kt>void</span> <span class=nf>push</span><span class=p>(</span><span class=n>T</span> <span class=n>v</span><span class=p>)</span> <span class=p>{</span> <span class=n>storage</span><span class=p>.</span><span class=na>push</span><span class=p>(</span><span class=n>v</span><span class=p>);</span> <span class=p>}</span>
  <span class=kd>public</span> <span class=n>T</span> <span class=nf>peek</span><span class=p>()</span> <span class=p>{</span> <span class=k>return</span> <span class=n>storage</span><span class=p>.</span><span class=na>peek</span><span class=p>();</span> <span class=p>}</span>
  <span class=kd>public</span> <span class=n>T</span> <span class=nf>pop</span><span class=p>()</span> <span class=p>{</span> <span class=k>return</span> <span class=n>storage</span><span class=p>.</span><span class=na>pop</span><span class=p>();</span> <span class=p>}</span>
  <span class=kd>public</span> <span class=kt>boolean</span> <span class=nf>isEmpty</span><span class=p>()</span> <span class=p>{</span> <span class=k>return</span> <span class=n>storage</span><span class=p>.</span><span class=na>isEmpty</span><span class=p>();</span> <span class=p>}</span>
  <span class=nd>@Override</span>
  <span class=kd>public</span> <span class=n>String</span> <span class=nf>toString</span><span class=p>()</span> <span class=p>{</span>
    <span class=k>return</span> <span class=n>storage</span><span class=p>.</span><span class=na>toString</span><span class=p>();</span>
  <span class=p>}</span>
<span class=p>}</span>
</code></pre></div> <p>这里引入了使用泛型的类定义的最简单的可能示例。类名称后面的 <strong><t></strong> 告诉编译器这是一个参数化类型，而其中的类型参数 <strong>T</strong> 会在使用类时被实际类型替换。基本上，这个类是在声明“我们在定义一个可以持有 <strong>T</strong> 类型对象的 <strong>Stack</strong> 。” <strong>Stack</strong> 是使用 <strong>ArrayDeque</strong> 实现的，而 <strong>ArrayDeque</strong> 也被告知它将持有 <strong>T</strong> 类型对象。注意， <code>push()</code> 接受类型为 <strong>T</strong> 的对象，而 <code>peek()</code> 和 <code>pop()</code> 返回类型为 <strong>T</strong> 的对象。 <code>peek()</code> 方法将返回栈顶元素，但并不将其从栈顶删除，而 <code>pop()</code> 删除并返回顶部元素。</p> <p>如果只需要栈的行为，那么使用继承是不合适的，因为这将产生一个具有 <strong>ArrayDeque</strong> 的其它所有方法的类（在<a href>附录：集合主题</a>中将会看到， <strong>Java 1.0</strong> 设计者在创建 <strong>java.util.Stack</strong> 时，就犯了这个错误）。使用组合，可以选择要公开的方法以及如何命名它们。</p> <p>下面将使用 <strong>StackTest.java</strong> 中的相同代码来演示这个新的 <strong>Stack</strong> 类：</p> <div class=highlight><pre><span></span><code><span class=c1>// collections/StackTest2.java</span>
<span class=kn>import</span> <span class=nn>onjava.*</span><span class=p>;</span>

<span class=kd>public</span> <span class=kd>class</span> <span class=nc>StackTest2</span> <span class=p>{</span>
  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=p>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>Stack</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;</span> <span class=n>stack</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Stack</span><span class=o>&lt;&gt;</span><span class=p>();</span>
    <span class=k>for</span><span class=p>(</span><span class=n>String</span> <span class=n>s</span> <span class=p>:</span> <span class=s>&quot;My dog has fleas&quot;</span><span class=p>.</span><span class=na>split</span><span class=p>(</span><span class=s>&quot; &quot;</span><span class=p>))</span>
      <span class=n>stack</span><span class=p>.</span><span class=na>push</span><span class=p>(</span><span class=n>s</span><span class=p>);</span>
    <span class=k>while</span><span class=p>(</span><span class=o>!</span><span class=n>stack</span><span class=p>.</span><span class=na>isEmpty</span><span class=p>())</span>
      <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>print</span><span class=p>(</span><span class=n>stack</span><span class=p>.</span><span class=na>pop</span><span class=p>()</span> <span class=o>+</span> <span class=s>&quot; &quot;</span><span class=p>);</span>
  <span class=p>}</span>
<span class=p>}</span>
<span class=cm>/* Output:</span>
<span class=cm>fleas has dog My</span>
<span class=cm>*/</span>
</code></pre></div> <p>如果想在自己的代码中使用这个 <strong>Stack** 类，当在创建其实例时，就需要完整指定包名，或者更改这个类的名称；否则，就有可能会与 <strong>java.util</strong> 包中的 <strong>Stack</strong> 发生冲突。例如，如果我们在上面的例子中导入 *<em>java.util.</em></strong>，那么就必须使用包名来防止冲突：</p> <div class=highlight><pre><span></span><code><span class=c1>// collections/StackCollision.java</span>

<span class=kd>public</span> <span class=kd>class</span> <span class=nc>StackCollision</span> <span class=p>{</span>
  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=p>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>onjava</span><span class=p>.</span><span class=na>Stack</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;</span> <span class=n>stack</span> <span class=o>=</span> <span class=k>new</span> <span class=n>onjava</span><span class=p>.</span><span class=na>Stack</span><span class=o>&lt;&gt;</span><span class=p>();</span>
    <span class=k>for</span><span class=p>(</span><span class=n>String</span> <span class=n>s</span> <span class=p>:</span> <span class=s>&quot;My dog has fleas&quot;</span><span class=p>.</span><span class=na>split</span><span class=p>(</span><span class=s>&quot; &quot;</span><span class=p>))</span>
      <span class=n>stack</span><span class=p>.</span><span class=na>push</span><span class=p>(</span><span class=n>s</span><span class=p>);</span>
    <span class=k>while</span><span class=p>(</span><span class=o>!</span><span class=n>stack</span><span class=p>.</span><span class=na>isEmpty</span><span class=p>())</span>
      <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>print</span><span class=p>(</span><span class=n>stack</span><span class=p>.</span><span class=na>pop</span><span class=p>()</span> <span class=o>+</span> <span class=s>&quot; &quot;</span><span class=p>);</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>();</span>
    <span class=n>java</span><span class=p>.</span><span class=na>util</span><span class=p>.</span><span class=na>Stack</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;</span> <span class=n>stack2</span> <span class=o>=</span>
      <span class=k>new</span> <span class=n>java</span><span class=p>.</span><span class=na>util</span><span class=p>.</span><span class=na>Stack</span><span class=o>&lt;&gt;</span><span class=p>();</span>
    <span class=k>for</span><span class=p>(</span><span class=n>String</span> <span class=n>s</span> <span class=p>:</span> <span class=s>&quot;My dog has fleas&quot;</span><span class=p>.</span><span class=na>split</span><span class=p>(</span><span class=s>&quot; &quot;</span><span class=p>))</span>
      <span class=n>stack2</span><span class=p>.</span><span class=na>push</span><span class=p>(</span><span class=n>s</span><span class=p>);</span>
    <span class=k>while</span><span class=p>(</span><span class=o>!</span><span class=n>stack2</span><span class=p>.</span><span class=na>empty</span><span class=p>())</span>
      <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>print</span><span class=p>(</span><span class=n>stack2</span><span class=p>.</span><span class=na>pop</span><span class=p>()</span> <span class=o>+</span> <span class=s>&quot; &quot;</span><span class=p>);</span>
  <span class=p>}</span>
<span class=p>}</span>
<span class=cm>/* Output:</span>
<span class=cm>fleas has dog My</span>
<span class=cm>fleas has dog My</span>
<span class=cm>*/</span>
</code></pre></div> <p>尽管已经有了 <strong>java.util.Stack</strong> ，但是 <strong>ArrayDeque</strong> 可以产生更好的 <strong>Stack</strong> ，因此更可取。</p> <p>还可以使用显式导入来控制对“首选” <strong>Stack</strong> 实现的选择： <div class=highlight><pre><span></span><code><span class=kn>import</span> <span class=nn>onjava.Stack</span><span class=p>;</span>
</code></pre></div></p> <p>现在,任何对 <strong>Stack</strong> 的引用都将选择 <strong>onjava</strong> 版本，而在选择 <strong>java.util.Stack</strong> 时，必须使用全限定名称（full qualification）。</p> <!-- Set --> <h2 id=set>集合Set<a class=headerlink href=#set title="Permanent link">#</a></h2> <p><strong>Set</strong> 不保存重复的元素。 如果试图将相同对象的多个实例添加到 <strong>Set</strong> 中，那么它会阻止这种重复行为。 <strong>Set</strong> 最常见的用途是测试归属性，可以很轻松地询问某个对象是否在一个 <strong>Set</strong> 中。因此，查找通常是 <strong>Set</strong> 最重要的操作，因此通常会选择 <strong>HashSet</strong> 实现，该实现针对快速查找进行了优化。</p> <p><strong>Set</strong> 具有与 <strong>Collection</strong> 相同的接口，因此没有任何额外的功能，不像前面两种不同类型的 <strong>List</strong> 那样。实际上， <strong>Set</strong> 就是一个 <strong>Collection</strong> ，只是行为不同。（这是继承和多态思想的典型应用：表现不同的行为。）<strong>Set</strong> 根据对象的“值”确定归属性，更复杂的内容将在<a href>附录：集合主题</a>中介绍。</p> <p>下面是使用存放 <strong>Integer</strong> 对象的 <strong>HashSet</strong> 的示例：</p> <div class=highlight><pre><span></span><code><span class=c1>// collections/SetOfInteger.java</span>
<span class=kn>import</span> <span class=nn>java.util.*</span><span class=p>;</span>

<span class=kd>public</span> <span class=kd>class</span> <span class=nc>SetOfInteger</span> <span class=p>{</span>
  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=p>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>Random</span> <span class=n>rand</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Random</span><span class=p>(</span><span class=mi>47</span><span class=p>);</span>
    <span class=n>Set</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>&gt;</span> <span class=n>intset</span> <span class=o>=</span> <span class=k>new</span> <span class=n>HashSet</span><span class=o>&lt;&gt;</span><span class=p>();</span>
    <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=mi>10000</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span>
      <span class=n>intset</span><span class=p>.</span><span class=na>add</span><span class=p>(</span><span class=n>rand</span><span class=p>.</span><span class=na>nextInt</span><span class=p>(</span><span class=mi>30</span><span class=p>));</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>intset</span><span class=p>);</span>
  <span class=p>}</span>
<span class=p>}</span>
<span class=cm>/* Output:</span>
<span class=cm>[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15,</span>
<span class=cm>16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]</span>
<span class=cm>*/</span>
</code></pre></div> <p>在 0 到 29 之间的 10000 个随机整数被添加到 <strong>Set</strong> 中，因此可以想象每个值都重复了很多次。但是从结果中可以看到，每一个数只有一个实例出现在结果中。</p> <p>早期 Java 版本中的 <strong>HashSet</strong> 产生的输出没有可辨别的顺序。这是因为出于对速度的追求， <strong>HashSet</strong> 使用了散列，请参阅<a href>附录：集合主题</a>一章。由 <strong>HashSet</strong> 维护的顺序与 <strong>TreeSet</strong> 或 <strong>LinkedHashSet</strong> 不同，因为它们的实现具有不同的元素存储方式。 <strong>TreeSet</strong> 将元素存储在红-黑树数据结构中，而 <strong>HashSet</strong> 使用散列函数。 <strong>LinkedHashSet</strong> 因为查询速度的原因也使用了散列，但是看起来使用了链表来维护元素的插入顺序。看起来散列算法好像已经改变了，现在 <strong>Integer</strong> 按顺序排序。但是，您不应该依赖此行为：</p> <div class=highlight><pre><span></span><code><span class=c1>// collections/SetOfString.java</span>
<span class=kn>import</span> <span class=nn>java.util.*</span><span class=p>;</span>

<span class=kd>public</span> <span class=kd>class</span> <span class=nc>SetOfString</span> <span class=p>{</span>
  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=p>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>Set</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;</span> <span class=n>colors</span> <span class=o>=</span> <span class=k>new</span> <span class=n>HashSet</span><span class=o>&lt;&gt;</span><span class=p>();</span>
    <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=mi>100</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
      <span class=n>colors</span><span class=p>.</span><span class=na>add</span><span class=p>(</span><span class=s>&quot;Yellow&quot;</span><span class=p>);</span>
      <span class=n>colors</span><span class=p>.</span><span class=na>add</span><span class=p>(</span><span class=s>&quot;Blue&quot;</span><span class=p>);</span>
      <span class=n>colors</span><span class=p>.</span><span class=na>add</span><span class=p>(</span><span class=s>&quot;Red&quot;</span><span class=p>);</span>
      <span class=n>colors</span><span class=p>.</span><span class=na>add</span><span class=p>(</span><span class=s>&quot;Red&quot;</span><span class=p>);</span>
      <span class=n>colors</span><span class=p>.</span><span class=na>add</span><span class=p>(</span><span class=s>&quot;Orange&quot;</span><span class=p>);</span>
      <span class=n>colors</span><span class=p>.</span><span class=na>add</span><span class=p>(</span><span class=s>&quot;Yellow&quot;</span><span class=p>);</span>
      <span class=n>colors</span><span class=p>.</span><span class=na>add</span><span class=p>(</span><span class=s>&quot;Blue&quot;</span><span class=p>);</span>
      <span class=n>colors</span><span class=p>.</span><span class=na>add</span><span class=p>(</span><span class=s>&quot;Purple&quot;</span><span class=p>);</span>
    <span class=p>}</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>colors</span><span class=p>);</span>
  <span class=p>}</span>
<span class=p>}</span>
<span class=cm>/* Output:</span>
<span class=cm>[Red, Yellow, Blue, Purple, Orange]</span>
<span class=cm>*/</span>
</code></pre></div> <p><strong>String</strong> 对象似乎没有排序。要对结果进行排序，一种方法是使用 <strong>TreeSet</strong> 而不是 <strong>HashSet</strong> ：</p> <div class=highlight><pre><span></span><code><span class=c1>// collections/SortedSetOfString.java</span>
<span class=kn>import</span> <span class=nn>java.util.*</span><span class=p>;</span>

<span class=kd>public</span> <span class=kd>class</span> <span class=nc>SortedSetOfString</span> <span class=p>{</span>
  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=p>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>Set</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;</span> <span class=n>colors</span> <span class=o>=</span> <span class=k>new</span> <span class=n>TreeSet</span><span class=o>&lt;&gt;</span><span class=p>();</span>
    <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=mi>100</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
      <span class=n>colors</span><span class=p>.</span><span class=na>add</span><span class=p>(</span><span class=s>&quot;Yellow&quot;</span><span class=p>);</span>
      <span class=n>colors</span><span class=p>.</span><span class=na>add</span><span class=p>(</span><span class=s>&quot;Blue&quot;</span><span class=p>);</span>
      <span class=n>colors</span><span class=p>.</span><span class=na>add</span><span class=p>(</span><span class=s>&quot;Red&quot;</span><span class=p>);</span>
      <span class=n>colors</span><span class=p>.</span><span class=na>add</span><span class=p>(</span><span class=s>&quot;Red&quot;</span><span class=p>);</span>
      <span class=n>colors</span><span class=p>.</span><span class=na>add</span><span class=p>(</span><span class=s>&quot;Orange&quot;</span><span class=p>);</span>
      <span class=n>colors</span><span class=p>.</span><span class=na>add</span><span class=p>(</span><span class=s>&quot;Yellow&quot;</span><span class=p>);</span>
      <span class=n>colors</span><span class=p>.</span><span class=na>add</span><span class=p>(</span><span class=s>&quot;Blue&quot;</span><span class=p>);</span>
      <span class=n>colors</span><span class=p>.</span><span class=na>add</span><span class=p>(</span><span class=s>&quot;Purple&quot;</span><span class=p>);</span>
    <span class=p>}</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>colors</span><span class=p>);</span>
  <span class=p>}</span>
<span class=p>}</span>
<span class=cm>/* Output:</span>
<span class=cm>[Blue, Orange, Purple, Red, Yellow]</span>
<span class=cm>*/</span>
</code></pre></div> <p>最常见的操作之一是使用 <code>contains()</code> 测试成员归属性，但也有一些其它操作，这可能会让你想起在小学学过的维恩图（译者注：利用图形的交合表示多个集合之间的逻辑关系）：</p> <div class=highlight><pre><span></span><code><span class=c1>// collections/SetOperations.java</span>
<span class=kn>import</span> <span class=nn>java.util.*</span><span class=p>;</span>

<span class=kd>public</span> <span class=kd>class</span> <span class=nc>SetOperations</span> <span class=p>{</span>
  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=p>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>Set</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;</span> <span class=n>set1</span> <span class=o>=</span> <span class=k>new</span> <span class=n>HashSet</span><span class=o>&lt;&gt;</span><span class=p>();</span>
    <span class=n>Collections</span><span class=p>.</span><span class=na>addAll</span><span class=p>(</span><span class=n>set1</span><span class=p>,</span>
      <span class=s>&quot;A B C D E F G H I J K L&quot;</span><span class=p>.</span><span class=na>split</span><span class=p>(</span><span class=s>&quot; &quot;</span><span class=p>));</span>
    <span class=n>set1</span><span class=p>.</span><span class=na>add</span><span class=p>(</span><span class=s>&quot;M&quot;</span><span class=p>);</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&quot;H: &quot;</span> <span class=o>+</span> <span class=n>set1</span><span class=p>.</span><span class=na>contains</span><span class=p>(</span><span class=s>&quot;H&quot;</span><span class=p>));</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&quot;N: &quot;</span> <span class=o>+</span> <span class=n>set1</span><span class=p>.</span><span class=na>contains</span><span class=p>(</span><span class=s>&quot;N&quot;</span><span class=p>));</span>
    <span class=n>Set</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;</span> <span class=n>set2</span> <span class=o>=</span> <span class=k>new</span> <span class=n>HashSet</span><span class=o>&lt;&gt;</span><span class=p>();</span>
    <span class=n>Collections</span><span class=p>.</span><span class=na>addAll</span><span class=p>(</span><span class=n>set2</span><span class=p>,</span> <span class=s>&quot;H I J K L&quot;</span><span class=p>.</span><span class=na>split</span><span class=p>(</span><span class=s>&quot; &quot;</span><span class=p>));</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span>
      <span class=s>&quot;set2 in set1: &quot;</span> <span class=o>+</span> <span class=n>set1</span><span class=p>.</span><span class=na>containsAll</span><span class=p>(</span><span class=n>set2</span><span class=p>));</span>
    <span class=n>set1</span><span class=p>.</span><span class=na>remove</span><span class=p>(</span><span class=s>&quot;H&quot;</span><span class=p>);</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&quot;set1: &quot;</span> <span class=o>+</span> <span class=n>set1</span><span class=p>);</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span>
      <span class=s>&quot;set2 in set1: &quot;</span> <span class=o>+</span> <span class=n>set1</span><span class=p>.</span><span class=na>containsAll</span><span class=p>(</span><span class=n>set2</span><span class=p>));</span>
    <span class=n>set1</span><span class=p>.</span><span class=na>removeAll</span><span class=p>(</span><span class=n>set2</span><span class=p>);</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span>
      <span class=s>&quot;set2 removed from set1: &quot;</span> <span class=o>+</span> <span class=n>set1</span><span class=p>);</span>
    <span class=n>Collections</span><span class=p>.</span><span class=na>addAll</span><span class=p>(</span><span class=n>set1</span><span class=p>,</span> <span class=s>&quot;X Y Z&quot;</span><span class=p>.</span><span class=na>split</span><span class=p>(</span><span class=s>&quot; &quot;</span><span class=p>));</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span>
      <span class=s>&quot;&#39;X Y Z&#39; added to set1: &quot;</span> <span class=o>+</span> <span class=n>set1</span><span class=p>);</span>
  <span class=p>}</span>
<span class=p>}</span>
<span class=cm>/* Output:</span>
<span class=cm>H: true</span>
<span class=cm>N: false</span>
<span class=cm>set2 in set1: true</span>
<span class=cm>set1: [A, B, C, D, E, F, G, I, J, K, L, M]</span>
<span class=cm>set2 in set1: false</span>
<span class=cm>set2 removed from set1: [A, B, C, D, E, F, G, M]</span>
<span class=cm>&#39;X Y Z&#39; added to set1: [A, B, C, D, E, F, G, M, X, Y,</span>
<span class=cm>Z]</span>
<span class=cm>*/</span>
</code></pre></div> <p>这些方法名都是自解释的，JDK 文档中还有一些其它的方法。</p> <p>能够产生每个元素都唯一的列表是相当有用的功能。例如，假设想要列出上面的 <strong>SetOperations.java</strong> 文件中的所有单词，通过使用本书后面介绍的 <code>java.nio.file.Files.readAllLines()</code> 方法，可以打开一个文件，并将其作为一个 <strong>List\<string></strong> 读取，每个 <strong>String</strong> 都是输入文件中的一行：</p> <div class=highlight><pre><span></span><code><span class=c1>// collections/UniqueWords.java</span>
<span class=kn>import</span> <span class=nn>java.util.*</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>java.nio.file.*</span><span class=p>;</span>

<span class=kd>public</span> <span class=kd>class</span> <span class=nc>UniqueWords</span> <span class=p>{</span>
  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span>
  <span class=nf>main</span><span class=p>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=p>)</span> <span class=kd>throws</span> <span class=n>Exception</span> <span class=p>{</span>
    <span class=n>List</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;</span> <span class=n>lines</span> <span class=o>=</span> <span class=n>Files</span><span class=p>.</span><span class=na>readAllLines</span><span class=p>(</span>
      <span class=n>Paths</span><span class=p>.</span><span class=na>get</span><span class=p>(</span><span class=s>&quot;SetOperations.java&quot;</span><span class=p>));</span>
    <span class=n>Set</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;</span> <span class=n>words</span> <span class=o>=</span> <span class=k>new</span> <span class=n>TreeSet</span><span class=o>&lt;&gt;</span><span class=p>();</span>
    <span class=k>for</span><span class=p>(</span><span class=n>String</span> <span class=n>line</span> <span class=p>:</span> <span class=n>lines</span><span class=p>)</span>
      <span class=k>for</span><span class=p>(</span><span class=n>String</span> <span class=n>word</span> <span class=p>:</span> <span class=n>line</span><span class=p>.</span><span class=na>split</span><span class=p>(</span><span class=s>&quot;\\W+&quot;</span><span class=p>))</span>
        <span class=k>if</span><span class=p>(</span><span class=n>word</span><span class=p>.</span><span class=na>trim</span><span class=p>().</span><span class=na>length</span><span class=p>()</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>)</span>
          <span class=n>words</span><span class=p>.</span><span class=na>add</span><span class=p>(</span><span class=n>word</span><span class=p>);</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>words</span><span class=p>);</span>
  <span class=p>}</span>
<span class=p>}</span>
<span class=cm>/* Output:</span>
<span class=cm>[A, B, C, Collections, D, E, F, G, H, HashSet, I, J, K,</span>
<span class=cm>L, M, N, Output, Set, SetOperations, String, System, X,</span>
<span class=cm>Y, Z, add, addAll, added, args, class, collections,</span>
<span class=cm>contains, containsAll, false, from, import, in, java,</span>
<span class=cm>main, new, out, println, public, remove, removeAll,</span>
<span class=cm>removed, set1, set2, split, static, to, true, util,</span>
<span class=cm>void]</span>
<span class=cm>*/</span>
</code></pre></div> <p>我们逐步浏览文件中的每一行，并使用 <code>String.split()</code> 将其分解为单词，这里使用正则表达式 <strong>\ W +</strong> ，这意味着它会依据一个或多个（即 <strong>+</strong> ）非单词字母来拆分字符串（正则表达式将在<a href>字符串</a>章节介绍）。每个结果单词都会添加到 <strong>Set words</strong> 中。因为它是 <strong>TreeSet</strong> ，所以对结果进行排序。这里，排序是按<em>字典顺序</em>（lexicographically）完成的，因此大写和小写字母位于不同的组中。如果想按<em>字母顺序</em>（alphabetically）对其进行排序，可以向 <strong>TreeSet</strong> 构造器传入 <strong>String.CASE<em>INSENSITIVE</em>ORDER</strong> 比较器（比较器是一个建立排序顺序的对象）：</p> <div class=highlight><pre><span></span><code><span class=c1>// collections/UniqueWordsAlphabetic.java</span>
<span class=c1>// Producing an alphabetic listing</span>
<span class=kn>import</span> <span class=nn>java.util.*</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>java.nio.file.*</span><span class=p>;</span>

<span class=kd>public</span> <span class=kd>class</span> <span class=nc>UniqueWordsAlphabetic</span> <span class=p>{</span>
  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span>
  <span class=nf>main</span><span class=p>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=p>)</span> <span class=kd>throws</span> <span class=n>Exception</span> <span class=p>{</span>
    <span class=n>List</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;</span> <span class=n>lines</span> <span class=o>=</span> <span class=n>Files</span><span class=p>.</span><span class=na>readAllLines</span><span class=p>(</span>
      <span class=n>Paths</span><span class=p>.</span><span class=na>get</span><span class=p>(</span><span class=s>&quot;SetOperations.java&quot;</span><span class=p>));</span>
    <span class=n>Set</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;</span> <span class=n>words</span> <span class=o>=</span>
      <span class=k>new</span> <span class=n>TreeSet</span><span class=o>&lt;&gt;</span><span class=p>(</span><span class=n>String</span><span class=p>.</span><span class=na>CASE_INSENSITIVE_ORDER</span><span class=p>);</span>
    <span class=k>for</span><span class=p>(</span><span class=n>String</span> <span class=n>line</span> <span class=p>:</span> <span class=n>lines</span><span class=p>)</span>
      <span class=k>for</span><span class=p>(</span><span class=n>String</span> <span class=n>word</span> <span class=p>:</span> <span class=n>line</span><span class=p>.</span><span class=na>split</span><span class=p>(</span><span class=s>&quot;\\W+&quot;</span><span class=p>))</span>
        <span class=k>if</span><span class=p>(</span><span class=n>word</span><span class=p>.</span><span class=na>trim</span><span class=p>().</span><span class=na>length</span><span class=p>()</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>)</span>
          <span class=n>words</span><span class=p>.</span><span class=na>add</span><span class=p>(</span><span class=n>word</span><span class=p>);</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>words</span><span class=p>);</span>
  <span class=p>}</span>
<span class=p>}</span>
<span class=cm>/* Output:</span>
<span class=cm>[A, add, addAll, added, args, B, C, class, collections,</span>
<span class=cm>contains, containsAll, D, E, F, false, from, G, H,</span>
<span class=cm>HashSet, I, import, in, J, java, K, L, M, main, N, new,</span>
<span class=cm>out, Output, println, public, remove, removeAll,</span>
<span class=cm>removed, Set, set1, set2, SetOperations, split, static,</span>
<span class=cm>String, System, to, true, util, void, X, Y, Z]</span>
<span class=cm>*/</span>
</code></pre></div> <p><strong>Comparator</strong> 比较器将在<a href>数组</a>章节详细介绍。</p> <!-- Map --> <h2 id=map>映射Map<a class=headerlink href=#map title="Permanent link">#</a></h2> <p>将对象映射到其他对象的能力是解决编程问题的有效方法。例如，考虑一个程序，它被用来检查 Java 的 <strong>Random</strong> 类的随机性。理想情况下， <strong>Random</strong> 会产生完美的数字分布，但为了测试这一点，则需要生成大量的随机数，并计算落在各种范围内的数字个数。 <strong>Map</strong> 可以很容易地解决这个问题。在本例中，键是 <strong>Random</strong> 生成的数字，而值是该数字出现的次数：</p> <div class=highlight><pre><span></span><code><span class=c1>// collections/Statistics.java</span>
<span class=c1>// (c)2017 MindView LLC: see Copyright.txt</span>
<span class=c1>// We make no guarantees that this code is fit for any purpose.</span>
<span class=c1>// Visit http://OnJava8.com for more book information.</span>
<span class=c1>// Simple demonstration of HashMap</span>
<span class=kn>import</span> <span class=nn>java.util.*</span><span class=p>;</span>

<span class=kd>public</span> <span class=kd>class</span> <span class=nc>Statistics</span> <span class=p>{</span>
  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=p>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>Random</span> <span class=n>rand</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Random</span><span class=p>(</span><span class=mi>47</span><span class=p>);</span>
    <span class=n>Map</span><span class=o>&lt;</span><span class=n>Integer</span><span class=p>,</span> <span class=n>Integer</span><span class=o>&gt;</span> <span class=n>m</span> <span class=o>=</span> <span class=k>new</span> <span class=n>HashMap</span><span class=o>&lt;&gt;</span><span class=p>();</span>
    <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=mi>10000</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
      <span class=c1>// Produce a number between 0 and 20:</span>
      <span class=kt>int</span> <span class=n>r</span> <span class=o>=</span> <span class=n>rand</span><span class=p>.</span><span class=na>nextInt</span><span class=p>(</span><span class=mi>20</span><span class=p>);</span>
      <span class=n>Integer</span> <span class=n>freq</span> <span class=o>=</span> <span class=n>m</span><span class=p>.</span><span class=na>get</span><span class=p>(</span><span class=n>r</span><span class=p>);</span> <span class=c1>// [1]</span>
      <span class=n>m</span><span class=p>.</span><span class=na>put</span><span class=p>(</span><span class=n>r</span><span class=p>,</span> <span class=n>freq</span> <span class=o>==</span> <span class=kc>null</span> <span class=o>?</span> <span class=mi>1</span> <span class=p>:</span> <span class=n>freq</span> <span class=o>+</span> <span class=mi>1</span><span class=p>);</span>
    <span class=p>}</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>m</span><span class=p>);</span>
  <span class=p>}</span>
<span class=p>}</span>
<span class=cm>/* Output:</span>
<span class=cm>{0=481, 1=502, 2=489, 3=508, 4=481, 5=503, 6=519,</span>
<span class=cm>7=471, 8=468, 9=549, 10=513, 11=531, 12=521, 13=506,</span>
<span class=cm>14=477, 15=497, 16=533, 17=509, 18=478, 19=464}</span>
<span class=cm>*/</span>
</code></pre></div> <ul> <li><strong>[1]</strong> 自动包装机制将随机生成的 <strong>int</strong> 转换为可以与 <strong>HashMap</strong> 一起使用的 <strong>Integer</strong> 引用（不能使用基本类型的集合）。如果键不在集合中，则 <code>get()</code> 返回 <strong>null</strong> （这意味着该数字第一次出现）。否则， <code>get()</code> 会为键生成与之关联的 <strong>Integer</strong> 值，然后该值被递增（自动包装机制再次简化了表达式，但实际上确实发生了对 <strong>Integer</strong> 的装箱和拆箱）。</li> </ul> <p>接下来的示例将使用一个 <strong>String</strong> 描述来查找 <strong>Pet</strong> 对象。它还展示了通过使用 <code>containsKey()</code> 和 <code>containsValue()</code> 方法去测试一个 <strong>Map</strong> ，以查看它是否包含某个键或某个值：</p> <div class=highlight><pre><span></span><code><span class=c1>// collections/PetMap.java</span>
<span class=kn>import</span> <span class=nn>typeinfo.pets.*</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>java.util.*</span><span class=p>;</span>

<span class=kd>public</span> <span class=kd>class</span> <span class=nc>PetMap</span> <span class=p>{</span>
  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=p>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>Map</span><span class=o>&lt;</span><span class=n>String</span><span class=p>,</span> <span class=n>Pet</span><span class=o>&gt;</span> <span class=n>petMap</span> <span class=o>=</span> <span class=k>new</span> <span class=n>HashMap</span><span class=o>&lt;&gt;</span><span class=p>();</span>
    <span class=n>petMap</span><span class=p>.</span><span class=na>put</span><span class=p>(</span><span class=s>&quot;My Cat&quot;</span><span class=p>,</span> <span class=k>new</span> <span class=n>Cat</span><span class=p>(</span><span class=s>&quot;Molly&quot;</span><span class=p>));</span>
    <span class=n>petMap</span><span class=p>.</span><span class=na>put</span><span class=p>(</span><span class=s>&quot;My Dog&quot;</span><span class=p>,</span> <span class=k>new</span> <span class=n>Dog</span><span class=p>(</span><span class=s>&quot;Ginger&quot;</span><span class=p>));</span>
    <span class=n>petMap</span><span class=p>.</span><span class=na>put</span><span class=p>(</span><span class=s>&quot;My Hamster&quot;</span><span class=p>,</span> <span class=k>new</span> <span class=n>Hamster</span><span class=p>(</span><span class=s>&quot;Bosco&quot;</span><span class=p>));</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>petMap</span><span class=p>);</span>
    <span class=n>Pet</span> <span class=n>dog</span> <span class=o>=</span> <span class=n>petMap</span><span class=p>.</span><span class=na>get</span><span class=p>(</span><span class=s>&quot;My Dog&quot;</span><span class=p>);</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>dog</span><span class=p>);</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>petMap</span><span class=p>.</span><span class=na>containsKey</span><span class=p>(</span><span class=s>&quot;My Dog&quot;</span><span class=p>));</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>petMap</span><span class=p>.</span><span class=na>containsValue</span><span class=p>(</span><span class=n>dog</span><span class=p>));</span>
  <span class=p>}</span>
<span class=p>}</span>
<span class=cm>/* Output:</span>
<span class=cm>{My Dog=Dog Ginger, My Cat=Cat Molly, My</span>
<span class=cm>Hamster=Hamster Bosco}</span>
<span class=cm>Dog Ginger</span>
<span class=cm>true</span>
<span class=cm>true</span>
<span class=cm>*/</span>
</code></pre></div> <p><strong>Map</strong> 与数组和其他的 <strong>Collection</strong> 一样，可以轻松地扩展到多个维度，只需要创建一个值为 <strong>Map</strong> 的 <strong>Map</strong>（这些 <strong>Map</strong> 的值可以是其他集合，甚至是其他 <strong>Map</strong>）。因此，能够很容易地将集合组合起来以快速生成强大的数据结构。例如，假设你正在追踪有多个宠物的人，只需要一个 <strong>Map\<person, list\\&lt;pet>></strong> 即可：</p> <div class=highlight><pre><span></span><code><span class=c1>// collections/MapOfList.java</span>
<span class=c1>// {java collections.MapOfList}</span>
<span class=kn>package</span> <span class=nn>collections</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>typeinfo.pets.*</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>java.util.*</span><span class=p>;</span>

<span class=kd>public</span> <span class=kd>class</span> <span class=nc>MapOfList</span> <span class=p>{</span>
  <span class=kd>public</span> <span class=kd>static</span> <span class=kd>final</span> <span class=n>Map</span><span class=o>&lt;</span><span class=n>Person</span><span class=p>,</span> <span class=n>List</span><span class=o>&lt;</span> <span class=o>?</span> <span class=kd>extends</span> <span class=n>Pet</span><span class=o>&gt;&gt;</span>
    <span class=n>petPeople</span> <span class=o>=</span> <span class=k>new</span> <span class=n>HashMap</span><span class=o>&lt;&gt;</span><span class=p>();</span>
  <span class=kd>static</span> <span class=p>{</span>
    <span class=n>petPeople</span><span class=p>.</span><span class=na>put</span><span class=p>(</span><span class=k>new</span> <span class=n>Person</span><span class=p>(</span><span class=s>&quot;Dawn&quot;</span><span class=p>),</span>
      <span class=n>Arrays</span><span class=p>.</span><span class=na>asList</span><span class=p>(</span>
        <span class=k>new</span> <span class=n>Cymric</span><span class=p>(</span><span class=s>&quot;Molly&quot;</span><span class=p>),</span>
        <span class=k>new</span> <span class=n>Mutt</span><span class=p>(</span><span class=s>&quot;Spot&quot;</span><span class=p>)));</span>
    <span class=n>petPeople</span><span class=p>.</span><span class=na>put</span><span class=p>(</span><span class=k>new</span> <span class=n>Person</span><span class=p>(</span><span class=s>&quot;Kate&quot;</span><span class=p>),</span>
      <span class=n>Arrays</span><span class=p>.</span><span class=na>asList</span><span class=p>(</span><span class=k>new</span> <span class=n>Cat</span><span class=p>(</span><span class=s>&quot;Shackleton&quot;</span><span class=p>),</span>
        <span class=k>new</span> <span class=n>Cat</span><span class=p>(</span><span class=s>&quot;Elsie May&quot;</span><span class=p>),</span> <span class=k>new</span> <span class=n>Dog</span><span class=p>(</span><span class=s>&quot;Margrett&quot;</span><span class=p>)));</span>
    <span class=n>petPeople</span><span class=p>.</span><span class=na>put</span><span class=p>(</span><span class=k>new</span> <span class=n>Person</span><span class=p>(</span><span class=s>&quot;Marilyn&quot;</span><span class=p>),</span>
      <span class=n>Arrays</span><span class=p>.</span><span class=na>asList</span><span class=p>(</span>
        <span class=k>new</span> <span class=n>Pug</span><span class=p>(</span><span class=s>&quot;Louie aka Louis Snorkelstein Dupree&quot;</span><span class=p>),</span>
        <span class=k>new</span> <span class=n>Cat</span><span class=p>(</span><span class=s>&quot;Stanford&quot;</span><span class=p>),</span>
        <span class=k>new</span> <span class=n>Cat</span><span class=p>(</span><span class=s>&quot;Pinkola&quot;</span><span class=p>)));</span>
    <span class=n>petPeople</span><span class=p>.</span><span class=na>put</span><span class=p>(</span><span class=k>new</span> <span class=n>Person</span><span class=p>(</span><span class=s>&quot;Luke&quot;</span><span class=p>),</span>
      <span class=n>Arrays</span><span class=p>.</span><span class=na>asList</span><span class=p>(</span>
        <span class=k>new</span> <span class=n>Rat</span><span class=p>(</span><span class=s>&quot;Fuzzy&quot;</span><span class=p>),</span> <span class=k>new</span> <span class=n>Rat</span><span class=p>(</span><span class=s>&quot;Fizzy&quot;</span><span class=p>)));</span>
    <span class=n>petPeople</span><span class=p>.</span><span class=na>put</span><span class=p>(</span><span class=k>new</span> <span class=n>Person</span><span class=p>(</span><span class=s>&quot;Isaac&quot;</span><span class=p>),</span>
      <span class=n>Arrays</span><span class=p>.</span><span class=na>asList</span><span class=p>(</span><span class=k>new</span> <span class=n>Rat</span><span class=p>(</span><span class=s>&quot;Freckly&quot;</span><span class=p>)));</span>
  <span class=p>}</span>
  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=p>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&quot;People: &quot;</span> <span class=o>+</span> <span class=n>petPeople</span><span class=p>.</span><span class=na>keySet</span><span class=p>());</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&quot;Pets: &quot;</span> <span class=o>+</span> <span class=n>petPeople</span><span class=p>.</span><span class=na>values</span><span class=p>());</span>
    <span class=k>for</span><span class=p>(</span><span class=n>Person</span> <span class=n>person</span> <span class=p>:</span> <span class=n>petPeople</span><span class=p>.</span><span class=na>keySet</span><span class=p>())</span> <span class=p>{</span>
      <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>person</span> <span class=o>+</span> <span class=s>&quot; has:&quot;</span><span class=p>);</span>
      <span class=k>for</span><span class=p>(</span><span class=n>Pet</span> <span class=n>pet</span> <span class=p>:</span> <span class=n>petPeople</span><span class=p>.</span><span class=na>get</span><span class=p>(</span><span class=n>person</span><span class=p>))</span>
        <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&quot;    &quot;</span> <span class=o>+</span> <span class=n>pet</span><span class=p>);</span>
    <span class=p>}</span>
  <span class=p>}</span>
<span class=p>}</span>
<span class=cm>/* Output:</span>
<span class=cm>People: [Person Dawn, Person Kate, Person Isaac, Person</span>
<span class=cm>Marilyn, Person Luke]</span>
<span class=cm>Pets: [[Cymric Molly, Mutt Spot], [Cat Shackleton, Cat</span>
<span class=cm>Elsie May, Dog Margrett], [Rat Freckly], [Pug Louie aka</span>
<span class=cm>Louis Snorkelstein Dupree, Cat Stanford, Cat Pinkola],</span>
<span class=cm>[Rat Fuzzy, Rat Fizzy]]</span>
<span class=cm>Person Dawn has:</span>
<span class=cm>    Cymric Molly</span>
<span class=cm>    Mutt Spot</span>
<span class=cm>Person Kate has:</span>
<span class=cm>    Cat Shackleton</span>
<span class=cm>    Cat Elsie May</span>
<span class=cm>    Dog Margrett</span>
<span class=cm>Person Isaac has:</span>
<span class=cm>    Rat Freckly</span>
<span class=cm>Person Marilyn has:</span>
<span class=cm>    Pug Louie aka Louis Snorkelstein Dupree</span>
<span class=cm>    Cat Stanford</span>
<span class=cm>    Cat Pinkola</span>
<span class=cm>Person Luke has:</span>
<span class=cm>    Rat Fuzzy</span>
<span class=cm>    Rat Fizzy</span>
<span class=cm>*/</span>
</code></pre></div> <p><strong>Map</strong> 可以返回由其键组成的 <strong>Set</strong> ，由其值组成的 <strong>Collection</strong> ，或者其键值对的 <strong>Set</strong> 。 <code>keySet()</code> 方法生成由在 <strong>petPeople</strong> 中的所有键组成的 <strong>Set</strong> ，它在 <em>for-in</em> 语句中被用来遍历该 <strong>Map</strong> 。</p> <!-- Queue --> <h2 id=queue>队列Queue<a class=headerlink href=#queue title="Permanent link">#</a></h2> <p>队列是一个典型的“先进先出”（FIFO）集合。 即从集合的一端放入事物，再从另一端去获取它们，事物放入集合的顺序和被取出的顺序是相同的。队列通常被当做一种可靠的将对象从程序的某个区域传输到另一个区域的途径。队列在<a href>并发编程</a>中尤为重要，因为它们可以安全地将对象从一个任务传输到另一个任务。</p> <p><strong>LinkedList</strong> 实现了 <strong>Queue</strong> 接口，并且提供了一些方法以支持队列行为，因此 <strong>LinkedList</strong> 可以用作 <strong>Queue</strong> 的一种实现。 通过将 <strong>LinkedList</strong> 向上转换为 <strong>Queue</strong> ，下面的示例使用了在 <strong>Queue</strong> 接口中与 <strong>Queue</strong> 相关(Queue-specific)的方法：</p> <div class=highlight><pre><span></span><code><span class=c1>// collections/QueueDemo.java</span>
<span class=c1>// Upcasting to a Queue from a LinkedList</span>
<span class=kn>import</span> <span class=nn>java.util.*</span><span class=p>;</span>

<span class=kd>public</span> <span class=kd>class</span> <span class=nc>QueueDemo</span> <span class=p>{</span>
  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>printQ</span><span class=p>(</span><span class=n>Queue</span> <span class=n>queue</span><span class=p>)</span> <span class=p>{</span>
    <span class=k>while</span><span class=p>(</span><span class=n>queue</span><span class=p>.</span><span class=na>peek</span><span class=p>()</span> <span class=o>!=</span> <span class=kc>null</span><span class=p>)</span>
      <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>print</span><span class=p>(</span><span class=n>queue</span><span class=p>.</span><span class=na>remove</span><span class=p>()</span> <span class=o>+</span> <span class=s>&quot; &quot;</span><span class=p>);</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>();</span>
  <span class=p>}</span>
  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=p>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>Queue</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>&gt;</span> <span class=n>queue</span> <span class=o>=</span> <span class=k>new</span> <span class=n>LinkedList</span><span class=o>&lt;&gt;</span><span class=p>();</span>
    <span class=n>Random</span> <span class=n>rand</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Random</span><span class=p>(</span><span class=mi>47</span><span class=p>);</span>
    <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=mi>10</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span>
      <span class=n>queue</span><span class=p>.</span><span class=na>offer</span><span class=p>(</span><span class=n>rand</span><span class=p>.</span><span class=na>nextInt</span><span class=p>(</span><span class=n>i</span> <span class=o>+</span> <span class=mi>10</span><span class=p>));</span>
    <span class=n>printQ</span><span class=p>(</span><span class=n>queue</span><span class=p>);</span>
    <span class=n>Queue</span><span class=o>&lt;</span><span class=n>Character</span><span class=o>&gt;</span> <span class=n>qc</span> <span class=o>=</span> <span class=k>new</span> <span class=n>LinkedList</span><span class=o>&lt;&gt;</span><span class=p>();</span>
    <span class=k>for</span><span class=p>(</span><span class=kt>char</span> <span class=n>c</span> <span class=p>:</span> <span class=s>&quot;Brontosaurus&quot;</span><span class=p>.</span><span class=na>toCharArray</span><span class=p>())</span>
      <span class=n>qc</span><span class=p>.</span><span class=na>offer</span><span class=p>(</span><span class=n>c</span><span class=p>);</span>
    <span class=n>printQ</span><span class=p>(</span><span class=n>qc</span><span class=p>);</span>
  <span class=p>}</span>
<span class=p>}</span>
<span class=cm>/* Output:</span>
<span class=cm>8 1 1 1 5 14 3 1 0 1</span>
<span class=cm>B r o n t o s a u r u s</span>
<span class=cm>*/</span>
</code></pre></div> <p><code>offer()</code> 是与 <strong>Queue</strong> 相关的方法之一，它在允许的情况下，在队列的尾部插入一个元素，或者返回 <strong>false</strong> 。 <code>peek()</code> 和 <code>element()</code> 都返回队头元素而不删除它，但是如果队列为空，则 <code>element()</code> 抛出 <strong>NoSuchElementException</strong> ，而 <code>peek()</code> 返回 <strong>null</strong> 。 <code>poll()</code> 和 <code>remove()</code>* 都删除并返回队头元素，但如果队列为空，<code>poll()</code> 返回 <strong>null</strong> ，而 <code>remove()</code> 抛出 <strong>NoSuchElementException</strong> 。</p> <p>自动包装机制会自动将 <code>nextInt()</code> 的 <strong>int</strong> 结果转换为 <strong>queue</strong> 所需的 <strong>Integer</strong> 对象，并将 <strong>char c</strong> 转换为 <strong>qc</strong> 所需的 <strong>Character</strong> 对象。 <strong>Queue</strong> 接口窄化了对 <strong>LinkedList</strong> 方法的访问权限，因此只有适当的方法才能使用，因此能够访问到的 <strong>LinkedList</strong> 的方法会变少（这里实际上可以将 <strong>Queue</strong> 强制转换回 <strong>LinkedList</strong> ，但至少我们不鼓励这样做）。</p> <p>与 <strong>Queue</strong> 相关的方法提供了完整而独立的功能。 也就是说，对于 <strong>Queue</strong> 所继承的 <strong>Collection</strong> ，在不需要使用它的任何方法的情况下，就可以拥有一个可用的 <strong>Queue</strong> 。</p> <!-- PriorityQueue --> <h3 id=priorityqueue>优先级队列PriorityQueue<a class=headerlink href=#priorityqueue title="Permanent link">#</a></h3> <p>先进先出（FIFO）描述了最典型的<em>队列规则</em>（queuing discipline）。队列规则是指在给定队列中的一组元素的情况下，确定下一个弹出队列的元素的规则。先进先出声明的是下一个弹出的元素应该是等待时间最长的元素。</p> <p>优先级队列声明下一个弹出的元素是最需要的元素（具有最高的优先级）。例如，在机场，当飞机临近起飞时，这架飞机的乘客可以在办理登机手续时排到队头。如果构建了一个消息传递系统，某些消息比其他消息更重要，应该尽快处理，而不管它们何时到达。在Java 5 中添加了 <strong>PriorityQueue</strong> ，以便自动实现这种行为。</p> <p>当在 <strong>PriorityQueue</strong> 上调用 <code>offer()</code> 方法来插入一个对象时，该对象会在队列中被排序。<sup id=fnref:5><a class=footnote-ref href=#fn:5>5</a></sup>默认的排序使用队列中对象的<em>自然顺序</em>（natural order），但是可以通过提供自己的 <strong>Comparator</strong> 来修改这个顺序。 <strong>PriorityQueue</strong> 确保在调用 <code>peek()</code> ， <code>poll()</code> 或 <code>remove()</code> 方法时，获得的元素将是队列中优先级最高的元素。</p> <p>让 <strong>PriorityQueue</strong> 与 <strong>Integer</strong> ， <strong>String</strong> 和 <strong>Character</strong> 这样的内置类型一起工作易如反掌。在下面的示例中，第一组值与前一个示例中的随机值相同，可以看到它们从 <strong>PriorityQueue</strong> 中弹出的顺序与前一个示例不同：</p> <div class=highlight><pre><span></span><code><span class=c1>// collections/PriorityQueueDemo.java</span>
<span class=kn>import</span> <span class=nn>java.util.*</span><span class=p>;</span>

<span class=kd>public</span> <span class=kd>class</span> <span class=nc>PriorityQueueDemo</span> <span class=p>{</span>
  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=p>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>PriorityQueue</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>&gt;</span> <span class=n>priorityQueue</span> <span class=o>=</span>
      <span class=k>new</span> <span class=n>PriorityQueue</span><span class=o>&lt;&gt;</span><span class=p>();</span>
    <span class=n>Random</span> <span class=n>rand</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Random</span><span class=p>(</span><span class=mi>47</span><span class=p>);</span>
    <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=mi>10</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span>
      <span class=n>priorityQueue</span><span class=p>.</span><span class=na>offer</span><span class=p>(</span><span class=n>rand</span><span class=p>.</span><span class=na>nextInt</span><span class=p>(</span><span class=n>i</span> <span class=o>+</span> <span class=mi>10</span><span class=p>));</span>
    <span class=n>QueueDemo</span><span class=p>.</span><span class=na>printQ</span><span class=p>(</span><span class=n>priorityQueue</span><span class=p>);</span>

    <span class=n>List</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>&gt;</span> <span class=n>ints</span> <span class=o>=</span> <span class=n>Arrays</span><span class=p>.</span><span class=na>asList</span><span class=p>(</span><span class=mi>25</span><span class=p>,</span> <span class=mi>22</span><span class=p>,</span> <span class=mi>20</span><span class=p>,</span>
      <span class=mi>18</span><span class=p>,</span> <span class=mi>14</span><span class=p>,</span> <span class=mi>9</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>9</span><span class=p>,</span> <span class=mi>14</span><span class=p>,</span> <span class=mi>18</span><span class=p>,</span> <span class=mi>21</span><span class=p>,</span> <span class=mi>23</span><span class=p>,</span> <span class=mi>25</span><span class=p>);</span>
    <span class=n>priorityQueue</span> <span class=o>=</span> <span class=k>new</span> <span class=n>PriorityQueue</span><span class=o>&lt;&gt;</span><span class=p>(</span><span class=n>ints</span><span class=p>);</span>
    <span class=n>QueueDemo</span><span class=p>.</span><span class=na>printQ</span><span class=p>(</span><span class=n>priorityQueue</span><span class=p>);</span>
    <span class=n>priorityQueue</span> <span class=o>=</span> <span class=k>new</span> <span class=n>PriorityQueue</span><span class=o>&lt;&gt;</span><span class=p>(</span>
        <span class=n>ints</span><span class=p>.</span><span class=na>size</span><span class=p>(),</span> <span class=n>Collections</span><span class=p>.</span><span class=na>reverseOrder</span><span class=p>());</span>
    <span class=n>priorityQueue</span><span class=p>.</span><span class=na>addAll</span><span class=p>(</span><span class=n>ints</span><span class=p>);</span>
    <span class=n>QueueDemo</span><span class=p>.</span><span class=na>printQ</span><span class=p>(</span><span class=n>priorityQueue</span><span class=p>);</span>

    <span class=n>String</span> <span class=n>fact</span> <span class=o>=</span> <span class=s>&quot;EDUCATION SHOULD ESCHEW OBFUSCATION&quot;</span><span class=p>;</span>
    <span class=n>List</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;</span> <span class=n>strings</span> <span class=o>=</span>
      <span class=n>Arrays</span><span class=p>.</span><span class=na>asList</span><span class=p>(</span><span class=n>fact</span><span class=p>.</span><span class=na>split</span><span class=p>(</span><span class=s>&quot;&quot;</span><span class=p>));</span>
    <span class=n>PriorityQueue</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;</span> <span class=n>stringPQ</span> <span class=o>=</span>
      <span class=k>new</span> <span class=n>PriorityQueue</span><span class=o>&lt;&gt;</span><span class=p>(</span><span class=n>strings</span><span class=p>);</span>
    <span class=n>QueueDemo</span><span class=p>.</span><span class=na>printQ</span><span class=p>(</span><span class=n>stringPQ</span><span class=p>);</span>
    <span class=n>stringPQ</span> <span class=o>=</span> <span class=k>new</span> <span class=n>PriorityQueue</span><span class=o>&lt;&gt;</span><span class=p>(</span>
      <span class=n>strings</span><span class=p>.</span><span class=na>size</span><span class=p>(),</span> <span class=n>Collections</span><span class=p>.</span><span class=na>reverseOrder</span><span class=p>());</span>
    <span class=n>stringPQ</span><span class=p>.</span><span class=na>addAll</span><span class=p>(</span><span class=n>strings</span><span class=p>);</span>
    <span class=n>QueueDemo</span><span class=p>.</span><span class=na>printQ</span><span class=p>(</span><span class=n>stringPQ</span><span class=p>);</span>

    <span class=n>Set</span><span class=o>&lt;</span><span class=n>Character</span><span class=o>&gt;</span> <span class=n>charSet</span> <span class=o>=</span> <span class=k>new</span> <span class=n>HashSet</span><span class=o>&lt;&gt;</span><span class=p>();</span>
    <span class=k>for</span><span class=p>(</span><span class=kt>char</span> <span class=n>c</span> <span class=p>:</span> <span class=n>fact</span><span class=p>.</span><span class=na>toCharArray</span><span class=p>())</span>
      <span class=n>charSet</span><span class=p>.</span><span class=na>add</span><span class=p>(</span><span class=n>c</span><span class=p>);</span> <span class=c1>// Autoboxing</span>
    <span class=n>PriorityQueue</span><span class=o>&lt;</span><span class=n>Character</span><span class=o>&gt;</span> <span class=n>characterPQ</span> <span class=o>=</span>
      <span class=k>new</span> <span class=n>PriorityQueue</span><span class=o>&lt;&gt;</span><span class=p>(</span><span class=n>charSet</span><span class=p>);</span>
    <span class=n>QueueDemo</span><span class=p>.</span><span class=na>printQ</span><span class=p>(</span><span class=n>characterPQ</span><span class=p>);</span>
  <span class=p>}</span>
<span class=p>}</span>
<span class=cm>/* Output:</span>
<span class=cm>0 1 1 1 1 1 3 5 8 14</span>
<span class=cm>1 1 2 3 3 9 9 14 14 18 18 20 21 22 23 25 25</span>
<span class=cm>25 25 23 22 21 20 18 18 14 14 9 9 3 3 2 1 1</span>
<span class=cm>      A A B C C C D D E E E F H H I I L N N O O O O S S</span>
<span class=cm>S T T U U U W</span>
<span class=cm>W U U U T T S S S O O O O N N L I I H H F E E E D D C C</span>
<span class=cm>C B A A</span>
<span class=cm>  A B C D E F H I L N O S T U W</span>
<span class=cm>*/</span>
</code></pre></div> <p><strong>PriorityQueue</strong> 是允许重复的，最小的值具有最高的优先级（如果是 <strong>String</strong> ，空格也可以算作值，并且比字母的优先级高）。为了展示如何通过提供自己的 <strong>Comparator</strong> 对象来改变顺序，第三个对 <strong>PriorityQueue\<integer></strong> 构造器的调用，和第二个对 <strong>PriorityQueue\<string></strong> 的调用使用了由 <code>Collections.reverseOrder()</code> （Java 5 中新添加的）产生的反序的 <strong>Comparator</strong> 。</p> <p>最后一部分添加了一个 <strong>HashSet</strong> 来消除重复的 <strong>Character</strong>。</p> <p><strong>Integer</strong> ， <strong>String</strong> 和 <strong>Character</strong> 可以与 <strong>PriorityQueue</strong> 一起使用，因为这些类已经内置了自然排序。如果想在 <strong>PriorityQueue</strong> 中使用自己的类，则必须包含额外的功能以产生自然排序，或者必须提供自己的 <strong>Comparator</strong> 。在<a href>附录：集合主题</a>中有一个更复杂的示例来演示这种情况。</p> <!-- Collection vs. Iterator --> <h2 id=_6>集合与迭代器<a class=headerlink href=#_6 title="Permanent link">#</a></h2> <p><strong>Collection</strong> 是所有序列集合共有的根接口。它可能会被认为是一种“附属接口”（incidental interface），即因为要表示其他若干个接口的共性而出现的接口。此外，<strong>java.util.AbstractCollection</strong> 类提供了 <strong>Collection</strong> 的默认实现，使得你可以创建 <strong>AbstractCollection</strong> 的子类型，而其中没有不必要的代码重复。</p> <p>使用接口描述的一个理由是它可以使我们创建更通用的代码。通过针对接口而非具体实现来编写代码，我们的代码可以应用于更多类型的对象。<sup id=fnref:6><a class=footnote-ref href=#fn:6>6</a></sup>因此，如果所编写的方法接受一个 <strong>Collection</strong> ，那么该方法可以应用于任何实现了 <strong>Collection</strong> 的类——这也就使得一个新类可以选择去实现 <strong>Collection</strong> 接口，以便该方法可以使用它。标准 C++ 类库中的集合并没有共同的基类——集合之间的所有共性都是通过迭代器实现的。在 Java 中，遵循 C++ 的方式看起来似乎很明智，即用迭代器而不是 <strong>Collection</strong> 来表示集合之间的共性。但是，这两种方法绑定在了一起，因为实现 <strong>Collection</strong> 就意味着需要提供 <code>iterator()</code> 方法：</p> <div class=highlight><pre><span></span><code><span class=c1>// collections/InterfaceVsIterator.java</span>
<span class=kn>import</span> <span class=nn>typeinfo.pets.*</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>java.util.*</span><span class=p>;</span>

<span class=kd>public</span> <span class=kd>class</span> <span class=nc>InterfaceVsIterator</span> <span class=p>{</span>
  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>display</span><span class=p>(</span><span class=n>Iterator</span><span class=o>&lt;</span><span class=n>Pet</span><span class=o>&gt;</span> <span class=n>it</span><span class=p>)</span> <span class=p>{</span>
    <span class=k>while</span><span class=p>(</span><span class=n>it</span><span class=p>.</span><span class=na>hasNext</span><span class=p>())</span> <span class=p>{</span>
      <span class=n>Pet</span> <span class=n>p</span> <span class=o>=</span> <span class=n>it</span><span class=p>.</span><span class=na>next</span><span class=p>();</span>
      <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>print</span><span class=p>(</span><span class=n>p</span><span class=p>.</span><span class=na>id</span><span class=p>()</span> <span class=o>+</span> <span class=s>&quot;:&quot;</span> <span class=o>+</span> <span class=n>p</span> <span class=o>+</span> <span class=s>&quot; &quot;</span><span class=p>);</span>
    <span class=p>}</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>();</span>
  <span class=p>}</span>
  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>display</span><span class=p>(</span><span class=n>Collection</span><span class=o>&lt;</span><span class=n>Pet</span><span class=o>&gt;</span> <span class=n>pets</span><span class=p>)</span> <span class=p>{</span>
    <span class=k>for</span><span class=p>(</span><span class=n>Pet</span> <span class=n>p</span> <span class=p>:</span> <span class=n>pets</span><span class=p>)</span>
      <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>print</span><span class=p>(</span><span class=n>p</span><span class=p>.</span><span class=na>id</span><span class=p>()</span> <span class=o>+</span> <span class=s>&quot;:&quot;</span> <span class=o>+</span> <span class=n>p</span> <span class=o>+</span> <span class=s>&quot; &quot;</span><span class=p>);</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>();</span>
  <span class=p>}</span>
  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=p>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>List</span><span class=o>&lt;</span><span class=n>Pet</span><span class=o>&gt;</span> <span class=n>petList</span> <span class=o>=</span> <span class=n>Pets</span><span class=p>.</span><span class=na>list</span><span class=p>(</span><span class=mi>8</span><span class=p>);</span>
    <span class=n>Set</span><span class=o>&lt;</span><span class=n>Pet</span><span class=o>&gt;</span> <span class=n>petSet</span> <span class=o>=</span> <span class=k>new</span> <span class=n>HashSet</span><span class=o>&lt;&gt;</span><span class=p>(</span><span class=n>petList</span><span class=p>);</span>
    <span class=n>Map</span><span class=o>&lt;</span><span class=n>String</span><span class=p>,</span> <span class=n>Pet</span><span class=o>&gt;</span> <span class=n>petMap</span> <span class=o>=</span> <span class=k>new</span> <span class=n>LinkedHashMap</span><span class=o>&lt;&gt;</span><span class=p>();</span>
    <span class=n>String</span><span class=o>[]</span> <span class=n>names</span> <span class=o>=</span> <span class=p>(</span><span class=s>&quot;Ralph, Eric, Robin, Lacey, &quot;</span> <span class=o>+</span>
      <span class=s>&quot;Britney, Sam, Spot, Fluffy&quot;</span><span class=p>).</span><span class=na>split</span><span class=p>(</span><span class=s>&quot;, &quot;</span><span class=p>);</span>
    <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>names</span><span class=p>.</span><span class=na>length</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span>
      <span class=n>petMap</span><span class=p>.</span><span class=na>put</span><span class=p>(</span><span class=n>names</span><span class=o>[</span><span class=n>i</span><span class=o>]</span><span class=p>,</span> <span class=n>petList</span><span class=p>.</span><span class=na>get</span><span class=p>(</span><span class=n>i</span><span class=p>));</span>
    <span class=n>display</span><span class=p>(</span><span class=n>petList</span><span class=p>);</span>
    <span class=n>display</span><span class=p>(</span><span class=n>petSet</span><span class=p>);</span>
    <span class=n>display</span><span class=p>(</span><span class=n>petList</span><span class=p>.</span><span class=na>iterator</span><span class=p>());</span>
    <span class=n>display</span><span class=p>(</span><span class=n>petSet</span><span class=p>.</span><span class=na>iterator</span><span class=p>());</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>petMap</span><span class=p>);</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>petMap</span><span class=p>.</span><span class=na>keySet</span><span class=p>());</span>
    <span class=n>display</span><span class=p>(</span><span class=n>petMap</span><span class=p>.</span><span class=na>values</span><span class=p>());</span>
    <span class=n>display</span><span class=p>(</span><span class=n>petMap</span><span class=p>.</span><span class=na>values</span><span class=p>().</span><span class=na>iterator</span><span class=p>());</span>
  <span class=p>}</span>
<span class=p>}</span>
<span class=cm>/* Output:</span>
<span class=cm>0:Rat 1:Manx 2:Cymric 3:Mutt 4:Pug 5:Cymric 6:Pug</span>
<span class=cm>7:Manx</span>
<span class=cm>0:Rat 1:Manx 2:Cymric 3:Mutt 4:Pug 5:Cymric 6:Pug</span>
<span class=cm>7:Manx</span>
<span class=cm>0:Rat 1:Manx 2:Cymric 3:Mutt 4:Pug 5:Cymric 6:Pug</span>
<span class=cm>7:Manx</span>
<span class=cm>0:Rat 1:Manx 2:Cymric 3:Mutt 4:Pug 5:Cymric 6:Pug</span>
<span class=cm>7:Manx</span>
<span class=cm>{Ralph=Rat, Eric=Manx, Robin=Cymric, Lacey=Mutt,</span>
<span class=cm>Britney=Pug, Sam=Cymric, Spot=Pug, Fluffy=Manx}</span>
<span class=cm>[Ralph, Eric, Robin, Lacey, Britney, Sam, Spot, Fluffy]</span>
<span class=cm>0:Rat 1:Manx 2:Cymric 3:Mutt 4:Pug 5:Cymric 6:Pug</span>
<span class=cm>7:Manx</span>
<span class=cm>0:Rat 1:Manx 2:Cymric 3:Mutt 4:Pug 5:Cymric 6:Pug</span>
<span class=cm>7:Manx</span>
<span class=cm>*/</span>
</code></pre></div> <p>两个版本的 <code>display()</code> 方法都可以使用 <strong>Map</strong> 或 <strong>Collection</strong> 的子类型来工作。 而且<strong>Collection</strong> 接口和 <strong>Iterator</strong> 都将 <code>display()</code> 方法与低层集合的特定实现解耦。</p> <p>在本例中，这两种方式都可以奏效。事实上， <strong>Collection</strong> 要更方便一点，因为它是 <strong>Iterable</strong> 类型，因此在 <code>display(Collection)</code> 的实现中可以使用 <em>for-in</em> 构造，这使得代码更加清晰。</p> <p>当需要实现一个不是 <strong>Collection</strong> 的外部类时，由于让它去实现 <strong>Collection</strong> 接口可能非常困难或麻烦，因此使用 <strong>Iterator</strong> 就会变得非常吸引人。例如，如果我们通过继承一个持有 <strong>Pet</strong> 对象的类来创建一个 <strong>Collection</strong> 的实现，那么我们必须实现 <strong>Collection</strong> 所有的方法，即使我们不在 <code>display()</code> 方法中使用它们，也必须这样做。虽然这可以通过继承 <strong>AbstractCollection</strong> 而很容易地实现，但是无论如何还是要被强制去实现 <code>iterator()</code> 和 <code>size()</code> 方法，这些方法 <strong>AbstractCollection</strong> 没有实现，但是 <strong>AbstractCollection</strong> 中的其它方法会用到：</p> <div class=highlight><pre><span></span><code><span class=c1>// collections/CollectionSequence.java</span>
<span class=kn>import</span> <span class=nn>typeinfo.pets.*</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>java.util.*</span><span class=p>;</span>

<span class=kd>public</span> <span class=kd>class</span> <span class=nc>CollectionSequence</span>
<span class=kd>extends</span> <span class=n>AbstractCollection</span><span class=o>&lt;</span><span class=n>Pet</span><span class=o>&gt;</span> <span class=p>{</span>
  <span class=kd>private</span> <span class=n>Pet</span><span class=o>[]</span> <span class=n>pets</span> <span class=o>=</span> <span class=n>Pets</span><span class=p>.</span><span class=na>array</span><span class=p>(</span><span class=mi>8</span><span class=p>);</span>
  <span class=nd>@Override</span>
  <span class=kd>public</span> <span class=kt>int</span> <span class=nf>size</span><span class=p>()</span> <span class=p>{</span> <span class=k>return</span> <span class=n>pets</span><span class=p>.</span><span class=na>length</span><span class=p>;</span> <span class=p>}</span>
  <span class=nd>@Override</span>
  <span class=kd>public</span> <span class=n>Iterator</span><span class=o>&lt;</span><span class=n>Pet</span><span class=o>&gt;</span> <span class=nf>iterator</span><span class=p>()</span> <span class=p>{</span>
    <span class=k>return</span> <span class=k>new</span> <span class=n>Iterator</span><span class=o>&lt;</span><span class=n>Pet</span><span class=o>&gt;</span><span class=p>()</span> <span class=p>{</span> <span class=c1>// [1]</span>
      <span class=kd>private</span> <span class=kt>int</span> <span class=n>index</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
      <span class=nd>@Override</span>
      <span class=kd>public</span> <span class=kt>boolean</span> <span class=nf>hasNext</span><span class=p>()</span> <span class=p>{</span>
        <span class=k>return</span> <span class=n>index</span> <span class=o>&lt;</span> <span class=n>pets</span><span class=p>.</span><span class=na>length</span><span class=p>;</span>
      <span class=p>}</span>
      <span class=nd>@Override</span>
      <span class=kd>public</span> <span class=n>Pet</span> <span class=nf>next</span><span class=p>()</span> <span class=p>{</span> <span class=k>return</span> <span class=n>pets</span><span class=o>[</span><span class=n>index</span><span class=o>++]</span><span class=p>;</span> <span class=p>}</span>
      <span class=nd>@Override</span>
      <span class=kd>public</span> <span class=kt>void</span> <span class=nf>remove</span><span class=p>()</span> <span class=p>{</span> <span class=c1>// Not implemented</span>
        <span class=k>throw</span> <span class=k>new</span> <span class=n>UnsupportedOperationException</span><span class=p>();</span>
      <span class=p>}</span>
    <span class=p>};</span>
  <span class=p>}</span>
  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=p>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>CollectionSequence</span> <span class=n>c</span> <span class=o>=</span> <span class=k>new</span> <span class=n>CollectionSequence</span><span class=p>();</span>
    <span class=n>InterfaceVsIterator</span><span class=p>.</span><span class=na>display</span><span class=p>(</span><span class=n>c</span><span class=p>);</span>
    <span class=n>InterfaceVsIterator</span><span class=p>.</span><span class=na>display</span><span class=p>(</span><span class=n>c</span><span class=p>.</span><span class=na>iterator</span><span class=p>());</span>
  <span class=p>}</span>
<span class=p>}</span>
<span class=cm>/* Output:</span>
<span class=cm>0:Rat 1:Manx 2:Cymric 3:Mutt 4:Pug 5:Cymric 6:Pug</span>
<span class=cm>7:Manx</span>
<span class=cm>0:Rat 1:Manx 2:Cymric 3:Mutt 4:Pug 5:Cymric 6:Pug</span>
<span class=cm>7:Manx</span>
<span class=cm>*/</span>
</code></pre></div> <p><code>remove()</code> 方法是一个“可选操作”，在<a href>附录：集合主题</a>中详细介绍。 这里可以不必实现它，如果你调用它，它将抛出异常。</p> <ul> <li><strong>[1]</strong> 你可能会认为，因为 <code>iterator()</code> 返回 <strong>Iterator\<pet></strong> ，匿名内部类定义可以使用菱形语法，Java可以推断出类型。但这不起作用，类型推断仍然非常有限。</li> </ul> <p>这个例子表明，如果实现了 <strong>Collection</strong> ，就必须实现 <code>iterator()</code> ，并且只拿实现 <code>iterator()</code> 与继承 <strong>AbstractCollection</strong> 相比，花费的代价只有略微减少。但是，如果类已经继承了其他的类，那么就不能继承再 <strong>AbstractCollection</strong> 了。在这种情况下，要实现 <strong>Collection</strong> ，就必须实现该接口中的所有方法。此时，继承并提供创建迭代器的能力要容易得多：</p> <div class=highlight><pre><span></span><code><span class=c1>// collections/NonCollectionSequence.java</span>
<span class=kn>import</span> <span class=nn>typeinfo.pets.*</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>java.util.*</span><span class=p>;</span>

<span class=kd>class</span> <span class=nc>PetSequence</span> <span class=p>{</span>
  <span class=kd>protected</span> <span class=n>Pet</span><span class=o>[]</span> <span class=n>pets</span> <span class=o>=</span> <span class=n>Pets</span><span class=p>.</span><span class=na>array</span><span class=p>(</span><span class=mi>8</span><span class=p>);</span>
<span class=p>}</span>

<span class=kd>public</span> <span class=kd>class</span> <span class=nc>NonCollectionSequence</span> <span class=kd>extends</span> <span class=n>PetSequence</span> <span class=p>{</span>
  <span class=kd>public</span> <span class=n>Iterator</span><span class=o>&lt;</span><span class=n>Pet</span><span class=o>&gt;</span> <span class=nf>iterator</span><span class=p>()</span> <span class=p>{</span>
    <span class=k>return</span> <span class=k>new</span> <span class=n>Iterator</span><span class=o>&lt;</span><span class=n>Pet</span><span class=o>&gt;</span><span class=p>()</span> <span class=p>{</span>
      <span class=kd>private</span> <span class=kt>int</span> <span class=n>index</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
      <span class=nd>@Override</span>
      <span class=kd>public</span> <span class=kt>boolean</span> <span class=nf>hasNext</span><span class=p>()</span> <span class=p>{</span>
        <span class=k>return</span> <span class=n>index</span> <span class=o>&lt;</span> <span class=n>pets</span><span class=p>.</span><span class=na>length</span><span class=p>;</span>
      <span class=p>}</span>
      <span class=nd>@Override</span>
      <span class=kd>public</span> <span class=n>Pet</span> <span class=nf>next</span><span class=p>()</span> <span class=p>{</span> <span class=k>return</span> <span class=n>pets</span><span class=o>[</span><span class=n>index</span><span class=o>++]</span><span class=p>;</span> <span class=p>}</span>
      <span class=nd>@Override</span>
      <span class=kd>public</span> <span class=kt>void</span> <span class=nf>remove</span><span class=p>()</span> <span class=p>{</span> <span class=c1>// Not implemented</span>
        <span class=k>throw</span> <span class=k>new</span> <span class=n>UnsupportedOperationException</span><span class=p>();</span>
      <span class=p>}</span>
    <span class=p>};</span>
  <span class=p>}</span>
  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=p>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>NonCollectionSequence</span> <span class=n>nc</span> <span class=o>=</span>
      <span class=k>new</span> <span class=n>NonCollectionSequence</span><span class=p>();</span>
    <span class=n>InterfaceVsIterator</span><span class=p>.</span><span class=na>display</span><span class=p>(</span><span class=n>nc</span><span class=p>.</span><span class=na>iterator</span><span class=p>());</span>
  <span class=p>}</span>
<span class=p>}</span>
<span class=cm>/* Output:</span>
<span class=cm>0:Rat 1:Manx 2:Cymric 3:Mutt 4:Pug 5:Cymric 6:Pug</span>
<span class=cm>7:Manx</span>
<span class=cm>*/</span>
</code></pre></div> <p>生成 <strong>Iterator</strong> 是将序列与消费该序列的方法连接在一起耦合度最小的方式，并且与实现 <strong>Collection</strong> 相比，它在序列类上所施加的约束也少得多。</p> <!-- for-in and Iterators --> <h2 id=for-in>for-in和迭代器<a class=headerlink href=#for-in title="Permanent link">#</a></h2> <p>到目前为止，<em>for-in</em> 语法主要用于数组，但它也适用于任何 <strong>Collection</strong> 对象。实际上在使用 <strong>ArrayList</strong> 时，已经看到了一些使用它的示例，下面是一个更通用的证明：</p> <div class=highlight><pre><span></span><code><span class=c1>// collections/ForInCollections.java</span>
<span class=c1>// All collections work with for-in</span>
<span class=kn>import</span> <span class=nn>java.util.*</span><span class=p>;</span>

<span class=kd>public</span> <span class=kd>class</span> <span class=nc>ForInCollections</span> <span class=p>{</span>
  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=p>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>Collection</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;</span> <span class=n>cs</span> <span class=o>=</span> <span class=k>new</span> <span class=n>LinkedList</span><span class=o>&lt;&gt;</span><span class=p>();</span>
    <span class=n>Collections</span><span class=p>.</span><span class=na>addAll</span><span class=p>(</span><span class=n>cs</span><span class=p>,</span>
      <span class=s>&quot;Take the long way home&quot;</span><span class=p>.</span><span class=na>split</span><span class=p>(</span><span class=s>&quot; &quot;</span><span class=p>));</span>
    <span class=k>for</span><span class=p>(</span><span class=n>String</span> <span class=n>s</span> <span class=p>:</span> <span class=n>cs</span><span class=p>)</span>
      <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>print</span><span class=p>(</span><span class=s>&quot;&#39;&quot;</span> <span class=o>+</span> <span class=n>s</span> <span class=o>+</span> <span class=s>&quot;&#39; &quot;</span><span class=p>);</span>
  <span class=p>}</span>
<span class=p>}</span>
<span class=cm>/* Output:</span>
<span class=cm>&#39;Take&#39; &#39;the&#39; &#39;long&#39; &#39;way&#39; &#39;home&#39;</span>
<span class=cm>*/</span>
</code></pre></div> <p>由于 <strong>cs</strong> 是一个 <strong>Collection</strong> ，因此该代码展示了使用 <em>for-in</em> 是所有 <strong>Collection</strong> 对象的特征。</p> <p>这样做的原因是 Java 5 引入了一个名为 <strong>Iterable</strong> 的接口，该接口包含一个能够生成 <strong>Iterator</strong> 的 <code>iterator()</code> 方法。<em>for-in</em> 使用此 <strong>Iterable</strong> 接口来遍历序列。因此，如果创建了任何实现了 <strong>Iterable</strong> 的类，都可以将它用于 <em>for-in</em> 语句中：</p> <div class=highlight><pre><span></span><code><span class=c1>// collections/IterableClass.java</span>
<span class=c1>// Anything Iterable works with for-in</span>
<span class=kn>import</span> <span class=nn>java.util.*</span><span class=p>;</span>

<span class=kd>public</span> <span class=kd>class</span> <span class=nc>IterableClass</span> <span class=kd>implements</span> <span class=n>Iterable</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;</span> <span class=p>{</span>
  <span class=kd>protected</span> <span class=n>String</span><span class=o>[]</span> <span class=n>words</span> <span class=o>=</span> <span class=p>(</span><span class=s>&quot;And that is how &quot;</span> <span class=o>+</span>
    <span class=s>&quot;we know the Earth to be banana-shaped.&quot;</span>
    <span class=p>).</span><span class=na>split</span><span class=p>(</span><span class=s>&quot; &quot;</span><span class=p>);</span>
  <span class=nd>@Override</span>
  <span class=kd>public</span> <span class=n>Iterator</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;</span> <span class=nf>iterator</span><span class=p>()</span> <span class=p>{</span>
    <span class=k>return</span> <span class=k>new</span> <span class=n>Iterator</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;</span><span class=p>()</span> <span class=p>{</span>
      <span class=kd>private</span> <span class=kt>int</span> <span class=n>index</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
      <span class=nd>@Override</span>
      <span class=kd>public</span> <span class=kt>boolean</span> <span class=nf>hasNext</span><span class=p>()</span> <span class=p>{</span>
        <span class=k>return</span> <span class=n>index</span> <span class=o>&lt;</span> <span class=n>words</span><span class=p>.</span><span class=na>length</span><span class=p>;</span>
      <span class=p>}</span>
      <span class=nd>@Override</span>
      <span class=kd>public</span> <span class=n>String</span> <span class=nf>next</span><span class=p>()</span> <span class=p>{</span> <span class=k>return</span> <span class=n>words</span><span class=o>[</span><span class=n>index</span><span class=o>++]</span><span class=p>;</span> <span class=p>}</span>
      <span class=nd>@Override</span>
      <span class=kd>public</span> <span class=kt>void</span> <span class=nf>remove</span><span class=p>()</span> <span class=p>{</span> <span class=c1>// Not implemented</span>
        <span class=k>throw</span> <span class=k>new</span> <span class=n>UnsupportedOperationException</span><span class=p>();</span>
      <span class=p>}</span>
    <span class=p>};</span>
  <span class=p>}</span>
  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=p>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=p>)</span> <span class=p>{</span>
    <span class=k>for</span><span class=p>(</span><span class=n>String</span> <span class=n>s</span> <span class=p>:</span> <span class=k>new</span> <span class=n>IterableClass</span><span class=p>())</span>
      <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>print</span><span class=p>(</span><span class=n>s</span> <span class=o>+</span> <span class=s>&quot; &quot;</span><span class=p>);</span>
  <span class=p>}</span>
<span class=p>}</span>
<span class=cm>/* Output:</span>
<span class=cm>And that is how we know the Earth to be banana-shaped.</span>
<span class=cm>*/</span>
</code></pre></div> <p><code>iterator()</code> 返回的是实现了 <strong>Iterator\<string></strong> 的匿名内部类的实例，该匿名内部类可以遍历数组中的每个单词。在主方法中，可以看到 <strong>IterableClass</strong> 确实可以用于 <em>for-in</em> 语句。</p> <p>在 Java 5 中，许多类都是 <strong>Iterable</strong> ，主要包括所有的 <strong>Collection</strong> 类（但不包括各种 <strong>Maps</strong> ）。 例如，下面的代码可以显示所有的操作系统环境变量：</p> <div class=highlight><pre><span></span><code><span class=c1>// collections/EnvironmentVariables.java</span>
<span class=c1>// {VisuallyInspectOutput}</span>
<span class=kn>import</span> <span class=nn>java.util.*</span><span class=p>;</span>

<span class=kd>public</span> <span class=kd>class</span> <span class=nc>EnvironmentVariables</span> <span class=p>{</span>
  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=p>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=p>)</span> <span class=p>{</span>
    <span class=k>for</span><span class=p>(</span><span class=n>Map</span><span class=p>.</span><span class=na>Entry</span> <span class=n>entry</span><span class=p>:</span> <span class=n>System</span><span class=p>.</span><span class=na>getenv</span><span class=p>().</span><span class=na>entrySet</span><span class=p>())</span> <span class=p>{</span>
      <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>entry</span><span class=p>.</span><span class=na>getKey</span><span class=p>()</span> <span class=o>+</span> <span class=s>&quot;: &quot;</span> <span class=o>+</span>
        <span class=n>entry</span><span class=p>.</span><span class=na>getValue</span><span class=p>());</span>
    <span class=p>}</span>
  <span class=p>}</span>
<span class=p>}</span>
</code></pre></div> <p><code>System.getenv()</code> <sup id=fnref:7><a class=footnote-ref href=#fn:7>7</a></sup>返回一个 <strong>Map</strong> ， <code>entrySet()</code> 产生一个由 <strong>Map.Entry</strong> 的元素构成的 <strong>Set</strong> ，并且这个 <strong>Set</strong> 是一个 <strong>Iterable</strong> ，因此它可以用于 <em>for-in</em> 循环。</p> <p><em>for-in</em> 语句适用于数组或其它任何 <strong>Iterable</strong> ，但这并不意味着数组肯定也是个 <strong>Iterable</strong> ，也不会发生任何自动装箱：</p> <div class=highlight><pre><span></span><code><span class=c1>// collections/ArrayIsNotIterable.java</span>
<span class=kn>import</span> <span class=nn>java.util.*</span><span class=p>;</span>

<span class=kd>public</span> <span class=kd>class</span> <span class=nc>ArrayIsNotIterable</span> <span class=p>{</span>
  <span class=kd>static</span> <span class=o>&lt;</span><span class=n>T</span><span class=o>&gt;</span> <span class=kt>void</span> <span class=nf>test</span><span class=p>(</span><span class=n>Iterable</span><span class=o>&lt;</span><span class=n>T</span><span class=o>&gt;</span> <span class=n>ib</span><span class=p>)</span> <span class=p>{</span>
    <span class=k>for</span><span class=p>(</span><span class=n>T</span> <span class=n>t</span> <span class=p>:</span> <span class=n>ib</span><span class=p>)</span>
      <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>print</span><span class=p>(</span><span class=n>t</span> <span class=o>+</span> <span class=s>&quot; &quot;</span><span class=p>);</span>
  <span class=p>}</span>
  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=p>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>test</span><span class=p>(</span><span class=n>Arrays</span><span class=p>.</span><span class=na>asList</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>));</span>
    <span class=n>String</span><span class=o>[]</span> <span class=n>strings</span> <span class=o>=</span> <span class=p>{</span> <span class=s>&quot;A&quot;</span><span class=p>,</span> <span class=s>&quot;B&quot;</span><span class=p>,</span> <span class=s>&quot;C&quot;</span> <span class=p>};</span>
    <span class=c1>// An array works in for-in, but it&#39;s not Iterable:</span>
    <span class=c1>//- test(strings);</span>
    <span class=c1>// You must explicitly convert it to an Iterable:</span>
    <span class=n>test</span><span class=p>(</span><span class=n>Arrays</span><span class=p>.</span><span class=na>asList</span><span class=p>(</span><span class=n>strings</span><span class=p>));</span>
  <span class=p>}</span>
<span class=p>}</span>
<span class=cm>/* Output:</span>
<span class=cm>1 2 3 A B C</span>
<span class=cm>*/</span>
</code></pre></div> <p>尝试将数组作为一个 <strong>Iterable</strong> 参数传递会导致失败。这说明不存在任何从数组到 <strong>Iterable</strong> 的自动转换; 必须手工执行这种转换。</p> <!-- The Adapter Method Idiom --> <h3 id=_7>适配器方法惯用法<a class=headerlink href=#_7 title="Permanent link">#</a></h3> <p>如果现在有一个 <strong>Iterable</strong> 类，你想要添加一种或多种在 <em>for-in</em> 语句中使用这个类的方法，应该怎么做呢？例如，你希望可以选择正向还是反向遍历一个单词列表。如果直接继承这个类，并覆盖 <code>iterator()</code> 方法，则只能替换现有的方法，而不能实现遍历顺序的选择。</p> <p>一种解决方案是所谓<em>适配器方法</em>（Adapter Method）的惯用法。“适配器”部分来自于设计模式，因为必须要提供特定的接口来满足 <em>for-in</em> 语句。如果已经有一个接口并且需要另一个接口时，则编写适配器就可以解决这个问题。 在这里，若希望在默认的正向迭代器的基础上，添加产生反向迭代器的能力，因此不能使用覆盖，相反，而是添加了一个能够生成 <strong>Iterable</strong> 对象的方法，该对象可以用于 <em>for-in</em> 语句。这使得我们可以提供多种使用 <em>for-in</em> 语句的方式：</p> <div class=highlight><pre><span></span><code><span class=c1>// collections/AdapterMethodIdiom.java</span>
<span class=c1>// The &quot;Adapter Method&quot; idiom uses for-in</span>
<span class=c1>// with additional kinds of Iterables</span>
<span class=kn>import</span> <span class=nn>java.util.*</span><span class=p>;</span>

<span class=kd>class</span> <span class=nc>ReversibleArrayList</span><span class=o>&lt;</span><span class=n>T</span><span class=o>&gt;</span> <span class=kd>extends</span> <span class=n>ArrayList</span><span class=o>&lt;</span><span class=n>T</span><span class=o>&gt;</span> <span class=p>{</span>
  <span class=n>ReversibleArrayList</span><span class=p>(</span><span class=n>Collection</span><span class=o>&lt;</span><span class=n>T</span><span class=o>&gt;</span> <span class=n>c</span><span class=p>)</span> <span class=p>{</span>
    <span class=kd>super</span><span class=p>(</span><span class=n>c</span><span class=p>);</span>
  <span class=p>}</span>
  <span class=kd>public</span> <span class=n>Iterable</span><span class=o>&lt;</span><span class=n>T</span><span class=o>&gt;</span> <span class=nf>reversed</span><span class=p>()</span> <span class=p>{</span>
    <span class=k>return</span> <span class=k>new</span> <span class=n>Iterable</span><span class=o>&lt;</span><span class=n>T</span><span class=o>&gt;</span><span class=p>()</span> <span class=p>{</span>
      <span class=kd>public</span> <span class=n>Iterator</span><span class=o>&lt;</span><span class=n>T</span><span class=o>&gt;</span> <span class=nf>iterator</span><span class=p>()</span> <span class=p>{</span>
        <span class=k>return</span> <span class=k>new</span> <span class=n>Iterator</span><span class=o>&lt;</span><span class=n>T</span><span class=o>&gt;</span><span class=p>()</span> <span class=p>{</span>
          <span class=kt>int</span> <span class=n>current</span> <span class=o>=</span> <span class=n>size</span><span class=p>()</span> <span class=o>-</span> <span class=mi>1</span><span class=p>;</span>
          <span class=kd>public</span> <span class=kt>boolean</span> <span class=nf>hasNext</span><span class=p>()</span> <span class=p>{</span>
            <span class=k>return</span> <span class=n>current</span> <span class=o>&gt;</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span>
          <span class=p>}</span>
          <span class=kd>public</span> <span class=n>T</span> <span class=nf>next</span><span class=p>()</span> <span class=p>{</span> <span class=k>return</span> <span class=n>get</span><span class=p>(</span><span class=n>current</span><span class=o>--</span><span class=p>);</span> <span class=p>}</span>
          <span class=kd>public</span> <span class=kt>void</span> <span class=nf>remove</span><span class=p>()</span> <span class=p>{</span> <span class=c1>// Not implemented</span>
            <span class=k>throw</span> <span class=k>new</span> <span class=n>UnsupportedOperationException</span><span class=p>();</span>
          <span class=p>}</span>
        <span class=p>};</span>
      <span class=p>}</span>
    <span class=p>};</span>
  <span class=p>}</span>
<span class=p>}</span>

<span class=kd>public</span> <span class=kd>class</span> <span class=nc>AdapterMethodIdiom</span> <span class=p>{</span>
  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=p>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>ReversibleArrayList</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;</span> <span class=n>ral</span> <span class=o>=</span>
      <span class=k>new</span> <span class=n>ReversibleArrayList</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;</span><span class=p>(</span>
        <span class=n>Arrays</span><span class=p>.</span><span class=na>asList</span><span class=p>(</span><span class=s>&quot;To be or not to be&quot;</span><span class=p>.</span><span class=na>split</span><span class=p>(</span><span class=s>&quot; &quot;</span><span class=p>)));</span>
    <span class=c1>// Grabs the ordinary iterator via iterator():</span>
    <span class=k>for</span><span class=p>(</span><span class=n>String</span> <span class=n>s</span> <span class=p>:</span> <span class=n>ral</span><span class=p>)</span>
      <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>print</span><span class=p>(</span><span class=n>s</span> <span class=o>+</span> <span class=s>&quot; &quot;</span><span class=p>);</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>();</span>
    <span class=c1>// Hand it the Iterable of your choice</span>
    <span class=k>for</span><span class=p>(</span><span class=n>String</span> <span class=n>s</span> <span class=p>:</span> <span class=n>ral</span><span class=p>.</span><span class=na>reversed</span><span class=p>())</span>
      <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>print</span><span class=p>(</span><span class=n>s</span> <span class=o>+</span> <span class=s>&quot; &quot;</span><span class=p>);</span>
  <span class=p>}</span>
<span class=p>}</span>
<span class=cm>/* Output:</span>
<span class=cm>To be or not to be</span>
<span class=cm>be to not or be To</span>
<span class=cm>*/</span>
</code></pre></div> <p>在主方法中，如果直接将 <strong>ral</strong> 对象放在 <em>for-in</em> 语句中，则会得到（默认的）正向迭代器。但是如果在该对象上调用 <code>reversed()</code> 方法，它会产生不同的行为。</p> <p>通过使用这种方式，可以在 <strong>IterableClass.java</strong> 示例中添加两种适配器方法：</p> <div class=highlight><pre><span></span><code><span class=c1>// collections/MultiIterableClass.java</span>
<span class=c1>// Adding several Adapter Methods</span>
<span class=kn>import</span> <span class=nn>java.util.*</span><span class=p>;</span>

<span class=kd>public</span> <span class=kd>class</span> <span class=nc>MultiIterableClass</span> <span class=kd>extends</span> <span class=n>IterableClass</span> <span class=p>{</span>
  <span class=kd>public</span> <span class=n>Iterable</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;</span> <span class=nf>reversed</span><span class=p>()</span> <span class=p>{</span>
    <span class=k>return</span> <span class=k>new</span> <span class=n>Iterable</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;</span><span class=p>()</span> <span class=p>{</span>
      <span class=kd>public</span> <span class=n>Iterator</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;</span> <span class=nf>iterator</span><span class=p>()</span> <span class=p>{</span>
        <span class=k>return</span> <span class=k>new</span> <span class=n>Iterator</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;</span><span class=p>()</span> <span class=p>{</span>
          <span class=kt>int</span> <span class=n>current</span> <span class=o>=</span> <span class=n>words</span><span class=p>.</span><span class=na>length</span> <span class=o>-</span> <span class=mi>1</span><span class=p>;</span>
          <span class=kd>public</span> <span class=kt>boolean</span> <span class=nf>hasNext</span><span class=p>()</span> <span class=p>{</span>
            <span class=k>return</span> <span class=n>current</span> <span class=o>&gt;</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span>
          <span class=p>}</span>
          <span class=kd>public</span> <span class=n>String</span> <span class=nf>next</span><span class=p>()</span> <span class=p>{</span>
            <span class=k>return</span> <span class=n>words</span><span class=o>[</span><span class=n>current</span><span class=o>--]</span><span class=p>;</span>
          <span class=p>}</span>
          <span class=kd>public</span> <span class=kt>void</span> <span class=nf>remove</span><span class=p>()</span> <span class=p>{</span> <span class=c1>// Not implemented</span>
            <span class=k>throw</span> <span class=k>new</span> <span class=n>UnsupportedOperationException</span><span class=p>();</span>
          <span class=p>}</span>
        <span class=p>};</span>
      <span class=p>}</span>
    <span class=p>};</span>
  <span class=p>}</span>
  <span class=kd>public</span> <span class=n>Iterable</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;</span> <span class=nf>randomized</span><span class=p>()</span> <span class=p>{</span>
    <span class=k>return</span> <span class=k>new</span> <span class=n>Iterable</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;</span><span class=p>()</span> <span class=p>{</span>
      <span class=kd>public</span> <span class=n>Iterator</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;</span> <span class=nf>iterator</span><span class=p>()</span> <span class=p>{</span>
        <span class=n>List</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;</span> <span class=n>shuffled</span> <span class=o>=</span>
          <span class=k>new</span> <span class=n>ArrayList</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;</span><span class=p>(</span><span class=n>Arrays</span><span class=p>.</span><span class=na>asList</span><span class=p>(</span><span class=n>words</span><span class=p>));</span>
        <span class=n>Collections</span><span class=p>.</span><span class=na>shuffle</span><span class=p>(</span><span class=n>shuffled</span><span class=p>,</span> <span class=k>new</span> <span class=n>Random</span><span class=p>(</span><span class=mi>47</span><span class=p>));</span>
        <span class=k>return</span> <span class=n>shuffled</span><span class=p>.</span><span class=na>iterator</span><span class=p>();</span>
      <span class=p>}</span>
    <span class=p>};</span>
  <span class=p>}</span>
  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=p>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>MultiIterableClass</span> <span class=n>mic</span> <span class=o>=</span> <span class=k>new</span> <span class=n>MultiIterableClass</span><span class=p>();</span>
    <span class=k>for</span><span class=p>(</span><span class=n>String</span> <span class=n>s</span> <span class=p>:</span> <span class=n>mic</span><span class=p>.</span><span class=na>reversed</span><span class=p>())</span>
      <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>print</span><span class=p>(</span><span class=n>s</span> <span class=o>+</span> <span class=s>&quot; &quot;</span><span class=p>);</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>();</span>
    <span class=k>for</span><span class=p>(</span><span class=n>String</span> <span class=n>s</span> <span class=p>:</span> <span class=n>mic</span><span class=p>.</span><span class=na>randomized</span><span class=p>())</span>
      <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>print</span><span class=p>(</span><span class=n>s</span> <span class=o>+</span> <span class=s>&quot; &quot;</span><span class=p>);</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>();</span>
    <span class=k>for</span><span class=p>(</span><span class=n>String</span> <span class=n>s</span> <span class=p>:</span> <span class=n>mic</span><span class=p>)</span>
      <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>print</span><span class=p>(</span><span class=n>s</span> <span class=o>+</span> <span class=s>&quot; &quot;</span><span class=p>);</span>
  <span class=p>}</span>
<span class=p>}</span>
<span class=cm>/* Output:</span>
<span class=cm>banana-shaped. be to Earth the know we how is that And</span>
<span class=cm>is banana-shaped. Earth that how the be And we know to</span>
<span class=cm>And that is how we know the Earth to be banana-shaped.</span>
<span class=cm>*/</span>
</code></pre></div> <p>注意，第二个方法 <code>random()</code> 没有创建它自己的 <strong>Iterator</strong> ，而是直接返回被打乱的 <strong>List</strong> 中的 <strong>Iterator</strong> 。</p> <p>从输出中可以看到， <code>Collections.shuffle()</code> 方法不会影响到原始数组，而只是打乱了 <strong>shuffled</strong> 中的引用。之所以这样，是因为 <code>randomized()</code> 方法用一个 <strong>ArrayList</strong> 将 <code>Arrays.asList()</code> 的结果包装了起来。如果这个由 <code>Arrays.asList()</code> 生成的 <strong>List</strong> 被直接打乱，那么它将修改底层数组，如下所示：</p> <div class=highlight><pre><span></span><code><span class=c1>// collections/ModifyingArraysAsList.java</span>
<span class=kn>import</span> <span class=nn>java.util.*</span><span class=p>;</span>

<span class=kd>public</span> <span class=kd>class</span> <span class=nc>ModifyingArraysAsList</span> <span class=p>{</span>
  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=p>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>Random</span> <span class=n>rand</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Random</span><span class=p>(</span><span class=mi>47</span><span class=p>);</span>
    <span class=n>Integer</span><span class=o>[]</span> <span class=n>ia</span> <span class=o>=</span> <span class=p>{</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>,</span> <span class=mi>7</span><span class=p>,</span> <span class=mi>8</span><span class=p>,</span> <span class=mi>9</span><span class=p>,</span> <span class=mi>10</span> <span class=p>};</span>
    <span class=n>List</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>&gt;</span> <span class=n>list1</span> <span class=o>=</span>
      <span class=k>new</span> <span class=n>ArrayList</span><span class=o>&lt;&gt;</span><span class=p>(</span><span class=n>Arrays</span><span class=p>.</span><span class=na>asList</span><span class=p>(</span><span class=n>ia</span><span class=p>));</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&quot;Before shuffling: &quot;</span> <span class=o>+</span> <span class=n>list1</span><span class=p>);</span>
    <span class=n>Collections</span><span class=p>.</span><span class=na>shuffle</span><span class=p>(</span><span class=n>list1</span><span class=p>,</span> <span class=n>rand</span><span class=p>);</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&quot;After shuffling: &quot;</span> <span class=o>+</span> <span class=n>list1</span><span class=p>);</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&quot;array: &quot;</span> <span class=o>+</span> <span class=n>Arrays</span><span class=p>.</span><span class=na>toString</span><span class=p>(</span><span class=n>ia</span><span class=p>));</span>

    <span class=n>List</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>&gt;</span> <span class=n>list2</span> <span class=o>=</span> <span class=n>Arrays</span><span class=p>.</span><span class=na>asList</span><span class=p>(</span><span class=n>ia</span><span class=p>);</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&quot;Before shuffling: &quot;</span> <span class=o>+</span> <span class=n>list2</span><span class=p>);</span>
    <span class=n>Collections</span><span class=p>.</span><span class=na>shuffle</span><span class=p>(</span><span class=n>list2</span><span class=p>,</span> <span class=n>rand</span><span class=p>);</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&quot;After shuffling: &quot;</span> <span class=o>+</span> <span class=n>list2</span><span class=p>);</span>
    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&quot;array: &quot;</span> <span class=o>+</span> <span class=n>Arrays</span><span class=p>.</span><span class=na>toString</span><span class=p>(</span><span class=n>ia</span><span class=p>));</span>
  <span class=p>}</span>
<span class=p>}</span>
<span class=cm>/* Output:</span>
<span class=cm>Before shuffling: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]</span>
<span class=cm>After shuffling: [4, 6, 3, 1, 8, 7, 2, 5, 10, 9]</span>
<span class=cm>array: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]</span>
<span class=cm>Before shuffling: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]</span>
<span class=cm>After shuffling: [9, 1, 6, 3, 7, 2, 5, 10, 4, 8]</span>
<span class=cm>array: [9, 1, 6, 3, 7, 2, 5, 10, 4, 8]</span>
<span class=cm>*/</span>
</code></pre></div> <p>在第一种情况下， <code>Arrays.asList()</code> 的输出被传递给了 <strong>ArrayList</strong> 的构造器，这将创建一个引用 <strong>ia</strong> 的元素的 <strong>ArrayList</strong> ，因此打乱这些引用不会修改该数组。但是，如果直接使用 <code>Arrays.asList(ia)</code> 的结果，这种打乱就会修改 <strong>ia</strong> 的顺序。重要的是要注意 <code>Arrays.asList()</code> 生成一个 <strong>List</strong> 对象，该对象使用底层数组作为其物理实现。如果执行的操作会修改这个 <strong>List</strong> ，并且不希望修改原始数组，那么就应该在另一个集合中创建一个副本。</p> <!-- Summary --> <h2 id=_8>本章小结<a class=headerlink href=#_8 title="Permanent link">#</a></h2> <p>Java 提供了许多保存对象的方法：</p> <ol> <li> <p>数组将数字索引与对象相关联。它保存类型明确的对象，因此在查找对象时不必对结果做类型转换。它可以是多维的，可以保存基本类型的数据。虽然可以在运行时创建数组，但是一旦创建数组，就无法更改数组的大小。</p> </li> <li> <p><strong>Collection</strong> 保存单一的元素，而 <strong>Map</strong> 包含相关联的键值对。使用 Java 泛型，可以指定集合中保存的对象的类型，因此不能将错误类型的对象放入集合中，并且在从集合中获取元素时，不必进行类型转换。各种 <strong>Collection</strong> 和各种 <strong>Map</strong> 都可以在你向其中添加更多的元素时，自动调整其尺寸大小。集合不能保存基本类型，但自动装箱机制会负责执行基本类型和集合中保存的包装类型之间的双向转换。</p> </li> <li> <p>像数组一样， <strong>List</strong> 也将数字索引与对象相关联，因此，数组和 <strong>List</strong> 都是有序集合。</p> </li> <li> <p>如果要执行大量的随机访问，则使用 <strong>ArrayList</strong> ，如果要经常从表中间插入或删除元素，则应该使用 <strong>LinkedList</strong> 。</p> </li> <li> <p>队列和堆栈的行为是通过 <strong>LinkedList</strong> 提供的。</p> </li> <li> <p><strong>Map</strong> 是一种将对象（而非数字）与对象相关联的设计。 <strong>HashMap</strong> 专为快速访问而设计，而 <strong>TreeMap</strong> 保持键始终处于排序状态，所以没有 <strong>HashMap</strong> 快。 <strong>LinkedHashMap</strong> 按插入顺序保存其元素，但使用散列提供快速访问的能力。</p> </li> <li> <p><strong>Set</strong> 不接受重复元素。 <strong>HashSet</strong> 提供最快的查询速度，而 <strong>TreeSet</strong> 保持元素处于排序状态。 <strong>LinkedHashSet</strong> 按插入顺序保存其元素，但使用散列提供快速访问的能力。</p> </li> <li> <p>不要在新代码中使用遗留类 <strong>Vector</strong> ，<strong>Hashtable</strong> 和 <strong>Stack</strong> 。</p> </li> </ol> <p>浏览一下Java集合的简图（不包含抽象类或遗留组件）会很有帮助。这里仅包括在一般情况下会碰到的接口和类。（译者注：下图为原著PDF中的截图，可能由于未知原因存在问题。这里可参考译者绘制版<sup id=fnref:8><a class=footnote-ref href=#fn:8>8</a></sup>）</p> <p><img alt="simple collection taxonomy" src=../../images/simple-collection-taxonomy.png></p> <h3 id=_9>简单集合分类<a class=headerlink href=#_9 title="Permanent link">#</a></h3> <p>可以看到，实际上只有四个基本的集合组件： <strong>Map</strong> ， <strong>List</strong> ， <strong>Set</strong> 和 <strong>Queue</strong> ，它们各有两到三个实现版本（<strong>Queue</strong> 的 <strong>java.util.concurrent</strong> 实现未包含在此图中）。最常使用的集合用黑色粗线线框表示。</p> <p>虚线框表示接口，实线框表示普通的（具体的）类。带有空心箭头的虚线表示特定的类实现了一个接口。实心箭头表示某个类可以生成箭头指向的类的对象。例如，任何 <strong>Collection</strong> 都可以生成 <strong>Iterator</strong> ， <strong>List</strong> 可以生成 <strong>ListIterator</strong> （也能生成普通的 <strong>Iterator</strong> ，因为 <strong>List</strong> 继承自 <strong>Collection</strong> ）。</p> <p>下面的示例展示了各种不同的类在方法上的差异。实际代码来自<a href>泛型</a>章节，在这里只是调用它来产生输出。程序的输出还展示了在每个类或接口中所实现的接口：</p> <div class=highlight><pre><span></span><code><span class=c1>// collections/CollectionDifferences.java</span>
<span class=kn>import</span> <span class=nn>onjava.*</span><span class=p>;</span>

<span class=kd>public</span> <span class=kd>class</span> <span class=nc>CollectionDifferences</span> <span class=p>{</span>
  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=p>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>CollectionMethodDifferences</span><span class=p>.</span><span class=na>main</span><span class=p>(</span><span class=n>args</span><span class=p>);</span>
  <span class=p>}</span>
<span class=p>}</span>
<span class=cm>/* Output:</span>
<span class=cm>Collection: [add, addAll, clear, contains, containsAll,</span>
<span class=cm>equals, forEach, hashCode, isEmpty, iterator,</span>
<span class=cm>parallelStream, remove, removeAll, removeIf, retainAll,</span>
<span class=cm>size, spliterator, stream, toArray]</span>
<span class=cm>Interfaces in Collection: [Iterable]</span>
<span class=cm>Set extends Collection, adds: []</span>
<span class=cm>Interfaces in Set: [Collection]</span>
<span class=cm>HashSet extends Set, adds: []</span>
<span class=cm>Interfaces in HashSet: [Set, Cloneable, Serializable]</span>
<span class=cm>LinkedHashSet extends HashSet, adds: []</span>
<span class=cm>Interfaces in LinkedHashSet: [Set, Cloneable,</span>
<span class=cm>Serializable]</span>
<span class=cm>TreeSet extends Set, adds: [headSet,</span>
<span class=cm>descendingIterator, descendingSet, pollLast, subSet,</span>
<span class=cm>floor, tailSet, ceiling, last, lower, comparator,</span>
<span class=cm>pollFirst, first, higher]</span>
<span class=cm>Interfaces in TreeSet: [NavigableSet, Cloneable,</span>
<span class=cm>Serializable]</span>
<span class=cm>List extends Collection, adds: [replaceAll, get,</span>
<span class=cm>indexOf, subList, set, sort, lastIndexOf, listIterator]</span>
<span class=cm>Interfaces in List: [Collection]</span>
<span class=cm>ArrayList extends List, adds: [trimToSize,</span>
<span class=cm>ensureCapacity]</span>
<span class=cm>Interfaces in ArrayList: [List, RandomAccess,</span>
<span class=cm>Cloneable, Serializable]</span>
<span class=cm>LinkedList extends List, adds: [offerFirst, poll,</span>
<span class=cm>getLast, offer, getFirst, removeFirst, element,</span>
<span class=cm>removeLastOccurrence, peekFirst, peekLast, push,</span>
<span class=cm>pollFirst, removeFirstOccurrence, descendingIterator,</span>
<span class=cm>pollLast, removeLast, pop, addLast, peek, offerLast,</span>
<span class=cm>addFirst]</span>
<span class=cm>Interfaces in LinkedList: [List, Deque, Cloneable,</span>
<span class=cm>Serializable]</span>
<span class=cm>Queue extends Collection, adds: [poll, peek, offer,</span>
<span class=cm>element]</span>
<span class=cm>Interfaces in Queue: [Collection]</span>
<span class=cm>PriorityQueue extends Queue, adds: [comparator]</span>
<span class=cm>Interfaces in PriorityQueue: [Serializable]</span>
<span class=cm>Map: [clear, compute, computeIfAbsent,</span>
<span class=cm>computeIfPresent, containsKey, containsValue, entrySet,</span>
<span class=cm>equals, forEach, get, getOrDefault, hashCode, isEmpty,</span>
<span class=cm>keySet, merge, put, putAll, putIfAbsent, remove,</span>
<span class=cm>replace, replaceAll, size, values]</span>
<span class=cm>HashMap extends Map, adds: []</span>
<span class=cm>Interfaces in HashMap: [Map, Cloneable, Serializable]</span>
<span class=cm>LinkedHashMap extends HashMap, adds: []</span>
<span class=cm>Interfaces in LinkedHashMap: [Map]</span>
<span class=cm>SortedMap extends Map, adds: [lastKey, subMap,</span>
<span class=cm>comparator, firstKey, headMap, tailMap]</span>
<span class=cm>Interfaces in SortedMap: [Map]</span>
<span class=cm>TreeMap extends Map, adds: [descendingKeySet,</span>
<span class=cm>navigableKeySet, higherEntry, higherKey, floorKey,</span>
<span class=cm>subMap, ceilingKey, pollLastEntry, firstKey, lowerKey,</span>
<span class=cm>headMap, tailMap, lowerEntry, ceilingEntry,</span>
<span class=cm>descendingMap, pollFirstEntry, lastKey, firstEntry,</span>
<span class=cm>floorEntry, comparator, lastEntry]</span>
<span class=cm>Interfaces in TreeMap: [NavigableMap, Cloneable,</span>
<span class=cm>Serializable]</span>
<span class=cm>*/</span>
</code></pre></div> <p>除 <strong>TreeSet</strong> 之外的所有 <strong>Set</strong> 都具有与 <strong>Collection</strong> 完全相同的接口。<strong>List</strong> 和 <strong>Collection</strong> 存在着明显的不同，尽管 <strong>List</strong> 所要求的方法都在 <strong>Collection</strong> 中。另一方面，在 <strong>Queue</strong> 接口中的方法是独立的，在创建具有 <strong>Queue</strong> 功能的实现时，不需要使用 <strong>Collection</strong> 方法。最后， <strong>Map</strong> 和 <strong>Collection</strong> 之间唯一的交集是 <strong>Map</strong> 可以使用 <code>entrySet()</code> 和 <code>values()</code> 方法来产生 <strong>Collection</strong> 。</p> <p>请注意，标记接口 <strong>java.util.RandomAccess</strong> 附加到了 <strong>ArrayList</strong> 上，但不附加到 <strong>LinkedList</strong> 上。这为根据特定 <strong>List</strong> 动态改变其行为的算法提供了信息。</p> <p>从面向对象的继承层次结构来看，这种组织结构确实有些奇怪。但是，当了解了 <strong>java.util</strong> 中更多的有关集合的内容后（特别是在<a href>附录：集合主题</a>中的内容），就会发现除了继承结构有点奇怪外，还有更多的问题。集合类库一直以来都是设计难题——解决这些问题涉及到要去满足经常彼此之间互为牵制的各方面需求。所以要做好准备，在各处做出妥协。</p> <p>尽管存在这些问题，但 Java 集合仍是在日常工作中使用的基本工具，它可以使程序更简洁、更强大、更有效。你可能需要一段时间才能熟悉集合类库的某些方面，但我想你很快就会找到自己的路子，来获得和使用这个类库中的类。</p> <!-- 分页 --> <div style="page-break-after: always;"></div> <div class=footnote> <hr> <ol> <li id=fn:1> <p>许多语言，例如 Perl ，Python 和 Ruby ，都有集合的本地支持。&#160;<a class=footnote-backref href=#fnref:1 title="Jump back to footnote 1 in the text">&#8617;</a></p> </li> <li id=fn:2> <p>这里是操作符重载的用武之地，C++和C#的集合类都使用操作符重载生成了更简洁的语法。&#160;<a class=footnote-backref href=#fnref:2 title="Jump back to footnote 2 in the text">&#8617;</a></p> </li> <li id=fn:3> <p>在<a href>泛型</a>章节的末尾，有个关于这个问题是否很严重的讨论。但是，<a href>泛型</a>章节还将展示Java泛型远不止是类型安全的集合这么简单。&#160;<a class=footnote-backref href=#fnref:3 title="Jump back to footnote 3 in the text">&#8617;</a></p> </li> <li id=fn:4> <p><code>remove()</code> 是一个所谓的“可选”方法（还有一些其它的这种方法），这意味着并非所有的 <strong>Iterator</strong> 实现都必须实现该方法。这个问题将在<a href>附录：集合主题</a>中介绍。但是，标准 Java 库集合实现了 <code>remove()</code> ，因此在<a href>附录：集合主题</a>章节之前，都不必担心这个问题。&#160;<a class=footnote-backref href=#fnref:4 title="Jump back to footnote 4 in the text">&#8617;</a></p> </li> <li id=fn:5> <p>这实际上依赖于具体实现。优先级队列算法通常会按插入顺序排序（维护一个<em>堆</em>），但它们也可以在删除时选择最重要的元素。 如果对象的优先级在它在队列中等待时可以修改，那么算法的选择就显得很重要了。&#160;<a class=footnote-backref href=#fnref:5 title="Jump back to footnote 5 in the text">&#8617;</a></p> </li> <li id=fn:6> <p>有些人提倡这样一种自动创建机制，即对一个类中所有可能的方法组合都自动创建一个接口，有时候对于单个的类都是如此。 我相信接口的意义不应该仅限于方法组合的机械地复制，因此我在创建接口之前，总是要先看到增加接口带来的价值。&#160;<a class=footnote-backref href=#fnref:6 title="Jump back to footnote 6 in the text">&#8617;</a></p> </li> <li id=fn:7> <p>这在 Java 5 之前是不可用的，因为该方法被认为与操作系统的耦合度过紧，因此违反“一次编写，处处运行”的原则。现在却提供它，这一事实表明， Java 的设计者们更加务实了。&#160;<a class=footnote-backref href=#fnref:7 title="Jump back to footnote 7 in the text">&#8617;</a></p> </li> <li id=fn:8> <p>下面是译者绘制的 Java 集合框架简图，黄色为接口，绿色为抽象类，蓝色为具体类。虚线箭头表示实现关系，实线箭头表示继承关系。 <img alt=collection src=../../images/collection.png> <img alt=map src=../../images/map.png>&#160;<a class=footnote-backref href=#fnref:8 title="Jump back to footnote 8 in the text">&#8617;</a></p> </li> </ol> </div> </article> </div> </div> </main> <footer class=md-footer> <div class=md-footer-nav> <nav class="md-footer-nav__inner md-grid"> <a href=../11-Inner-Classes/ title="11 Inner Classes" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel=prev> <div class="md-flex__cell md-flex__cell--shrink"> <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i> </div> <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"> <span class=md-flex__ellipsis> <span class=md-footer-nav__direction> 上一页 </span> 11 Inner Classes </span> </div> </a> <a href=../13-Functional-Programming/ title="13 Functional Programming" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel=next> <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"> <span class=md-flex__ellipsis> <span class=md-footer-nav__direction> 下一页 </span> 13 Functional Programming </span> </div> <div class="md-flex__cell md-flex__cell--shrink"> <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i> </div> </a> </nav> </div> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-copyright> powered by <a href=https://www.mkdocs.org target=_blank rel=noopener>MkDocs</a> and <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs</a> </div> <div class=md-footer-social> <link rel=stylesheet href=../../../../../assets/fonts/font-awesome.css> <a href=https://leay.net target=_blank rel=noopener title=home class="md-footer-social__link fa fa-home"></a> <a href=https://github.com/hqweay target=_blank rel=noopener title=github class="md-footer-social__link fa fa-github"></a> </div> </div> </div> </footer> </div> <script src=../../../../../assets/javascripts/application.c33a9706.js></script> <script src=../../../../../assets/javascripts/lunr/lunr.stemmer.support.js></script> <script src=../../../../../assets/javascripts/lunr/tinyseg.js></script> <script src=../../../../../assets/javascripts/lunr/lunr.ja.js></script> <script src=../../../../../assets/javascripts/lunr/lunr.multi.js></script> <script>app.initialize({version:"1.1",url:{base:"../../../../.."}})</script> </body> </html>