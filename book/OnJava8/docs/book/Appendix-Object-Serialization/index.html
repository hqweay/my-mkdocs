<!doctype html><html lang=zh class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=description content="Thinking Drafts"><link href=https://wiki.leay.net/book/OnJava8/docs/book/Appendix-Object-Serialization/ rel=canonical><meta name=author content=hqweay><meta name=lang:clipboard.copy content=复制><meta name=lang:clipboard.copied content=已复制><meta name=lang:search.language content="en, ja"><meta name=lang:search.pipeline.stopwords content=True><meta name=lang:search.pipeline.trimmer content=True><meta name=lang:search.result.none content=没有找到符合条件的结果><meta name=lang:search.result.one content="找到 1 个符合条件的结果"><meta name=lang:search.result.other content="# 个符合条件的结果"><meta name=lang:search.tokenizer content=[\uff0c\u3002]+><link rel="shortcut icon" href=../../../../../img/favicon.ico><meta name=generator content="mkdocs-1.1, mkdocs-material-4.6.3"><title>Appendix Object Serialization - Hqweay's Wiki</title><link rel=stylesheet href=../../../../../assets/stylesheets/application.adb8469c.css><link rel=stylesheet href=../../../../../assets/stylesheets/application-palette.a8b3c06d.css><meta name=theme-color content=#3f51b5><script src=../../../../../assets/javascripts/modernizr.86422ebf.js></script><link href=https://fonts.gstatic.com rel=preconnect crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Noto+Serif+SC:300,400,400i,700%7CRoboto+Mono&display=fallback"><style>body,input{font-family:"Noto Serif SC","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style><link rel=stylesheet href=../../../../../assets/fonts/material-icons.css><script>
  window.ga = window.ga || function() {
    (ga.q = ga.q || []).push(arguments)
  }
  ga.l = +new Date
  /* Setup integration and send page view */
  ga("create", "UA-105976066-3", "wiki.leay.net")
  ga("set", "anonymizeIp", true)
  ga("send", "pageview")
  /* Register handler to log search on blur */
  document.addEventListener("DOMContentLoaded", () => {
    if (document.forms.search) {
      var query = document.forms.search.query
      query.addEventListener("blur", function() {
        if (this.value) {
          var path = document.location.pathname;
          ga("send", "pageview", path + "?q=" + this.value)
        }
      })
    }
  })
</script><script async src=https://www.google-analytics.com/analytics.js></script></head> <body dir=ltr data-md-color-primary=indigo data-md-color-accent=indigo> <svg class=md-svg> <defs> <svg xmlns=http://www.w3.org/2000/svg width=416 height=448 viewbox="0 0 416 448" id=__github><path fill=currentColor d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg> </defs> </svg> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay data-md-component=overlay for=__drawer></label> <a href=#_1 tabindex=0 class=md-skip> 跳转至 </a> <header class=md-header data-md-component=header> <nav class="md-header-nav md-grid"> <div class=md-flex> <div class="md-flex__cell md-flex__cell--shrink"> <a href=https://wiki.leay.net/ title="Hqweay's Wiki" aria-label="Hqweay's Wiki" class="md-header-nav__button md-logo"> <i class=md-icon></i> </a> </div> <div class="md-flex__cell md-flex__cell--shrink"> <label class="md-icon md-icon--menu md-header-nav__button" for=__drawer></label> </div> <div class="md-flex__cell md-flex__cell--stretch"> <div class="md-flex__ellipsis md-header-nav__title" data-md-component=title> <span class=md-header-nav__topic> Hqweay's Wiki </span> <span class=md-header-nav__topic> Appendix Object Serialization </span> </div> </div> <div class="md-flex__cell md-flex__cell--shrink"> <label class="md-icon md-icon--search md-header-nav__button" for=__search></label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input aria-label=search name=query placeholder=搜索 autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=query data-md-state=active> <label class="md-icon md-search__icon" for=__search></label> <button type=reset class="md-icon md-search__icon" data-md-component=reset tabindex=-1> &#xE5CD; </button> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=result> <div class=md-search-result__meta> 键入以开始搜索 </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> </div> <div class="md-flex__cell md-flex__cell--shrink"> <div class=md-header-nav__source> <a href=https://github.com/hqweay/my-mkdocs/ title="前往 Github 仓库" class=md-source data-md-source=github> <div class=md-source__icon> <svg viewbox="0 0 24 24" width=24 height=24> <use xlink:href=#__github width=24 height=24></use> </svg> </div> <div class=md-source__repository> hqweay/my-mkdocs </div> </a> </div> </div> </div> </nav> </header> <div class=md-container> <nav class="md-tabs md-tabs--active" data-md-component=tabs> <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../../../../.. class=md-tabs__link> About </a> </li> <li class=md-tabs__item> <a href=../../../ class="md-tabs__link md-tabs__link--active"> Book </a> </li> <li class=md-tabs__item> <a href=../../../../../doc/ class=md-tabs__link> Doc </a> </li> <li class=md-tabs__item> <a href=../../../../../life/reading/ class=md-tabs__link> Life </a> </li> <li class=md-tabs__item> <a href=../../../../../study/draft/try-wiki/ class=md-tabs__link> Study </a> </li> <li class=md-tabs__item> <a href=../../../../../tech/code/frontend/2017-09-14-easy-web-test/ class=md-tabs__link> Tech </a> </li> </ul> </div> </nav> <main class=md-main role=main> <div class="md-main__inner md-grid" data-md-component=container> <div class="md-sidebar md-sidebar--primary" data-md-component=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" data-md-level=0> <label class="md-nav__title md-nav__title--site" for=__drawer> <a href=https://wiki.leay.net/ title="Hqweay's Wiki" class="md-nav__button md-logo"> <i class=md-icon></i> </a> Hqweay's Wiki </label> <div class=md-nav__source> <a href=https://github.com/hqweay/my-mkdocs/ title="前往 Github 仓库" class=md-source data-md-source=github> <div class=md-source__icon> <svg viewbox="0 0 24 24" width=24 height=24> <use xlink:href=#__github width=24 height=24></use> </svg> </div> <div class=md-source__repository> hqweay/my-mkdocs </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../.. title=About class=md-nav__link> About </a> </li> <li class=md-nav__item> <a href=../../../../../test/ title=特殊语法 class=md-nav__link> 特殊语法 </a> </li> <li class=md-nav__item> <a href=../../../../../web-page/ title=静态文档导航 class=md-nav__link> 静态文档导航 </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-4 type=checkbox id=nav-4 checked> <label class=md-nav__link for=nav-4> Book </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-4> Book </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-4-1 type=checkbox id=nav-4-1 checked> <label class=md-nav__link for=nav-4-1> OnJava8 </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-4-1> OnJava8 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../ title="《On Java 8》中文版" class=md-nav__link> 《On Java 8》中文版 </a> </li> <li class=md-nav__item> <a href=../../../CONTRIBUTING/ title=CONTRIBUTING class=md-nav__link> CONTRIBUTING </a> </li> <li class=md-nav__item> <a href=../../../SUMMARY/ title=Summary class=md-nav__link> Summary </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-4-1-4 type=checkbox id=nav-4-1-4 checked> <label class=md-nav__link for=nav-4-1-4> Docs </label> <nav class=md-nav data-md-component=collapsible data-md-level=3> <label class=md-nav__title for=nav-4-1-4> Docs </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../ title=译者的话 class=md-nav__link> 译者的话 </a> </li> <li class=md-nav__item> <a href=../../_coverpage/ title=coverpage class=md-nav__link> coverpage </a> </li> <li class=md-nav__item> <a href=../../sidebar/ title=Sidebar class=md-nav__link> Sidebar </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-4-1-4-4 type=checkbox id=nav-4-1-4-4> <label class=md-nav__link for=nav-4-1-4-4> style </label> <nav class=md-nav data-md-component=collapsible data-md-level=4> <label class=md-nav__title for=nav-4-1-4-4> style </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-4-1-4-4-1 type=checkbox id=nav-4-1-4-4-1> <label class=md-nav__link for=nav-4-1-4-4-1> Prism master </label> <nav class=md-nav data-md-component=collapsible data-md-level=5> <label class=md-nav__title for=nav-4-1-4-4-1> Prism master </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../_style/prism-master/ title=[Prism](http://prismjs.com/) class=md-nav__link> [Prism](http://prismjs.com/) </a> </li> <li class=md-nav__item> <a href=../../_style/prism-master/CHANGELOG/ title="Prism Changelog" class=md-nav__link> Prism Changelog </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-4-1-4-5 type=checkbox id=nav-4-1-4-5 checked> <label class=md-nav__link for=nav-4-1-4-5> Book </label> <nav class=md-nav data-md-component=collapsible data-md-level=4> <label class=md-nav__title for=nav-4-1-4-5> Book </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../00-Introduction/ title=简介 class=md-nav__link> 简介 </a> </li> <li class=md-nav__item> <a href=../00-On-Java-8/ title="00 On Java 8" class=md-nav__link> 00 On Java 8 </a> </li> <li class=md-nav__item> <a href=../00-Preface/ title=前言 class=md-nav__link> 前言 </a> </li> <li class=md-nav__item> <a href=../01-What-is-an-Object/ title="第一章 对象的概念" class=md-nav__link> 第一章 对象的概念 </a> </li> <li class=md-nav__item> <a href=../02-Installing-Java-and-the-Book-Examples/ title="02 Installing Java and the Book Examples" class=md-nav__link> 02 Installing Java and the Book Examples </a> </li> <li class=md-nav__item> <a href=../03-Objects-Everywhere/ title="03 Objects Everywhere" class=md-nav__link> 03 Objects Everywhere </a> </li> <li class=md-nav__item> <a href=../04-Operators/ title="04 Operators" class=md-nav__link> 04 Operators </a> </li> <li class=md-nav__item> <a href=../05-Control-Flow/ title="05 Control Flow" class=md-nav__link> 05 Control Flow </a> </li> <li class=md-nav__item> <a href=../06-Housekeeping/ title="06 Housekeeping" class=md-nav__link> 06 Housekeeping </a> </li> <li class=md-nav__item> <a href=../07-Implementation-Hiding/ title="07 Implementation Hiding" class=md-nav__link> 07 Implementation Hiding </a> </li> <li class=md-nav__item> <a href=../08-Reuse/ title="08 Reuse" class=md-nav__link> 08 Reuse </a> </li> <li class=md-nav__item> <a href=../09-Polymorphism/ title="09 Polymorphism" class=md-nav__link> 09 Polymorphism </a> </li> <li class=md-nav__item> <a href=../10-Interfaces/ title="10 Interfaces" class=md-nav__link> 10 Interfaces </a> </li> <li class=md-nav__item> <a href=../11-Inner-Classes/ title="11 Inner Classes" class=md-nav__link> 11 Inner Classes </a> </li> <li class=md-nav__item> <a href=../12-Collections/ title="12 Collections" class=md-nav__link> 12 Collections </a> </li> <li class=md-nav__item> <a href=../13-Functional-Programming/ title="13 Functional Programming" class=md-nav__link> 13 Functional Programming </a> </li> <li class=md-nav__item> <a href=../14-Streams/ title="14 Streams" class=md-nav__link> 14 Streams </a> </li> <li class=md-nav__item> <a href=../15-Exceptions/ title="15 Exceptions" class=md-nav__link> 15 Exceptions </a> </li> <li class=md-nav__item> <a href=../16-Validating-Your-Code/ title="16 Validating Your Code" class=md-nav__link> 16 Validating Your Code </a> </li> <li class=md-nav__item> <a href=../17-Files/ title="17 Files" class=md-nav__link> 17 Files </a> </li> <li class=md-nav__item> <a href=../18-Strings/ title="18 Strings" class=md-nav__link> 18 Strings </a> </li> <li class=md-nav__item> <a href=../19-Type-Information/ title="19 Type Information" class=md-nav__link> 19 Type Information </a> </li> <li class=md-nav__item> <a href=../20-Generics/ title="20 Generics" class=md-nav__link> 20 Generics </a> </li> <li class=md-nav__item> <a href=../21-Arrays/ title="21 Arrays" class=md-nav__link> 21 Arrays </a> </li> <li class=md-nav__item> <a href=../22-Enumerations/ title="22 Enumerations" class=md-nav__link> 22 Enumerations </a> </li> <li class=md-nav__item> <a href=../23-Annotations/ title="23 Annotations" class=md-nav__link> 23 Annotations </a> </li> <li class=md-nav__item> <a href=../24-Concurrent-Programming/ title="24 Concurrent Programming" class=md-nav__link> 24 Concurrent Programming </a> </li> <li class=md-nav__item> <a href=../25-Patterns/ title="25 Patterns" class=md-nav__link> 25 Patterns </a> </li> <li class=md-nav__item> <a href=../Appendix-Becoming-a-Programmer/ title="Appendix Becoming a Programmer" class=md-nav__link> Appendix Becoming a Programmer </a> </li> <li class=md-nav__item> <a href=../Appendix-Benefits-and-Costs-of-Static-Type-Checking/ title="Appendix Benefits and Costs of Static Type Checking" class=md-nav__link> Appendix Benefits and Costs of Static Type Checking </a> </li> <li class=md-nav__item> <a href=../Appendix-Collection-Topics/ title="Appendix Collection Topics" class=md-nav__link> Appendix Collection Topics </a> </li> <li class=md-nav__item> <a href=../Appendix-Data-Compression/ title="Appendix Data Compression" class=md-nav__link> Appendix Data Compression </a> </li> <li class=md-nav__item> <a href=../Appendix-IO-Streams/ title="Appendix IO Streams" class=md-nav__link> Appendix IO Streams </a> </li> <li class=md-nav__item> <a href=../Appendix-Javadoc/ title="Appendix Javadoc" class=md-nav__link> Appendix Javadoc </a> </li> <li class=md-nav__item> <a href=../Appendix-Low-Level-Concurrency/ title="Appendix Low Level Concurrency" class=md-nav__link> Appendix Low Level Concurrency </a> </li> <li class=md-nav__item> <a href=../Appendix-New-IO/ title="Appendix New IO" class=md-nav__link> Appendix New IO </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-toggle md-nav__toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> Appendix Object Serialization </label> <a href=./ title="Appendix Object Serialization" class="md-nav__link md-nav__link--active"> Appendix Object Serialization </a> <nav class="md-nav md-nav--secondary"> <label class=md-nav__title for=__toc>目录</label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=#_2 class=md-nav__link> 查找类 </a> </li> <li class=md-nav__item> <a href=#_3 class=md-nav__link> 控制序列化 </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#transient class=md-nav__link> transient 关键字 </a> </li> <li class=md-nav__item> <a href=#externalizable class=md-nav__link> Externalizable 的替代方法 </a> </li> <li class=md-nav__item> <a href=#_4 class=md-nav__link> 版本控制 </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_5 class=md-nav__link> 使用持久化 </a> </li> <li class=md-nav__item> <a href=#xml class=md-nav__link> XML </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../Appendix-Passing-and-Returning-Objects/ title="Appendix Passing and Returning Objects" class=md-nav__link> Appendix Passing and Returning Objects </a> </li> <li class=md-nav__item> <a href=../Appendix-Programming-Guidelines/ title="Appendix Programming Guidelines" class=md-nav__link> Appendix Programming Guidelines </a> </li> <li class=md-nav__item> <a href=../Appendix-Standard-IO/ title="Appendix Standard IO" class=md-nav__link> Appendix Standard IO </a> </li> <li class=md-nav__item> <a href=../Appendix-Supplements/ title="Appendix Supplements" class=md-nav__link> Appendix Supplements </a> </li> <li class=md-nav__item> <a href=../Appendix-The-Positive-Legacy-of-C-plus-plus-and-Java/ title="Appendix The Positive Legacy of C plus plus and Java" class=md-nav__link> Appendix The Positive Legacy of C plus plus and Java </a> </li> <li class=md-nav__item> <a href=../Appendix-Understanding-equals-and-hashCode/ title="Appendix Understanding equals and hashCode" class=md-nav__link> Appendix Understanding equals and hashCode </a> </li> <li class=md-nav__item> <a href=../GLOSSARY/ title=GLOSSARY class=md-nav__link> GLOSSARY </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-5 type=checkbox id=nav-5> <label class=md-nav__link for=nav-5> Doc </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-5> Doc </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../doc/ title=About class=md-nav__link> About </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-5-2 type=checkbox id=nav-5-2> <label class=md-nav__link for=nav-5-2> English </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-5-2> English </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-5-2-1 type=checkbox id=nav-5-2-1> <label class=md-nav__link for=nav-5-2-1> A Programmers Guide to English </label> <nav class=md-nav data-md-component=collapsible data-md-level=3> <label class=md-nav__title for=nav-5-2-1> A Programmers Guide to English </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../doc/english/A-Programmers-Guide-to-English/ title="A Programmer's Guide to English" class=md-nav__link> A Programmer's Guide to English </a> </li> <li class=md-nav__item> <a href=../../../../../doc/english/A-Programmers-Guide-to-English/SUMMARY/ title=Summary class=md-nav__link> Summary </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-5-2-1-3 type=checkbox id=nav-5-2-1-3> <label class=md-nav__link for=nav-5-2-1-3> Essence </label> <nav class=md-nav data-md-component=collapsible data-md-level=4> <label class=md-nav__title for=nav-5-2-1-3> Essence </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../doc/english/A-Programmers-Guide-to-English/essence/ title=语言学习的本质浅析 class=md-nav__link> 语言学习的本质浅析 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-5-2-1-4 type=checkbox id=nav-5-2-1-4> <label class=md-nav__link for=nav-5-2-1-4> Make a program </label> <nav class=md-nav data-md-component=collapsible data-md-level=4> <label class=md-nav__title for=nav-5-2-1-4> Make a program </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../doc/english/A-Programmers-Guide-to-English/make-a-program/ title=如何构建一个识别英语的程序 class=md-nav__link> 如何构建一个识别英语的程序 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-5-2-1-5 type=checkbox id=nav-5-2-1-5> <label class=md-nav__link for=nav-5-2-1-5> Qa </label> <nav class=md-nav data-md-component=collapsible data-md-level=4> <label class=md-nav__title for=nav-5-2-1-5> Qa </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../doc/english/A-Programmers-Guide-to-English/qa/ title="常见问题 QA" class=md-nav__link> 常见问题 QA </a> </li> <li class=md-nav__item> <a href=../../../../../doc/english/A-Programmers-Guide-to-English/qa/WhyPTE/ title="为什么我选择 PTE 考试" class=md-nav__link> 为什么我选择 PTE 考试 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-5-2-1-6 type=checkbox id=nav-5-2-1-6> <label class=md-nav__link for=nav-5-2-1-6> Resources </label> <nav class=md-nav data-md-component=collapsible data-md-level=4> <label class=md-nav__title for=nav-5-2-1-6> Resources </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../doc/english/A-Programmers-Guide-to-English/resources/ title=资料、工具推荐和扩展阅读 class=md-nav__link> 资料、工具推荐和扩展阅读 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-5-2-1-7 type=checkbox id=nav-5-2-1-7> <label class=md-nav__link for=nav-5-2-1-7> Training </label> <nav class=md-nav data-md-component=collapsible data-md-level=4> <label class=md-nav__title for=nav-5-2-1-7> Training </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../doc/english/A-Programmers-Guide-to-English/training/ title=我的训练方法 class=md-nav__link> 我的训练方法 </a> </li> <li class=md-nav__item> <a href=../../../../../doc/english/A-Programmers-Guide-to-English/training/KnowledgeBase/ title=扩充语料库的训练方法 class=md-nav__link> 扩充语料库的训练方法 </a> </li> <li class=md-nav__item> <a href=../../../../../doc/english/A-Programmers-Guide-to-English/training/ListeningandSpeaking/ title=发音和听力训练方法 class=md-nav__link> 发音和听力训练方法 </a> </li> <li class=md-nav__item> <a href=../../../../../doc/english/A-Programmers-Guide-to-English/training/Thinking/ title=英语思维训练 class=md-nav__link> 英语思维训练 </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-5-2-2 type=checkbox id=nav-5-2-2> <label class=md-nav__link for=nav-5-2-2> English level up tips for Chinese </label> <nav class=md-nav data-md-component=collapsible data-md-level=3> <label class=md-nav__title for=nav-5-2-2> English level up tips for Chinese </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../doc/english/English-level-up-tips-for-Chinese/ title=English-level-up-tips-for-Chinese class=md-nav__link> English-level-up-tips-for-Chinese </a> </li> <li class=md-nav__item> <a href=../../../../../doc/english/English-level-up-tips-for-Chinese/SUMMARY/ title=Summary class=md-nav__link> Summary </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-5-2-2-3 type=checkbox id=nav-5-2-2-3> <label class=md-nav__link for=nav-5-2-2-3> Part 1 </label> <nav class=md-nav data-md-component=collapsible data-md-level=4> <label class=md-nav__title for=nav-5-2-2-3> Part 1 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../doc/english/English-level-up-tips-for-Chinese/part-1/1-understanding/ title=认知篇 class=md-nav__link> 认知篇 </a> </li> <li class=md-nav__item> <a href=../../../../../doc/english/English-level-up-tips-for-Chinese/part-1/2-vocabulary/ title=单词篇 class=md-nav__link> 单词篇 </a> </li> <li class=md-nav__item> <a href=../../../../../doc/english/English-level-up-tips-for-Chinese/part-1/3-listening/ title=听力篇 class=md-nav__link> 听力篇 </a> </li> <li class=md-nav__item> <a href=../../../../../doc/english/English-level-up-tips-for-Chinese/part-1/4-reading/ title=阅读篇 class=md-nav__link> 阅读篇 </a> </li> <li class=md-nav__item> <a href=../../../../../doc/english/English-level-up-tips-for-Chinese/part-1/5-speaking/ title="5 speaking" class=md-nav__link> 5 speaking </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-5-2-2-4 type=checkbox id=nav-5-2-2-4> <label class=md-nav__link for=nav-5-2-2-4> Part 2 </label> <nav class=md-nav data-md-component=collapsible data-md-level=4> <label class=md-nav__title for=nav-5-2-2-4> Part 2 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../doc/english/English-level-up-tips-for-Chinese/part-2/x-misc/ title=扯淡篇 class=md-nav__link> 扯淡篇 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-5-2-2-5 type=checkbox id=nav-5-2-2-5> <label class=md-nav__link for=nav-5-2-2-5> Word list </label> <nav class=md-nav data-md-component=collapsible data-md-level=4> <label class=md-nav__title for=nav-5-2-2-5> Word list </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../doc/english/English-level-up-tips-for-Chinese/word-list/Go/ title=Go class=md-nav__link> Go </a> </li> <li class=md-nav__item> <a href=../../../../../doc/english/English-level-up-tips-for-Chinese/word-list/Java/ title=Java class=md-nav__link> Java </a> </li> <li class=md-nav__item> <a href=../../../../../doc/english/English-level-up-tips-for-Chinese/word-list/JavaScript/ title=JavaScript class=md-nav__link> JavaScript </a> </li> <li class=md-nav__item> <a href=../../../../../doc/english/English-level-up-tips-for-Chinese/word-list/PHP/ title=PHP class=md-nav__link> PHP </a> </li> <li class=md-nav__item> <a href=../../../../../doc/english/English-level-up-tips-for-Chinese/word-list/Python/ title=Python class=md-nav__link> Python </a> </li> <li class=md-nav__item> <a href=../../../../../doc/english/English-level-up-tips-for-Chinese/word-list/Swift/ title=Swift class=md-nav__link> Swift </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-5-2-3 type=checkbox id=nav-5-2-3> <label class=md-nav__link for=nav-5-2-3> Everyone can use english </label> <nav class=md-nav data-md-component=collapsible data-md-level=3> <label class=md-nav__title for=nav-5-2-3> Everyone can use english </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../doc/english/everyone-can-use-english/ title=人人都能用英语 class=md-nav__link> 人人都能用英语 </a> </li> <li class=md-nav__item> <a href=../../../../../doc/english/everyone-can-use-english/chapter1/ title="第一章 起点" class=md-nav__link> 第一章 起点 </a> </li> <li class=md-nav__item> <a href=../../../../../doc/english/everyone-can-use-english/chapter2/ title="第二章 口语" class=md-nav__link> 第二章 口语 </a> </li> <li class=md-nav__item> <a href=../../../../../doc/english/everyone-can-use-english/chapter3/ title="第三章 语音" class=md-nav__link> 第三章 语音 </a> </li> <li class=md-nav__item> <a href=../../../../../doc/english/everyone-can-use-english/chapter4/ title="第四章 朗读" class=md-nav__link> 第四章 朗读 </a> </li> <li class=md-nav__item> <a href=../../../../../doc/english/everyone-can-use-english/chapter5/ title="第五章 词典" class=md-nav__link> 第五章 词典 </a> </li> <li class=md-nav__item> <a href=../../../../../doc/english/everyone-can-use-english/chapter6/ title="第六章 语法" class=md-nav__link> 第六章 语法 </a> </li> <li class=md-nav__item> <a href=../../../../../doc/english/everyone-can-use-english/chapter7/ title="第七章 精读" class=md-nav__link> 第七章 精读 </a> </li> <li class=md-nav__item> <a href=../../../../../doc/english/everyone-can-use-english/chapter8/ title="第八章 叮嘱" class=md-nav__link> 第八章 叮嘱 </a> </li> <li class=md-nav__item> <a href=../../../../../doc/english/everyone-can-use-english/end/ title=后记 class=md-nav__link> 后记 </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-5-3 type=checkbox id=nav-5-3> <label class=md-nav__link for=nav-5-3> Writing </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-5-3> Writing </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-5-3-1 type=checkbox id=nav-5-3-1> <label class=md-nav__link for=nav-5-3-1> Chinese copywriting guidelines </label> <nav class=md-nav data-md-component=collapsible data-md-level=3> <label class=md-nav__title for=nav-5-3-1> Chinese copywriting guidelines </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../doc/writing/chinese-copywriting-guidelines/ title=中文文案排版指北 class=md-nav__link> 中文文案排版指北 </a> </li> <li class=md-nav__item> <a href=../../../../../doc/writing/chinese-copywriting-guidelines/CHANGELOG/ title=CHANGELOG class=md-nav__link> CHANGELOG </a> </li> <li class=md-nav__item> <a href=../../../../../doc/writing/chinese-copywriting-guidelines/README.en-US/ title="Chinese Copywriting Guidelines" class=md-nav__link> Chinese Copywriting Guidelines </a> </li> <li class=md-nav__item> <a href=../../../../../doc/writing/chinese-copywriting-guidelines/README.zh-CN/ title=中文文案排版指北 class=md-nav__link> 中文文案排版指北 </a> </li> <li class=md-nav__item> <a href=../../../../../doc/writing/chinese-copywriting-guidelines/README.zh-HK/ title=中文文案排版指北 class=md-nav__link> 中文文案排版指北 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-5-3-2 type=checkbox id=nav-5-3-2> <label class=md-nav__link for=nav-5-3-2> Document style guide </label> <nav class=md-nav data-md-component=collapsible data-md-level=3> <label class=md-nav__title for=nav-5-3-2> Document style guide </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../doc/writing/document-style-guide/ title=Index class=md-nav__link> Index </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-5-3-2-2 type=checkbox id=nav-5-3-2-2> <label class=md-nav__link for=nav-5-3-2-2> Docs </label> <nav class=md-nav data-md-component=collapsible data-md-level=4> <label class=md-nav__title for=nav-5-3-2-2> Docs </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../doc/writing/document-style-guide/docs/marks/ title=标点符号 class=md-nav__link> 标点符号 </a> </li> <li class=md-nav__item> <a href=../../../../../doc/writing/document-style-guide/docs/number/ title=数值 class=md-nav__link> 数值 </a> </li> <li class=md-nav__item> <a href=../../../../../doc/writing/document-style-guide/docs/paragraph/ title=段落 class=md-nav__link> 段落 </a> </li> <li class=md-nav__item> <a href=../../../../../doc/writing/document-style-guide/docs/reference/ title=参考链接 class=md-nav__link> 参考链接 </a> </li> <li class=md-nav__item> <a href=../../../../../doc/writing/document-style-guide/docs/structure/ title=文档体系 class=md-nav__link> 文档体系 </a> </li> <li class=md-nav__item> <a href=../../../../../doc/writing/document-style-guide/docs/text/ title=文本 class=md-nav__link> 文本 </a> </li> <li class=md-nav__item> <a href=../../../../../doc/writing/document-style-guide/docs/title/ title=标题 class=md-nav__link> 标题 </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-6 type=checkbox id=nav-6> <label class=md-nav__link for=nav-6> Life </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-6> Life </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-6-1 type=checkbox id=nav-6-1> <label class=md-nav__link for=nav-6-1> Reading </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-6-1> Reading </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../life/reading/ title=阅读 class=md-nav__link> 阅读 </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-6-1-2 type=checkbox id=nav-6-1-2> <label class=md-nav__link for=nav-6-1-2> Mark </label> <nav class=md-nav data-md-component=collapsible data-md-level=3> <label class=md-nav__title for=nav-6-1-2> Mark </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../life/reading/mark/back-up/ title="2019 暑假备份" class=md-nav__link> 2019 暑假备份 </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/mark/back/ title=例行收集 class=md-nav__link> 例行收集 </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/mark/efficiency-time/ title=效率、时间、鸡汤 class=md-nav__link> 效率、时间、鸡汤 </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/mark/fiction/ title=小说 class=md-nav__link> 小说 </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/mark/films-remark/ title=影评、电影 class=md-nav__link> 影评、电影 </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/mark/fo/ title=佛 class=md-nav__link> 佛 </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/mark/hackers-others/ title=互联网、思维方式 class=md-nav__link> 互联网、思维方式 </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/mark/hooked-media/ title=媒介反思 class=md-nav__link> 媒介反思 </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/mark/isaka-kotaro/ title=伊坂幸太郎 class=md-nav__link> 伊坂幸太郎 </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/mark/knote/ title=整理 class=md-nav__link> 整理 </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/mark/mark-knote/ title=浪费时间 class=md-nav__link> 浪费时间 </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/mark/meaning/ title=思维方式 class=md-nav__link> 思维方式 </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/mark/morimi-tomihiko/ title=森见登美彦的文字好有趣啊! class=md-nav__link> 森见登美彦的文字好有趣啊! </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/mark/murakamo-haruki/ title=村上春树 class=md-nav__link> 村上春树 </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/mark/no-fiction/ title=非虚构类 class=md-nav__link> 非虚构类 </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/mark/paper/ title=论文式总结 class=md-nav__link> 论文式总结 </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/mark/poem/ title=诗歌 class=md-nav__link> 诗歌 </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/mark/sence/ title=哲学相关通俗读物 class=md-nav__link> 哲学相关通俗读物 </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/mark/the-little-prince/ title="The Little Prince" class=md-nav__link> The Little Prince </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/mark/universe/ title=物理科普读物 class=md-nav__link> 物理科普读物 </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/mark/utopia/ title=乌托邦小说世界关于书籍的冷幽默 class=md-nav__link> 乌托邦小说世界关于书籍的冷幽默 </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/mark/western-politics/ title=政哲 class=md-nav__link> 政哲 </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/mark/what-we-talk-about/ title=日本文学 class=md-nav__link> 日本文学 </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/mark/wuxia/ title=武侠 class=md-nav__link> 武侠 </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/mark/xiao-bo/ title=王小波 class=md-nav__link> 王小波 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-6-1-3 type=checkbox id=nav-6-1-3> <label class=md-nav__link for=nav-6-1-3> Note </label> <nav class=md-nav data-md-component=collapsible data-md-level=3> <label class=md-nav__title for=nav-6-1-3> Note </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../life/reading/note/2017-09-02-book-JavaScript-DOM/ title="《JavaScript DOM 编程艺术》" class=md-nav__link> 《JavaScript DOM 编程艺术》 </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/note/2017-09-09-coding-javascript-down/ title="尽量把 JavaScript 代码放到 HTML 网页底部" class=md-nav__link> 尽量把 JavaScript 代码放到 HTML 网页底部 </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/note/2018-05-23-HTTP/ title="《HTTP 图解》" class=md-nav__link> 《HTTP 图解》 </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/note/2018-06-07-computer/ title=计算机系统基础 class=md-nav__link> 计算机系统基础 </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/note/2018-10-09-JVM/ title="JVM 笔记" class=md-nav__link> JVM 笔记 </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/note/2018-11-25-computer/ title=计算机系统概论 class=md-nav__link> 计算机系统概论 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-6-1-4 type=checkbox id=nav-6-1-4> <label class=md-nav__link for=nav-6-1-4> Review </label> <nav class=md-nav data-md-component=collapsible data-md-level=3> <label class=md-nav__title for=nav-6-1-4> Review </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../life/reading/review/2017-09-28-say-something/ title=听你吹牛的闲暇时光 class=md-nav__link> 听你吹牛的闲暇时光 </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/review/2017-09-29-wuxia/ title="《流星 蝴蝶 剑》简记" class=md-nav__link> 《流星 蝴蝶 剑》简记 </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/review/2017-12-30-xiao-bo/ title=波波老师 class=md-nav__link> 波波老师 </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/review/2018-01-17-lai-zi-xin-shi-jie/ title=《来自新世界》 class=md-nav__link> 《来自新世界》 </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/review/2018-10-06-October/ title=科普谈起 class=md-nav__link> 科普谈起 </a> </li> <li class=md-nav__item> <a href=../../../../../life/reading/review/2019-09-07-story/ title=从网络小说谈起。 class=md-nav__link> 从网络小说谈起。 </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-6-2 type=checkbox id=nav-6-2> <label class=md-nav__link for=nav-6-2> Watching </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-6-2> Watching </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../life/watching/2017-08-29-watch-movies-rencently/ title=最近看的几部电影 class=md-nav__link> 最近看的几部电影 </a> </li> <li class=md-nav__item> <a href=../../../../../life/watching/2017-10-13-september-movies-record/ title=九月观影记录 class=md-nav__link> 九月观影记录 </a> </li> <li class=md-nav__item> <a href=../../../../../life/watching/2017-11-01-October-summary/ title=十月看片与非专业类阅读 class=md-nav__link> 十月看片与非专业类阅读 </a> </li> <li class=md-nav__item> <a href=../../../../../life/watching/2017-12-01-1112/ title=观影与阅读记录 class=md-nav__link> 观影与阅读记录 </a> </li> <li class=md-nav__item> <a href=../../../../../life/watching/2018-01-10-12/ title=最近看片与阅读 class=md-nav__link> 最近看片与阅读 </a> </li> <li class=md-nav__item> <a href=../../../../../life/watching/2018-02-06-january/ title=一月观影记录 class=md-nav__link> 一月观影记录 </a> </li> <li class=md-nav__item> <a href=../../../../../life/watching/2018-03-08-February/ title=二月至今观影记录 class=md-nav__link> 二月至今观影记录 </a> </li> <li class=md-nav__item> <a href=../../../../../life/watching/2018-03-31-March/ title=三月观影记录 class=md-nav__link> 三月观影记录 </a> </li> <li class=md-nav__item> <a href=../../../../../life/watching/2018-12-26-Smultronst%C3%A4llet/ title=野草莓 class=md-nav__link> 野草莓 </a> </li> <li class=md-nav__item> <a href=../../../../../life/watching/2019-10-10-October/ title=克服本能就是善良吗？（从十月新番胡扯……） class=md-nav__link> 克服本能就是善良吗？（从十月新番胡扯……） </a> </li> <li class=md-nav__item> <a href=../../../../../life/watching/2019-11-04-bgm/ title=无人声环 class=md-nav__link> 无人声环 </a> </li> <li class=md-nav__item> <a href=../../../../../life/watching/2019-11-13-the-end-of-the-world/ title="The End of the Fucking World" class=md-nav__link> The End of the Fucking World </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-7 type=checkbox id=nav-7> <label class=md-nav__link for=nav-7> Study </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-7> Study </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-7-1 type=checkbox id=nav-7-1> <label class=md-nav__link for=nav-7-1> Draft </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-7-1> Draft </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../study/draft/try-wiki/ title="一些 Wiki 工具的尝试" class=md-nav__link> 一些 Wiki 工具的尝试 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-7-2 type=checkbox id=nav-7-2> <label class=md-nav__link for=nav-7-2> Language </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-7-2> Language </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../study/language/%E6%97%A5%E8%AF%AD%E5%85%A5%E9%97%A8/ title=日语入门 class=md-nav__link> 日语入门 </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-8 type=checkbox id=nav-8> <label class=md-nav__link for=nav-8> Tech </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-8> Tech </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-8-1 type=checkbox id=nav-8-1> <label class=md-nav__link for=nav-8-1> Code </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-8-1> Code </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-8-1-1 type=checkbox id=nav-8-1-1> <label class=md-nav__link for=nav-8-1-1> Frontend </label> <nav class=md-nav data-md-component=collapsible data-md-level=3> <label class=md-nav__title for=nav-8-1-1> Frontend </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../tech/code/frontend/2017-09-14-easy-web-test/ title=大表哥的电商网页实战体验 class=md-nav__link> 大表哥的电商网页实战体验 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/code/frontend/2017-09-23-know-nothing/ title=知其然不知其所以然 class=md-nav__link> 知其然不知其所以然 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/code/frontend/2018-06-08-responsive/ title=大表哥的响应式设计 class=md-nav__link> 大表哥的响应式设计 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/code/frontend/zh-javascript-info/ title="现代 JavaScript 教程摘录" class=md-nav__link> 现代 JavaScript 教程摘录 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-8-1-2 type=checkbox id=nav-8-1-2> <label class=md-nav__link for=nav-8-1-2> Go </label> <nav class=md-nav data-md-component=collapsible data-md-level=3> <label class=md-nav__title for=nav-8-1-2> Go </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../tech/code/go/01/ title=01 class=md-nav__link> 01 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-8-1-3 type=checkbox id=nav-8-1-3> <label class=md-nav__link for=nav-8-1-3> Java </label> <nav class=md-nav data-md-component=collapsible data-md-level=3> <label class=md-nav__title for=nav-8-1-3> Java </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../tech/code/java/2017-12-30-Java%20Web/ title="从 url 访问服务器资源讨论 Java Web 中的 Servlet" class=md-nav__link> 从 url 访问服务器资源讨论 Java Web 中的 Servlet </a> </li> <li class=md-nav__item> <a href=../../../../../tech/code/java/2018-11-23-ArrayList/ title=ArrayList class=md-nav__link> ArrayList </a> </li> <li class=md-nav__item> <a href=../../../../../tech/code/java/2019-01-31-HashMap/ title=HashMap class=md-nav__link> HashMap </a> </li> <li class=md-nav__item> <a href=../../../../../tech/code/java/2019-02-01-String/ title="String 分析(栈,堆,字符串常量池)" class=md-nav__link> String 分析(栈,堆,字符串常量池) </a> </li> <li class=md-nav__item> <a href=../../../../../tech/code/java/2019-02-03-String/ title=String、StringBuffer、StingBuilder class=md-nav__link> String、StringBuffer、StingBuilder </a> </li> <li class=md-nav__item> <a href=../../../../../tech/code/java/2019-02-06-Hashtable/ title=Hashtable class=md-nav__link> Hashtable </a> </li> <li class=md-nav__item> <a href=../../../../../tech/code/java/2019-03-22-string-pool/ title=字符串常量池到底保存的是字符串对象还是字符串对象的引用? class=md-nav__link> 字符串常量池到底保存的是字符串对象还是字符串对象的引用? </a> </li> <li class=md-nav__item> <a href=../../../../../tech/code/java/2019-03-23-Java-Thread-pool/ title="Java 线程池" class=md-nav__link> Java 线程池 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/code/java/2019-03-29-Java%20Web/ title="Java Web 启动流程" class=md-nav__link> Java Web 启动流程 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/code/java/2019-04-05-AQS-lock/ title="AQS 与 Java 锁的具体实现" class=md-nav__link> AQS 与 Java 锁的具体实现 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-8-1-4 type=checkbox id=nav-8-1-4> <label class=md-nav__link for=nav-8-1-4> Projects </label> <nav class=md-nav data-md-component=collapsible data-md-level=3> <label class=md-nav__title for=nav-8-1-4> Projects </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../tech/code/projects/2018-05-07-big-data/ title="大数据 Demo （采集、处理、应用）复盘" class=md-nav__link> 大数据 Demo （采集、处理、应用）复盘 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-8-1-5 type=checkbox id=nav-8-1-5> <label class=md-nav__link for=nav-8-1-5> Spring </label> <nav class=md-nav data-md-component=collapsible data-md-level=3> <label class=md-nav__title for=nav-8-1-5> Spring </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../tech/code/spring/2018-09-01-Spring%20Security/ title="Spring Boot 与 Spring Security" class=md-nav__link> Spring Boot 与 Spring Security </a> </li> <li class=md-nav__item> <a href=../../../../../tech/code/spring/2019-03-29-Spring-init/ title="Spring 启动流程与简单源码分析" class=md-nav__link> Spring 启动流程与简单源码分析 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/code/spring/2019-04-06-Spring-MVC/ title="Spring MVC 简单源码分析" class=md-nav__link> Spring MVC 简单源码分析 </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-8-2 type=checkbox id=nav-8-2> <label class=md-nav__link for=nav-8-2> Config </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-8-2> Config </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-8-2-1 type=checkbox id=nav-8-2-1> <label class=md-nav__link for=nav-8-2-1> Git </label> <nav class=md-nav data-md-component=collapsible data-md-level=3> <label class=md-nav__title for=nav-8-2-1> Git </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../tech/config/git/2018-02-01-git/ title="Git 的简单使用" class=md-nav__link> Git 的简单使用 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/config/git/2019-08-10-git-merge/ title="Git 协作管理项目时不可避免的 merge 操作" class=md-nav__link> Git 协作管理项目时不可避免的 merge 操作 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/config/git/submodule/ title=submodule class=md-nav__link> submodule </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-8-2-2 type=checkbox id=nav-8-2-2> <label class=md-nav__link for=nav-8-2-2> Linux </label> <nav class=md-nav data-md-component=collapsible data-md-level=3> <label class=md-nav__title for=nav-8-2-2> Linux </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../tech/config/linux/2019-12-18-manjaro/ title="Manjaro 个人新装配置" class=md-nav__link> Manjaro 个人新装配置 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/config/linux/2020-02-23-archer-s-arch/ title="Archer`s Arch" class=md-nav__link> Archer`s Arch </a> </li> <li class=md-nav__item> <a href=../../../../../tech/config/linux/fontconfig/ title="Arch Emoji fontconfig" class=md-nav__link> Arch Emoji fontconfig </a> </li> <li class=md-nav__item> <a href=../../../../../tech/config/linux/softwares/ title=各种工具 class=md-nav__link> 各种工具 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-8-2-3 type=checkbox id=nav-8-2-3> <label class=md-nav__link for=nav-8-2-3> Tools </label> <nav class=md-nav data-md-component=collapsible data-md-level=3> <label class=md-nav__title for=nav-8-2-3> Tools </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../tech/config/tools/cz-conventional-changelog/ title=cz-conventional-changelog class=md-nav__link> cz-conventional-changelog </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-8-2-4 type=checkbox id=nav-8-2-4> <label class=md-nav__link for=nav-8-2-4> Undefined </label> <nav class=md-nav data-md-component=collapsible data-md-level=3> <label class=md-nav__title for=nav-8-2-4> Undefined </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../tech/config/undefined/2018-03-31-Generator-SpringBoot-Gradle/ title="MyBatis Generator + Spring Boot + Gradle 配置" class=md-nav__link> MyBatis Generator + Spring Boot + Gradle 配置 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/config/undefined/2018-06-25-VS-Code-Python/ title="VS Code 写 Python" class=md-nav__link> VS Code 写 Python </a> </li> <li class=md-nav__item> <a href=../../../../../tech/config/undefined/2018-06-26-linux-kawa/ title="在 Linux 上使用 kawa" class=md-nav__link> 在 Linux 上使用 kawa </a> </li> <li class=md-nav__item> <a href=../../../../../tech/config/undefined/2018-11-25-mysql/ title="【转】在 CentOS 上部署 MySQL 解压版" class=md-nav__link> 【转】在 CentOS 上部署 MySQL 解压版 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/config/undefined/2019-04-03-Redis-lock/ title="Redis 的分布式锁实现" class=md-nav__link> Redis 的分布式锁实现 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/config/undefined/2019-07-28-picGo/ title="Github + picGo ——有图床了" class=md-nav__link> Github + picGo ——有图床了 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/config/undefined/2019-11-18-linux-mount/ title="Linux 挂载分区/磁盘" class=md-nav__link> Linux 挂载分区/磁盘 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/config/undefined/2020-02-03-terminal-wifi/ title=把显卡驱动删了后在终端连热点 class=md-nav__link> 把显卡驱动删了后在终端连热点 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/config/undefined/2020-02-12-css/ title=一个引号引发的惨案 class=md-nav__link> 一个引号引发的惨案 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/config/undefined/2020-02-23-archer-s-arch/ title="Archer`s Arch" class=md-nav__link> Archer`s Arch </a> </li> <li class=md-nav__item> <a href=../../../../../tech/config/undefined/2020-03-12-electron-vue/ title="用 Vue 写 Electron 的一次问题解决" class=md-nav__link> 用 Vue 写 Electron 的一次问题解决 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/config/undefined/2020-03-12-ttrss/ title="部署 TTRSS 遇到的一些有趣的东西" class=md-nav__link> 部署 TTRSS 遇到的一些有趣的东西 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/config/undefined/2020-04-02-hexo-asset-image/ title="hexo-next-theme 开启 lazyload 使用 hexo-asset-image 出问题了" class=md-nav__link> hexo-next-theme 开启 lazyload 使用 hexo-asset-image 出问题了 </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-8-3 type=checkbox id=nav-8-3> <label class=md-nav__link for=nav-8-3> Project </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-8-3> Project </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../tech/project/2017-12-21-xiao-zong-jie/ title=做个小小的总结 class=md-nav__link> 做个小小的总结 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/project/2018-05-07-big-data/ title="大数据 Demo （采集、处理、应用）复盘" class=md-nav__link> 大数据 Demo （采集、处理、应用）复盘 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/project/2018-06-25-tencent-news-spider-py/ title=腾讯新闻爬虫 class=md-nav__link> 腾讯新闻爬虫 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/project/2018-09-13-lite-terminal-home-page/ title=简单的仿终端主页 class=md-nav__link> 简单的仿终端主页 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/project/2019-01-11-tank/ title=花里胡哨的坦克大战 class=md-nav__link> 花里胡哨的坦克大战 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/project/2019-02-05-new-year/ title=大年初一（爬取豆瓣条目及吐槽） class=md-nav__link> 大年初一（爬取豆瓣条目及吐槽） </a> </li> <li class=md-nav__item> <a href=../../../../../tech/project/2019-04-03-blog-project/ title=写博客 class=md-nav__link> 写博客 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/project/2019-06-17-nodejs/ title="MarkAll 导入豆瓣数据 —— NodeJS 写爬虫" class=md-nav__link> MarkAll 导入豆瓣数据 —— NodeJS 写爬虫 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/project/2019-11-15-Autumn-Json/ title="Autumn-From-Spring 自定义 BeanDefinitionReader" class=md-nav__link> Autumn-From-Spring 自定义 BeanDefinitionReader </a> </li> <li class=md-nav__item> <a href=../../../../../tech/project/2019-11-15-bookmarkdown/ title="Chrome 插件——书签转 MarkDown" class=md-nav__link> Chrome 插件——书签转 MarkDown </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-8-4 type=checkbox id=nav-8-4> <label class=md-nav__link for=nav-8-4> Undefined </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-8-4> Undefined </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../tech/undefined/2017-08-10-then-start/ title=那就开始吧 class=md-nav__link> 那就开始吧 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/undefined/2017-08-16-Writing-is%20the-reward-of-writing-itself/ title=写就是写本身的报酬 class=md-nav__link> 写就是写本身的报酬 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/undefined/2017-11-19-change-my-blog/ title=【过时内容】嘿，我转移博客啦！ class=md-nav__link> 【过时内容】嘿，我转移博客啦！ </a> </li> <li class=md-nav__item> <a href=../../../../../tech/undefined/2017-12-08-yao-guai-ji-yu-you-ren-bo/ title=妖怪唧唧与友人波波 class=md-nav__link> 妖怪唧唧与友人波波 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/undefined/2018-01-01-ubuntu/ title="折腾 ubuntu 与 win10 共存" class=md-nav__link> 折腾 ubuntu 与 win10 共存 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/undefined/2018-02-09-pc-system/ title="黑苹果与 Ubuntu 及 PC 折腾系统" class=md-nav__link> 黑苹果与 Ubuntu 及 PC 折腾系统 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/undefined/2018-03-12-install-Vmware-on-linux/ title="deepin 安装 VMware" class=md-nav__link> deepin 安装 VMware </a> </li> <li class=md-nav__item> <a href=../../../../../tech/undefined/2018-03-31-SQL/ title="Spring Boot 开发遇到一些 SQL 问题" class=md-nav__link> Spring Boot 开发遇到一些 SQL 问题 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/undefined/2018-04-06-jquery-confrim/ title="JQuery-Confrim 的一点问题" class=md-nav__link> JQuery-Confrim 的一点问题 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/undefined/2018-04-06-some-plugins/ title="ECharts + PageHelper + Bootstrap Table" class=md-nav__link> ECharts + PageHelper + Bootstrap Table </a> </li> <li class=md-nav__item> <a href=../../../../../tech/undefined/2018-04-09-js-in-thymeleaf/ title="Thymeleaf 里使用 JavaScript 时的注意事项" class=md-nav__link> Thymeleaf 里使用 JavaScript 时的注意事项 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/undefined/2018-04-09-spring-boot-gradle-yml-log4j2/ title="Spring Boot + Gradle + yml 配置 log4j2" class=md-nav__link> Spring Boot + Gradle + yml 配置 log4j2 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/undefined/2018-05-09-softwares/ title="Linux 常用软件" class=md-nav__link> Linux 常用软件 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/undefined/2018-05-30-hexo-image/ title="【可能过时】Hexo 一点问题（生成博文插入本地图片,修改文章路径）" class=md-nav__link> 【可能过时】Hexo 一点问题（生成博文插入本地图片,修改文章路径） </a> </li> <li class=md-nav__item> <a href=../../../../../tech/undefined/2018-05-30-show/ title=如果给文章提供多种渲染方式 class=md-nav__link> 如果给文章提供多种渲染方式 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/undefined/2018-08-30-vue-music/ title="简单的单页应用(Vue CLI2 的简单使用)" class=md-nav__link> 简单的单页应用(Vue CLI2 的简单使用) </a> </li> <li class=md-nav__item> <a href=../../../../../tech/undefined/2018-09-23-word-count/ title="WordCount 项目总结" class=md-nav__link> WordCount 项目总结 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/undefined/2020-02-06-markall-douban-backup/ title=豆瓣标记数据备份插件 class=md-nav__link> 豆瓣标记数据备份插件 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/undefined/2020-02-07-markall-douban-backup-yes/ title=【过时】又一个——豆瓣标记数据备份插件 class=md-nav__link> 【过时】又一个——豆瓣标记数据备份插件 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/undefined/2020-02-13-blog/ title=从分析本网站的网络请求谈起 class=md-nav__link> 从分析本网站的网络请求谈起 </a> </li> <li class=md-nav__item> <a href=../../../../../tech/undefined/draft/ title=Draft class=md-nav__link> Draft </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary"> <label class=md-nav__title for=__toc>目录</label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=#_2 class=md-nav__link> 查找类 </a> </li> <li class=md-nav__item> <a href=#_3 class=md-nav__link> 控制序列化 </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#transient class=md-nav__link> transient 关键字 </a> </li> <li class=md-nav__item> <a href=#externalizable class=md-nav__link> Externalizable 的替代方法 </a> </li> <li class=md-nav__item> <a href=#_4 class=md-nav__link> 版本控制 </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_5 class=md-nav__link> 使用持久化 </a> </li> <li class=md-nav__item> <a href=#xml class=md-nav__link> XML </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content> <article class="md-content__inner md-typeset"> <a href=https://github.com/hqweay/my-mkdocs/edit/master/docs/book/OnJava8/docs/book/Appendix-Object-Serialization.md title=编辑此页 class="md-icon md-content__icon">&#xE3C9;</a> <div class=toc> <ul> <li><a href=#_1>附录:对象序列化</a><ul> <li><a href=#_2>查找类</a></li> <li><a href=#_3>控制序列化</a><ul> <li><a href=#transient>transient 关键字</a></li> <li><a href=#externalizable>Externalizable 的替代方法</a></li> <li><a href=#_4>版本控制</a></li> </ul> </li> <li><a href=#_5>使用持久化</a></li> <li><a href=#xml>XML</a></li> </ul> </li> </ul> </div> <!-- Appendix: Object Serialization --> <h1 id=_1>附录:对象序列化<a class=headerlink href=#_1 title="Permanent link">#</a></h1> <p>当你创建对象时，只要你需要，它就会一直存在，但是在程序终止时，无论如何它都不会继续存在。尽管这么做肯定是有意义的，但是仍旧存在某些情况，如果对象能够在程序不运行的情况下仍能存在并保存其信息，那将非常有用。这样，在下次运行程序时，该对象将被重建并且拥有的信息与在程序上次运行时它所拥有的信息相同。当然，你可以通过将信息写入文件或数据库来达到相同的效果，但是在使万物都成为对象的精神中，如果能够将一个对象声明为是“持久性”的，并为我们处理掉所有细节，那将会显得十分方便。</p> <p>Java 的对象序列化将那些实现了 Serializable 接口的对象转换成一个字节序列，并能够在以后将这个字节序列完全恢复为原来的对象。这一过程甚至可通过网络进行，这意味着序列化机制能自动弥补不同操作系统之间的差异。也就是说，可以在运行 Windows 系统的计算机上创建一个对象，将其序列化，通过网络将它发送给一台运行 Unix 系统的计算机，然后在那里准确地重新组装，而却不必担心数据在不同机器上的表示会不同，也不必关心宇节的顺序或者其他任何细节。</p> <p>就其本身来说，对象序列化可以实现轻量级持久性（lightweight persistence），“持久性”意味着一个对象的生存周期并不取决于程序是否正在执行它可以生存于程序的调用之间。通过将一个序列化对象写入磁盘，然后在重新调用程序时恢复该对象，就能够实现持久性的效果。之所以称其为“轻量级”，是因为不能用某种"persistent"（持久）关键字来简单地定义一个对象，并让系统自动维护其他细节问题（尽管将来有可能实现）。相反，对象必须在程序中显式地序列化（serialize）和反序列化还原（deserialize），如果需要个更严格的持久性机制，可以考虑像 Hibernate 之类的工具。</p> <p>对象序列化的概念加入到语言中是为了支持两种主要特性。一是 Java 的远程方法调用（Remote Method Invocation，RMI），它使存活于其他计算机上的对象使用起来就像是存活于本机上一样。当向远程对象发送消息时，需要通过对象序列化来传输参数和返回值。</p> <p>再者，对 Java Beans 来说，对象的序列化也是必需的（在撰写本文时被视为失败的技术），使用一个 Bean 时，一般情况下是在设计阶段对它的状态信息进行配置。这种状态信息必须保存下来，并在程序启动时进行后期恢复，这种具体工作就是由对象序列化完成的。</p> <p>只要对象实现了 Serializable 接口（该接口仅是一个标记接口，不包括任何方法），对象的序列化处理就会非常简单。当序列化的概念被加入到语言中时，许多标准库类都发生了改变，以便具备序列化特性-其中包括所有基本数据类型的封装器、所有容器类以及许多其他的东西。甚至 Class 对象也可以被序列化。</p> <p>要序列化一个对象，首先要创建某些 OutputStream 对象，然后将其封装在一个 ObjectOutputStream 对象内。这时，只需调用 writeObject() 即可将对象序列化，并将其发送给 OutputStream（对象化序列是基于字节的，因要使用 InputStream 和 OutputStream 继承层次结构）。要反向进行该过程（即将一个序列还原为一个对象），需要将一个 InputStream 封装在 ObjectInputStream 内，然后调用 readObject()。和往常一样，我们最后获得的是一个引用，它指向一个向上转型的 Object，所以必须向下转型才能直接设置它们。</p> <p>对象序列化特别“聪明”的一个地方是它不仅保存了对象的“全景图”，而且能追踪对象内所包含的所有引用，并保存那些对象；接着又能对对象内包含的每个这样的引用进行追踪，依此类推。这种情况有时被称为“对象网”，单个对象可与之建立连接，而且它还包含了对象的引用数组以及成员对象。如果必须保持一套自己的对象序列化机制，那么维护那些可追踪到所有链接的代码可能会显得非常麻烦。然而，由于 Java 的对象序列化似乎找不出什么缺点，所以请尽量不要自己动手，让它用优化的算法自动维护整个对象网。下面这个例子通过对链接的对象生成一个 worm（蠕虫）对序列化机制进行了测试。每个对象都与 worm 中的下一段链接，同时又与属于不同类（Data）的对象引用数组链接：</p> <div class=highlight><pre><span></span><code><span class=c1>// serialization/Worm.java</span>
<span class=c1>// Demonstrates object serialization</span>
<span class=kn>import</span> <span class=nn>java.io.*</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>java.util.*</span><span class=p>;</span>
<span class=kd>class</span> <span class=nc>Data</span> <span class=kd>implements</span> <span class=n>Serializable</span> <span class=p>{</span>
    <span class=kd>private</span> <span class=kt>int</span> <span class=n>n</span><span class=p>;</span>
    <span class=n>Data</span><span class=p>(</span><span class=kt>int</span> <span class=n>n</span><span class=p>)</span> <span class=p>{</span> <span class=k>this</span><span class=p>.</span><span class=na>n</span> <span class=o>=</span> <span class=n>n</span><span class=p>;</span> <span class=p>}</span>
    <span class=nd>@Override</span>
    <span class=kd>public</span> <span class=n>String</span> <span class=nf>toString</span><span class=p>()</span> <span class=p>{</span>
        <span class=k>return</span> <span class=n>Integer</span><span class=p>.</span><span class=na>toString</span><span class=p>(</span><span class=n>n</span><span class=p>);</span>
    <span class=p>}</span>
<span class=p>}</span>
<span class=kd>public</span> <span class=kd>class</span> <span class=nc>Worm</span> <span class=kd>implements</span> <span class=n>Serializable</span> <span class=p>{</span>
    <span class=kd>private</span> <span class=kd>static</span> <span class=n>Random</span> <span class=n>rand</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Random</span><span class=p>(</span><span class=mi>47</span><span class=p>);</span>
    <span class=kd>private</span> <span class=n>Data</span><span class=o>[]</span> <span class=n>d</span> <span class=o>=</span> <span class=p>{</span>
            <span class=k>new</span> <span class=n>Data</span><span class=p>(</span><span class=n>rand</span><span class=p>.</span><span class=na>nextInt</span><span class=p>(</span><span class=mi>10</span><span class=p>)),</span>
            <span class=k>new</span> <span class=n>Data</span><span class=p>(</span><span class=n>rand</span><span class=p>.</span><span class=na>nextInt</span><span class=p>(</span><span class=mi>10</span><span class=p>)),</span>
            <span class=k>new</span> <span class=n>Data</span><span class=p>(</span><span class=n>rand</span><span class=p>.</span><span class=na>nextInt</span><span class=p>(</span><span class=mi>10</span><span class=p>))</span>
    <span class=p>};</span>
    <span class=kd>private</span> <span class=n>Worm</span> <span class=n>next</span><span class=p>;</span>
    <span class=kd>private</span> <span class=kt>char</span> <span class=n>c</span><span class=p>;</span>
    <span class=c1>// Value of i == number of segments</span>
    <span class=kd>public</span> <span class=nf>Worm</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span><span class=p>,</span> <span class=kt>char</span> <span class=n>x</span><span class=p>)</span> <span class=p>{</span>
        <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&quot;Worm constructor: &quot;</span> <span class=o>+</span> <span class=n>i</span><span class=p>);</span>
        <span class=n>c</span> <span class=o>=</span> <span class=n>x</span><span class=p>;</span>
        <span class=k>if</span><span class=p>(</span><span class=o>--</span><span class=n>i</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>)</span>
            <span class=n>next</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Worm</span><span class=p>(</span><span class=n>i</span><span class=p>,</span> <span class=p>(</span><span class=kt>char</span><span class=p>)(</span><span class=n>x</span> <span class=o>+</span> <span class=mi>1</span><span class=p>));</span>
    <span class=p>}</span>
    <span class=kd>public</span> <span class=nf>Worm</span><span class=p>()</span> <span class=p>{</span>
        <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&quot;No-arg constructor&quot;</span><span class=p>);</span>
    <span class=p>}</span>
    <span class=nd>@Override</span>
    <span class=kd>public</span> <span class=n>String</span> <span class=nf>toString</span><span class=p>()</span> <span class=p>{</span>
        <span class=n>StringBuilder</span> <span class=n>result</span> <span class=o>=</span> <span class=k>new</span> <span class=n>StringBuilder</span><span class=p>(</span><span class=s>&quot;:&quot;</span><span class=p>);</span>
        <span class=n>result</span><span class=p>.</span><span class=na>append</span><span class=p>(</span><span class=n>c</span><span class=p>);</span>
        <span class=n>result</span><span class=p>.</span><span class=na>append</span><span class=p>(</span><span class=s>&quot;(&quot;</span><span class=p>);</span>
        <span class=k>for</span><span class=p>(</span><span class=n>Data</span> <span class=n>dat</span> <span class=p>:</span> <span class=n>d</span><span class=p>)</span>
            <span class=n>result</span><span class=p>.</span><span class=na>append</span><span class=p>(</span><span class=n>dat</span><span class=p>);</span>
        <span class=n>result</span><span class=p>.</span><span class=na>append</span><span class=p>(</span><span class=s>&quot;)&quot;</span><span class=p>);</span>
        <span class=k>if</span><span class=p>(</span><span class=n>next</span> <span class=o>!=</span> <span class=kc>null</span><span class=p>)</span>
            <span class=n>result</span><span class=p>.</span><span class=na>append</span><span class=p>(</span><span class=n>next</span><span class=p>);</span>
        <span class=k>return</span> <span class=n>result</span><span class=p>.</span><span class=na>toString</span><span class=p>();</span>
    <span class=p>}</span>
    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span>
    <span class=nf>main</span><span class=p>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=p>)</span> <span class=kd>throws</span> <span class=n>ClassNotFoundException</span><span class=p>,</span>
            <span class=n>IOException</span> <span class=p>{</span>
        <span class=n>Worm</span> <span class=n>w</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Worm</span><span class=p>(</span><span class=mi>6</span><span class=p>,</span> <span class=sc>&#39;a&#39;</span><span class=p>);</span>
        <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&quot;w = &quot;</span> <span class=o>+</span> <span class=n>w</span><span class=p>);</span>
        <span class=k>try</span><span class=p>(</span>
                <span class=n>ObjectOutputStream</span> <span class=n>out</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ObjectOutputStream</span><span class=p>(</span>
                        <span class=k>new</span> <span class=n>FileOutputStream</span><span class=p>(</span><span class=s>&quot;worm.dat&quot;</span><span class=p>))</span>
        <span class=p>)</span> <span class=p>{</span>
            <span class=n>out</span><span class=p>.</span><span class=na>writeObject</span><span class=p>(</span><span class=s>&quot;Worm storage\n&quot;</span><span class=p>);</span>
            <span class=n>out</span><span class=p>.</span><span class=na>writeObject</span><span class=p>(</span><span class=n>w</span><span class=p>);</span>
        <span class=p>}</span>
        <span class=k>try</span><span class=p>(</span>
                <span class=n>ObjectInputStream</span> <span class=n>in</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ObjectInputStream</span><span class=p>(</span>
                        <span class=k>new</span> <span class=n>FileInputStream</span><span class=p>(</span><span class=s>&quot;worm.dat&quot;</span><span class=p>))</span>
        <span class=p>)</span> <span class=p>{</span>
            <span class=n>String</span> <span class=n>s</span> <span class=o>=</span> <span class=p>(</span><span class=n>String</span><span class=p>)</span><span class=n>in</span><span class=p>.</span><span class=na>readObject</span><span class=p>();</span>
            <span class=n>Worm</span> <span class=n>w2</span> <span class=o>=</span> <span class=p>(</span><span class=n>Worm</span><span class=p>)</span><span class=n>in</span><span class=p>.</span><span class=na>readObject</span><span class=p>();</span>
            <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>s</span> <span class=o>+</span> <span class=s>&quot;w2 = &quot;</span> <span class=o>+</span> <span class=n>w2</span><span class=p>);</span>
        <span class=p>}</span>
        <span class=k>try</span><span class=p>(</span>
                <span class=n>ByteArrayOutputStream</span> <span class=n>bout</span> <span class=o>=</span>
                        <span class=k>new</span> <span class=n>ByteArrayOutputStream</span><span class=p>();</span>
                <span class=n>ObjectOutputStream</span> <span class=n>out2</span> <span class=o>=</span>
                        <span class=k>new</span> <span class=n>ObjectOutputStream</span><span class=p>(</span><span class=n>bout</span><span class=p>)</span>
        <span class=p>)</span> <span class=p>{</span>
            <span class=n>out2</span><span class=p>.</span><span class=na>writeObject</span><span class=p>(</span><span class=s>&quot;Worm storage\n&quot;</span><span class=p>);</span>
            <span class=n>out2</span><span class=p>.</span><span class=na>writeObject</span><span class=p>(</span><span class=n>w</span><span class=p>);</span>
            <span class=n>out2</span><span class=p>.</span><span class=na>flush</span><span class=p>();</span>
            <span class=k>try</span><span class=p>(</span>
                    <span class=n>ObjectInputStream</span> <span class=n>in2</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ObjectInputStream</span><span class=p>(</span>
                            <span class=k>new</span> <span class=n>ByteArrayInputStream</span><span class=p>(</span>
                                    <span class=n>bout</span><span class=p>.</span><span class=na>toByteArray</span><span class=p>()))</span>
            <span class=p>)</span> <span class=p>{</span>
                <span class=n>String</span> <span class=n>s</span> <span class=o>=</span> <span class=p>(</span><span class=n>String</span><span class=p>)</span><span class=n>in2</span><span class=p>.</span><span class=na>readObject</span><span class=p>();</span>
                <span class=n>Worm</span> <span class=n>w3</span> <span class=o>=</span> <span class=p>(</span><span class=n>Worm</span><span class=p>)</span><span class=n>in2</span><span class=p>.</span><span class=na>readObject</span><span class=p>();</span>
                <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>s</span> <span class=o>+</span> <span class=s>&quot;w3 = &quot;</span> <span class=o>+</span> <span class=n>w3</span><span class=p>);</span>
            <span class=p>}</span>
        <span class=p>}</span>
    <span class=p>}</span>
<span class=p>}</span>
</code></pre></div> <p>输出为：</p> <div class=highlight><pre><span></span><code>Worm constructor: 6
Worm constructor: 5
Worm constructor: 4
Worm constructor: 3
Worm constructor: 2
Worm constructor: 1
w = :a(853):b(119):c(802):d(788):e(199):f(881)
Worm storage
w2 = :a(853):b(119):c(802):d(788):e(199):f(881)
Worm storage
w3 = :a(853):b(119):c(802):d(788):e(199):f(881)
</code></pre></div> <p>更有趣的是，Worm 内的 Data 对象数组是用随机数初始化的（这样就不用怀疑编译器保留了某种原始信息），每个 Worm 段都用一个 char 加以标记。该 char 是在递归生成链接的 Worm 列表时自动产生的。要创建一个 Worm，必须告诉构造器你所希望的它的长度。在产生下一个引用时，要调用 Worm 构造器，并将长度减 1，以此类推。最后一个 next 引用则为 null（空），表示已到达 Worm 的尾部</p> <p>以上这些操作都使得事情变得更加复杂，从而加大了对象序列化的难度。然而，真正的序列化过程却是非常简单的。一旦从另外某个流创建了 ObjectOutputstream，writeObject() 就会将对象序列化。注意也可以为一个 String 调用 writeObject() 也可以用与 DataOutputStream 相同的方法写人所有基本数据类型（它们具有同样的接口）。</p> <p>有两段看起来相似的独立的代码。一个读写的是文件，而另一个读写的是字节数组（ByteArray），可利用序列化将对象读写到任何 DatalnputStream 或者 DataOutputStream。</p> <p>从输出中可以看出，被还原后的对象确实包含了原对象中的所有链接。</p> <p>注意在对一个 Serializable 对象进行还原的过程中，没有调用任何构造器，包括默认的构造器。整个对象都是通过从 InputStream 中取得数据恢复而来的。</p> <!-- Finding the Class --> <h2 id=_2>查找类<a class=headerlink href=#_2 title="Permanent link">#</a></h2> <p>你或许会奇怪，将一个对象从它的序列化状态中恢复出来，有哪些工作是必须的呢？举个例子来说，假如我们将一个对象序列化，并通过网络将其作为文件传送给另一台计算机，那么，另一台计算机上的程序可以只利用该文件内容来还原这个对象吗？</p> <p>回答这个问题的最好方法就是做一个实验。下面这个文件位于本章的子目录下：</p> <div class=highlight><pre><span></span><code><span class=c1>// serialization/Alien.java</span>
<span class=c1>// A serializable class</span>
<span class=kn>import</span> <span class=nn>java.io.*</span><span class=p>;</span>
<span class=kd>public</span> <span class=kd>class</span> <span class=nc>Alien</span> <span class=kd>implements</span> <span class=n>Serializable</span> <span class=p>{}</span>
</code></pre></div> <p>而用于创建和序列化一个 Alien 对象的文件也位于相同的目录下：</p> <div class=highlight><pre><span></span><code><span class=c1>// serialization/FreezeAlien.java</span>
<span class=c1>// Create a serialized output file</span>
<span class=kn>import</span> <span class=nn>java.io.*</span><span class=p>;</span>
<span class=kd>public</span> <span class=kd>class</span> <span class=nc>FreezeAlien</span> <span class=p>{</span>
    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=p>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=p>)</span> <span class=kd>throws</span> <span class=n>Exception</span> <span class=p>{</span>
        <span class=k>try</span><span class=p>(</span>
                <span class=n>ObjectOutputStream</span> <span class=n>out</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ObjectOutputStream</span><span class=p>(</span>
                        <span class=k>new</span> <span class=n>FileOutputStream</span><span class=p>(</span><span class=s>&quot;X.file&quot;</span><span class=p>));</span>
        <span class=p>)</span> <span class=p>{</span>
            <span class=n>Alien</span> <span class=n>quellek</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Alien</span><span class=p>();</span>
            <span class=n>out</span><span class=p>.</span><span class=na>writeObject</span><span class=p>(</span><span class=n>quellek</span><span class=p>);</span>
        <span class=p>}</span>
    <span class=p>}</span>
<span class=p>}</span>
</code></pre></div> <p>一旦该程序被编译和运行，它就会在 c12 目录下产生一个名为 X.file 的文件。以下代码位于一个名为 xiles 的子目录下：</p> <div class=highlight><pre><span></span><code><span class=c1>// serialization/xfiles/ThawAlien.java</span>
<span class=c1>// Recover a serialized file</span>
<span class=c1>// {java serialization.xfiles.ThawAlien}</span>
<span class=c1>// {RunFirst: FreezeAlien}</span>
<span class=kn>package</span> <span class=nn>serialization.xfiles</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>java.io.*</span><span class=p>;</span>
<span class=kd>public</span> <span class=kd>class</span> <span class=nc>ThawAlien</span> <span class=p>{</span>
    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=p>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=p>)</span> <span class=kd>throws</span> <span class=n>Exception</span> <span class=p>{</span>
        <span class=n>ObjectInputStream</span> <span class=n>in</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ObjectInputStream</span><span class=p>(</span>
                <span class=k>new</span> <span class=n>FileInputStream</span><span class=p>(</span><span class=k>new</span> <span class=n>File</span><span class=p>(</span><span class=s>&quot;X.file&quot;</span><span class=p>)));</span>
        <span class=n>Object</span> <span class=n>mystery</span> <span class=o>=</span> <span class=n>in</span><span class=p>.</span><span class=na>readObject</span><span class=p>();</span>
        <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>mystery</span><span class=p>.</span><span class=na>getClass</span><span class=p>());</span>
    <span class=p>}</span>
<span class=p>}</span>
</code></pre></div> <p>输出为：</p> <div class=highlight><pre><span></span><code><span class=kd>class</span> <span class=nc>Alien</span>
</code></pre></div> <p>为了正常运行，必须保证 Java 虚拟机能找到相关的.class 文件。</p> <!-- Controlling Serialization --> <h2 id=_3>控制序列化<a class=headerlink href=#_3 title="Permanent link">#</a></h2> <p>正如大家所看到的，默认的序列化机制并不难操纵。然而，如果有特殊的需要那又该怎么办呢？例如，也许要考虑特殊的安全问题，而且你不希望对象的某一部分被序列化；或者一个对象被还原以后，某子对象需要重新创建，从而不必将该子对象序列化。</p> <p>在这些特殊情况下，可通过实现 Externalizable 接口——代替实现 Serializable 接口-来对序列化过程进行控制。这个 Externalizable 接口继承了 Serializable 接口，同时增添了两个方法：writeExternal0 和 readExternal0。这两个方法会在序列化和反序列化还原的过程中被自动调用，以便执行一些特殊操作。</p> <p>下面这个例子展示了 Externalizable 接口方法的简单实现。注意 Blip1 和 Blip2 除了细微的差别之外，几乎完全一致（研究一下代码，看看你能否发现）：</p> <div class=highlight><pre><span></span><code><span class=c1>// serialization/Blips.java</span>
<span class=c1>// Simple use of Externalizable &amp; a pitfall</span>
<span class=kn>import</span> <span class=nn>java.io.*</span><span class=p>;</span>
<span class=kd>class</span> <span class=nc>Blip1</span> <span class=kd>implements</span> <span class=n>Externalizable</span> <span class=p>{</span>
    <span class=kd>public</span> <span class=nf>Blip1</span><span class=p>()</span> <span class=p>{</span>
        <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&quot;Blip1 Constructor&quot;</span><span class=p>);</span>
    <span class=p>}</span>
    <span class=nd>@Override</span>
    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>writeExternal</span><span class=p>(</span><span class=n>ObjectOutput</span> <span class=n>out</span><span class=p>)</span>
            <span class=kd>throws</span> <span class=n>IOException</span> <span class=p>{</span>
        <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&quot;Blip1.writeExternal&quot;</span><span class=p>);</span>
    <span class=p>}</span>
    <span class=nd>@Override</span>
    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>readExternal</span><span class=p>(</span><span class=n>ObjectInput</span> <span class=n>in</span><span class=p>)</span>
            <span class=kd>throws</span> <span class=n>IOException</span><span class=p>,</span> <span class=n>ClassNotFoundException</span> <span class=p>{</span>
        <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&quot;Blip1.readExternal&quot;</span><span class=p>);</span>
    <span class=p>}</span>
<span class=p>}</span>
<span class=kd>class</span> <span class=nc>Blip2</span> <span class=kd>implements</span> <span class=n>Externalizable</span> <span class=p>{</span>
    <span class=n>Blip2</span><span class=p>()</span> <span class=p>{</span>
        <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&quot;Blip2 Constructor&quot;</span><span class=p>);</span>
    <span class=p>}</span>
    <span class=nd>@Override</span>
    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>writeExternal</span><span class=p>(</span><span class=n>ObjectOutput</span> <span class=n>out</span><span class=p>)</span>
            <span class=kd>throws</span> <span class=n>IOException</span> <span class=p>{</span>
        <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&quot;Blip2.writeExternal&quot;</span><span class=p>);</span>
    <span class=p>}</span>
    <span class=nd>@Override</span>
    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>readExternal</span><span class=p>(</span><span class=n>ObjectInput</span> <span class=n>in</span><span class=p>)</span>
            <span class=kd>throws</span> <span class=n>IOException</span><span class=p>,</span> <span class=n>ClassNotFoundException</span> <span class=p>{</span>
        <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&quot;Blip2.readExternal&quot;</span><span class=p>);</span>
    <span class=p>}</span>
<span class=p>}</span>
<span class=kd>public</span> <span class=kd>class</span> <span class=nc>Blips</span> <span class=p>{</span>
    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=p>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=p>)</span> <span class=p>{</span>
        <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&quot;Constructing objects:&quot;</span><span class=p>);</span>
        <span class=n>Blip1</span> <span class=n>b1</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Blip1</span><span class=p>();</span>
        <span class=n>Blip2</span> <span class=n>b2</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Blip2</span><span class=p>();</span>
        <span class=k>try</span><span class=p>(</span>
                <span class=n>ObjectOutputStream</span> <span class=n>o</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ObjectOutputStream</span><span class=p>(</span>
                        <span class=k>new</span> <span class=n>FileOutputStream</span><span class=p>(</span><span class=s>&quot;Blips.serialized&quot;</span><span class=p>))</span>
        <span class=p>)</span> <span class=p>{</span>
            <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&quot;Saving objects:&quot;</span><span class=p>);</span>
            <span class=n>o</span><span class=p>.</span><span class=na>writeObject</span><span class=p>(</span><span class=n>b1</span><span class=p>);</span>
            <span class=n>o</span><span class=p>.</span><span class=na>writeObject</span><span class=p>(</span><span class=n>b2</span><span class=p>);</span>
        <span class=p>}</span> <span class=k>catch</span><span class=p>(</span><span class=n>IOException</span> <span class=n>e</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>throw</span> <span class=k>new</span> <span class=n>RuntimeException</span><span class=p>(</span><span class=n>e</span><span class=p>);</span>
        <span class=p>}</span>
        <span class=c1>// Now get them back:</span>
        <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&quot;Recovering b1:&quot;</span><span class=p>);</span>
        <span class=k>try</span><span class=p>(</span>
                <span class=n>ObjectInputStream</span> <span class=n>in</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ObjectInputStream</span><span class=p>(</span>
                        <span class=k>new</span> <span class=n>FileInputStream</span><span class=p>(</span><span class=s>&quot;Blips.serialized&quot;</span><span class=p>))</span>
        <span class=p>)</span> <span class=p>{</span>
            <span class=n>b1</span> <span class=o>=</span> <span class=p>(</span><span class=n>Blip1</span><span class=p>)</span><span class=n>in</span><span class=p>.</span><span class=na>readObject</span><span class=p>();</span>
        <span class=p>}</span> <span class=k>catch</span><span class=p>(</span><span class=n>IOException</span> <span class=o>|</span> <span class=n>ClassNotFoundException</span> <span class=n>e</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>throw</span> <span class=k>new</span> <span class=n>RuntimeException</span><span class=p>(</span><span class=n>e</span><span class=p>);</span>
        <span class=p>}</span>
        <span class=c1>// OOPS! Throws an exception:</span>
        <span class=c1>//- System.out.println(&quot;Recovering b2:&quot;);</span>
        <span class=c1>//- b2 = (Blip2)in.readObject();</span>
    <span class=p>}</span>
<span class=p>}</span>
</code></pre></div> <p>输出为：</p> <div class=highlight><pre><span></span><code>Constructing objects:
Blip1 Constructor
Blip2 Constructor
Saving objects:
Blip1.writeExternal
Blip2.writeExternal
Recovering b1:
Blip1 Constructor
Blip1.readExternal
</code></pre></div> <p>没有恢复 Blip2 对象的原因是那样做会导致一个异常。你找出 Blip1 和 Blip2 之间的区别了吗？Blipl 的构造器是“公共的”（pablic），Blip2 的构造器却不是，这样就会在恢复时造成异常。试试将 Blip2 的构造器变成 public 的，然后删除//注释标记，看看是否能得到正确的结果。</p> <p>恢复 b1 后，会调用 Blip1 默认构造器。这与恢复一个 Serializable 对象不同。对于 Serializable 对象，对象完全以它存储的二进制位为基础来构造，而不调用构造器。而对于一个 Externalizable 对象，所有普通的默认构造器都会被调用（包括在字段定义时的初始化），然后调用 readExternal() 必须注意这一点--所有默认的构造器都会被调用，才能使 Externalizable 对象产生正确的行为。</p> <p>下面这个例子示范了如何完整保存和恢复一个 Externalizable 对象：</p> <div class=highlight><pre><span></span><code><span class=c1>// serialization/Blip3.java</span>
<span class=c1>// Reconstructing an externalizable object</span>
<span class=kn>import</span> <span class=nn>java.io.*</span><span class=p>;</span>
<span class=kd>public</span> <span class=kd>class</span> <span class=nc>Blip3</span> <span class=kd>implements</span> <span class=n>Externalizable</span> <span class=p>{</span>
    <span class=kd>private</span> <span class=kt>int</span> <span class=n>i</span><span class=p>;</span>
    <span class=kd>private</span> <span class=n>String</span> <span class=n>s</span><span class=p>;</span> <span class=c1>// No initialization</span>
    <span class=kd>public</span> <span class=nf>Blip3</span><span class=p>()</span> <span class=p>{</span>
        <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&quot;Blip3 Constructor&quot;</span><span class=p>);</span>
<span class=c1>// s, i not initialized</span>
    <span class=p>}</span>
    <span class=kd>public</span> <span class=nf>Blip3</span><span class=p>(</span><span class=n>String</span> <span class=n>x</span><span class=p>,</span> <span class=kt>int</span> <span class=n>a</span><span class=p>)</span> <span class=p>{</span>
        <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&quot;Blip3(String x, int a)&quot;</span><span class=p>);</span>
        <span class=n>s</span> <span class=o>=</span> <span class=n>x</span><span class=p>;</span>
        <span class=n>i</span> <span class=o>=</span> <span class=n>a</span><span class=p>;</span>
<span class=c1>// s &amp; i initialized only in non-no-arg constructor.</span>
    <span class=p>}</span>
    <span class=nd>@Override</span>
    <span class=kd>public</span> <span class=n>String</span> <span class=nf>toString</span><span class=p>()</span> <span class=p>{</span> <span class=k>return</span> <span class=n>s</span> <span class=o>+</span> <span class=n>i</span><span class=p>;</span> <span class=p>}</span>
    <span class=nd>@Override</span>
    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>writeExternal</span><span class=p>(</span><span class=n>ObjectOutput</span> <span class=n>out</span><span class=p>)</span>
            <span class=kd>throws</span> <span class=n>IOException</span> <span class=p>{</span>
        <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&quot;Blip3.writeExternal&quot;</span><span class=p>);</span>
<span class=c1>// You must do this:</span>
        <span class=n>out</span><span class=p>.</span><span class=na>writeObject</span><span class=p>(</span><span class=n>s</span><span class=p>);</span>
        <span class=n>out</span><span class=p>.</span><span class=na>writeInt</span><span class=p>(</span><span class=n>i</span><span class=p>);</span>
    <span class=p>}</span>
    <span class=nd>@Override</span>
    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>readExternal</span><span class=p>(</span><span class=n>ObjectInput</span> <span class=n>in</span><span class=p>)</span>
            <span class=kd>throws</span> <span class=n>IOException</span><span class=p>,</span> <span class=n>ClassNotFoundException</span> <span class=p>{</span>
        <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&quot;Blip3.readExternal&quot;</span><span class=p>);</span>
<span class=c1>// You must do this:</span>
        <span class=n>s</span> <span class=o>=</span> <span class=p>(</span><span class=n>String</span><span class=p>)</span><span class=n>in</span><span class=p>.</span><span class=na>readObject</span><span class=p>();</span>
        <span class=n>i</span> <span class=o>=</span> <span class=n>in</span><span class=p>.</span><span class=na>readInt</span><span class=p>();</span>
    <span class=p>}</span>
    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=p>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=p>)</span> <span class=p>{</span>
        <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&quot;Constructing objects:&quot;</span><span class=p>);</span>
        <span class=n>Blip3</span> <span class=n>b3</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Blip3</span><span class=p>(</span><span class=s>&quot;A String &quot;</span><span class=p>,</span> <span class=mi>47</span><span class=p>);</span>
        <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>b3</span><span class=p>);</span>
        <span class=k>try</span><span class=p>(</span>
                <span class=n>ObjectOutputStream</span> <span class=n>o</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ObjectOutputStream</span><span class=p>(</span>
                        <span class=k>new</span> <span class=n>FileOutputStream</span><span class=p>(</span><span class=s>&quot;Blip3.serialized&quot;</span><span class=p>))</span>
        <span class=p>)</span> <span class=p>{</span>
            <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&quot;Saving object:&quot;</span><span class=p>);</span>
            <span class=n>o</span><span class=p>.</span><span class=na>writeObject</span><span class=p>(</span><span class=n>b3</span><span class=p>);</span>
        <span class=p>}</span> <span class=k>catch</span><span class=p>(</span><span class=n>IOException</span> <span class=n>e</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>throw</span> <span class=k>new</span> <span class=n>RuntimeException</span><span class=p>(</span><span class=n>e</span><span class=p>);</span>
        <span class=p>}</span>
<span class=c1>// Now get it back:</span>
        <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&quot;Recovering b3:&quot;</span><span class=p>);</span>
        <span class=k>try</span><span class=p>(</span>
                <span class=n>ObjectInputStream</span> <span class=n>in</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ObjectInputStream</span><span class=p>(</span>
                        <span class=k>new</span> <span class=n>FileInputStream</span><span class=p>(</span><span class=s>&quot;Blip3.serialized&quot;</span><span class=p>))</span>
        <span class=p>)</span> <span class=p>{</span>
            <span class=n>b3</span> <span class=o>=</span> <span class=p>(</span><span class=n>Blip3</span><span class=p>)</span><span class=n>in</span><span class=p>.</span><span class=na>readObject</span><span class=p>();</span>
        <span class=p>}</span> <span class=k>catch</span><span class=p>(</span><span class=n>IOException</span> <span class=o>|</span> <span class=n>ClassNotFoundException</span> <span class=n>e</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>throw</span> <span class=k>new</span> <span class=n>RuntimeException</span><span class=p>(</span><span class=n>e</span><span class=p>);</span>
        <span class=p>}</span>
        <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>b3</span><span class=p>);</span>
    <span class=p>}</span>
<span class=p>}</span>
</code></pre></div> <p>输出为：</p> <div class=highlight><pre><span></span><code>Constructing objects:
Blip3(String x, int a)
A String 47
Saving object:
Blip3.writeExternal
Recovering b3:
Blip3 Constructor
Blip3.readExternal
A String 47
</code></pre></div> <p>其中，字段 s 和只在第二个构造器中初始化，而不是在默认的构造器中初始化。这意味着假如不在 readExternal0 中初始化 s 和 i，s 就会为 null，而就会为零（因为在创建对象的第一步中将对象的存储空间清理为 0）。如果注释掉跟随于"You must do this”后面的两行代码，然后运行程序，就会发现当对象被还原后，s 是 null，而 i 是零。</p> <p>我们如果从一个 Externalizable 对象继承，通常需要调用基类版本的 writeExternal() 和 readExternal() 来为基类组件提供恰当的存储和恢复功能。</p> <p>因此，为了正常运行，我们不仅需要在 writeExternal() 方法（没有任何默认行为来为 Externalizable 对象写入任何成员对象）中将来自对象的重要信息写入，还必须在 readExternal() 方法中恢复数据。起先，可能会有一点迷惑，因为 Externalizable 对象的默认构造行为使其看起来似乎像某种自动发生的存储与恢复操作。但实际上并非如此。</p> <h3 id=transient>transient 关键字<a class=headerlink href=#transient title="Permanent link">#</a></h3> <p>当我们对序列化进行控制时，可能某个特定子对象不想让 Java 的序列化机制自动保存与恢复。如果子对象表示的是我们不希望将其序列化的敏感信息（如密码），通常就会面临这种情况。即使对象中的这些信息是 private（私有）属性，一经序列化处理，人们就可以通过读取文件或者拦截网络传输的方式来访问到它。</p> <p>有一种办法可防止对象的敏感部分被序列化，就是将类实现为 Externalizable，如前面所示。这样一来，没有任何东西可以自动序列化，并且可以在 writeExternal() 内部只对所需部分进行显式的序列化。</p> <p>然而，如果我们正在操作的是一个 Seralizable 对象，那么所有序列化操作都会自动进行。为了能够予以控制，可以用 transient（瞬时）关键字逐个字段地关闭序列化，它的意思是“不用麻烦你保存或恢复数据——我自己会处理的"。</p> <p>例如，假设某个 Logon 对象保存某个特定的登录会话信息，登录的合法性通过校验之后，我们想把数据保存下来，但不包括密码。为做到这一点，最简单的办法是实现 Serializable，并将 password 字段标志为 transient，下面是具体的代码：</p> <div class=highlight><pre><span></span><code><span class=c1>// serialization/Logon.java</span>
<span class=c1>// Demonstrates the &quot;transient&quot; keyword</span>
<span class=kn>import</span> <span class=nn>java.util.concurrent.*</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>java.io.*</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>java.util.*</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>onjava.Nap</span><span class=p>;</span>
<span class=kd>public</span> <span class=kd>class</span> <span class=nc>Logon</span> <span class=kd>implements</span> <span class=n>Serializable</span> <span class=p>{</span>
    <span class=kd>private</span> <span class=n>Date</span> <span class=n>date</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Date</span><span class=p>();</span>
    <span class=kd>private</span> <span class=n>String</span> <span class=n>username</span><span class=p>;</span>
    <span class=kd>private</span> <span class=kd>transient</span> <span class=n>String</span> <span class=n>password</span><span class=p>;</span>
    <span class=kd>public</span> <span class=nf>Logon</span><span class=p>(</span><span class=n>String</span> <span class=n>name</span><span class=p>,</span> <span class=n>String</span> <span class=n>pwd</span><span class=p>)</span> <span class=p>{</span>
        <span class=n>username</span> <span class=o>=</span> <span class=n>name</span><span class=p>;</span>
        <span class=n>password</span> <span class=o>=</span> <span class=n>pwd</span><span class=p>;</span>
    <span class=p>}</span>
    <span class=nd>@Override</span>
    <span class=kd>public</span> <span class=n>String</span> <span class=nf>toString</span><span class=p>()</span> <span class=p>{</span>
        <span class=k>return</span> <span class=s>&quot;logon info: \n username: &quot;</span> <span class=o>+</span>
                <span class=n>username</span> <span class=o>+</span> <span class=s>&quot;\n date: &quot;</span> <span class=o>+</span> <span class=n>date</span> <span class=o>+</span>
                <span class=s>&quot;\n password: &quot;</span> <span class=o>+</span> <span class=n>password</span><span class=p>;</span>
    <span class=p>}</span>
    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=p>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=p>)</span> <span class=p>{</span>
        <span class=n>Logon</span> <span class=n>a</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Logon</span><span class=p>(</span><span class=s>&quot;Hulk&quot;</span><span class=p>,</span> <span class=s>&quot;myLittlePony&quot;</span><span class=p>);</span>
        <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&quot;logon a = &quot;</span> <span class=o>+</span> <span class=n>a</span><span class=p>);</span>
        <span class=k>try</span><span class=p>(</span>
                <span class=n>ObjectOutputStream</span> <span class=n>o</span> <span class=o>=</span>
                        <span class=k>new</span> <span class=n>ObjectOutputStream</span><span class=p>(</span>
                                <span class=k>new</span> <span class=n>FileOutputStream</span><span class=p>(</span><span class=s>&quot;Logon.dat&quot;</span><span class=p>))</span>
        <span class=p>)</span> <span class=p>{</span>
            <span class=n>o</span><span class=p>.</span><span class=na>writeObject</span><span class=p>(</span><span class=n>a</span><span class=p>);</span>
        <span class=p>}</span> <span class=k>catch</span><span class=p>(</span><span class=n>IOException</span> <span class=n>e</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>throw</span> <span class=k>new</span> <span class=n>RuntimeException</span><span class=p>(</span><span class=n>e</span><span class=p>);</span>
        <span class=p>}</span>
        <span class=k>new</span> <span class=n>Nap</span><span class=p>(</span><span class=mi>1</span><span class=p>);</span>
<span class=c1>// Now get them back:</span>
        <span class=k>try</span><span class=p>(</span>
                <span class=n>ObjectInputStream</span> <span class=n>in</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ObjectInputStream</span><span class=p>(</span>
                        <span class=k>new</span> <span class=n>FileInputStream</span><span class=p>(</span><span class=s>&quot;Logon.dat&quot;</span><span class=p>))</span>
        <span class=p>)</span> <span class=p>{</span>
            <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span>
                    <span class=s>&quot;Recovering object at &quot;</span> <span class=o>+</span> <span class=k>new</span> <span class=n>Date</span><span class=p>());</span>
            <span class=n>a</span> <span class=o>=</span> <span class=p>(</span><span class=n>Logon</span><span class=p>)</span><span class=n>in</span><span class=p>.</span><span class=na>readObject</span><span class=p>();</span>
        <span class=p>}</span> <span class=k>catch</span><span class=p>(</span><span class=n>IOException</span> <span class=o>|</span> <span class=n>ClassNotFoundException</span> <span class=n>e</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>throw</span> <span class=k>new</span> <span class=n>RuntimeException</span><span class=p>(</span><span class=n>e</span><span class=p>);</span>
        <span class=p>}</span>
        <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&quot;logon a = &quot;</span> <span class=o>+</span> <span class=n>a</span><span class=p>);</span>
    <span class=p>}</span>
<span class=p>}</span>
</code></pre></div> <p>输出为：</p> <div class=highlight><pre><span></span><code>logon a = logon info:
username: Hulk
date: Tue May 09 06:07:47 MDT 2017
password: myLittlePony
Recovering object at Tue May 09 06:07:49 MDT 2017
logon a = logon info:
username: Hulk
date: Tue May 09 06:07:47 MDT 2017
password: null
</code></pre></div> <p>可以看到，其中的 date 和 username 是一般的（不是 transient 的），所以它们会被自动序列化。而 password 是 transient 的，所以不会被自动保存到磁盘；另外，自动序列化机制也不会尝试去恢复它。当对象被恢复时，password 就会变成 null。注意，虽然 toString() 是用重载后的+运算符来连接 String 对象，但是 null 引用会被自动转换成字符串 null。</p> <p>我们还可以发现：date 字段被存储了到磁盘并从磁盘上被恢复了出来，而且没有再重新生成。由于 Externalizable 对象在默认情况下不保存它们的任何字段，所以 transient 关键字只能和 Serializable 对象一起使用。</p> <h3 id=externalizable>Externalizable 的替代方法<a class=headerlink href=#externalizable title="Permanent link">#</a></h3> <p>如果不是特别坚持实现 Externalizable 接口，那么还有另一种方法。我们可以实现 Serializable 接口，并添加（注意我说的是“添加”，而非“覆盖”或者“实现”）名为 writeObject() 和 readObject() 的方法。这样一旦对象被序列化或者被反序列化还原，就会自动地分别调用这两个方法。也就是说，只要我们提供了这两个方法，就会使用它们而不是默认的序列化机制。</p> <p>这些方法必须具有准确的方法特征签名：</p> <div class=highlight><pre><span></span><code><span class=kd>private</span> <span class=kt>void</span> <span class=nf>writeObject</span><span class=p>(</span><span class=n>ObjectOutputStream</span> <span class=n>stream</span><span class=p>)</span> <span class=kd>throws</span> <span class=n>IOException</span>

<span class=kd>private</span> <span class=kt>void</span> <span class=nf>readObject</span><span class=p>(</span><span class=n>ObjectInputStream</span> <span class=n>stream</span><span class=p>)</span> <span class=kd>throws</span> <span class=n>IOException</span><span class=p>,</span> <span class=n>ClassNotFoundException</span>
</code></pre></div> <p>从设计的观点来看，现在事情变得真是不可思议。首先，我们可能会认为由于这些方法不是基类或者 Serializable 接口的一部分，所以应该在它们自己的接口中进行定义。但是注意它们被定义成了 private，这意味着它们仅能被这个类的其他成员调用。然而，实际上我们并没有从这个类的其他方法中调用它们，而是 ObjectOutputStream 和 ObjectInputStream 对象的 writeObject() 和 readobject() 方法调用你的对象的 writeObject() 和 readObject() 方法（注意关于这里用到的相同方法名，我尽量抑制住不去谩骂。一句话：混乱）。读者可能想知道 ObjectOutputStream 和 ObjectInputStream 对象是怎样访问你的类中的 private 方法的。我们只能假设这正是序列化神奇的一部分。</p> <p>在接口中定义的所有东西都自动是 public 的，因此如果 writeObject() 和 readObject() 必须是 private 的，那么它们不会是接口的一部分。因为我们必须要完全遵循其方法特征签名，所以其效果就和实现了接口一样。</p> <p>在调用 ObjectOutputStream.writeObject() 时，会检查所传递的 Serializable 对象，看看是否实现了它自己的 writeObject()。如果是这样，就跳过正常的序列化过程并调用它的 writeObiect()。readObject() 的情形与此相同。</p> <p>还有另外一个技巧。在你的 writeObject() 内部，可以调用 defaultWriteObject() 来选择执行默认的 writeObject()。类似地，在 readObject() 内部，我们可以调用 defaultReadObject()，下面这个简单的例子演示了如何对一个 Serializable 对象的存储与恢复进行控制：</p> <div class=highlight><pre><span></span><code><span class=c1>// serialization/SerialCtl.java</span>
<span class=c1>// Controlling serialization by adding your own</span>
<span class=c1>// writeObject() and readObject() methods</span>
<span class=kn>import</span> <span class=nn>java.io.*</span><span class=p>;</span>
<span class=kd>public</span> <span class=kd>class</span> <span class=nc>SerialCtl</span> <span class=kd>implements</span> <span class=n>Serializable</span> <span class=p>{</span>
    <span class=kd>private</span> <span class=n>String</span> <span class=n>a</span><span class=p>;</span>
    <span class=kd>private</span> <span class=kd>transient</span> <span class=n>String</span> <span class=n>b</span><span class=p>;</span>
    <span class=kd>public</span> <span class=nf>SerialCtl</span><span class=p>(</span><span class=n>String</span> <span class=n>aa</span><span class=p>,</span> <span class=n>String</span> <span class=n>bb</span><span class=p>)</span> <span class=p>{</span>
        <span class=n>a</span> <span class=o>=</span> <span class=s>&quot;Not Transient: &quot;</span> <span class=o>+</span> <span class=n>aa</span><span class=p>;</span>
        <span class=n>b</span> <span class=o>=</span> <span class=s>&quot;Transient: &quot;</span> <span class=o>+</span> <span class=n>bb</span><span class=p>;</span>
    <span class=p>}</span>
    <span class=nd>@Override</span>
    <span class=kd>public</span> <span class=n>String</span> <span class=nf>toString</span><span class=p>()</span> <span class=p>{</span> <span class=k>return</span> <span class=n>a</span> <span class=o>+</span> <span class=s>&quot;\n&quot;</span> <span class=o>+</span> <span class=n>b</span><span class=p>;</span> <span class=p>}</span>
    <span class=kd>private</span> <span class=kt>void</span> <span class=nf>writeObject</span><span class=p>(</span><span class=n>ObjectOutputStream</span> <span class=n>stream</span><span class=p>)</span>
            <span class=kd>throws</span> <span class=n>IOException</span> <span class=p>{</span>
        <span class=n>stream</span><span class=p>.</span><span class=na>defaultWriteObject</span><span class=p>();</span>
        <span class=n>stream</span><span class=p>.</span><span class=na>writeObject</span><span class=p>(</span><span class=n>b</span><span class=p>);</span>
    <span class=p>}</span>
    <span class=kd>private</span> <span class=kt>void</span> <span class=nf>readObject</span><span class=p>(</span><span class=n>ObjectInputStream</span> <span class=n>stream</span><span class=p>)</span>
            <span class=kd>throws</span> <span class=n>IOException</span><span class=p>,</span> <span class=n>ClassNotFoundException</span> <span class=p>{</span>
        <span class=n>stream</span><span class=p>.</span><span class=na>defaultReadObject</span><span class=p>();</span>
        <span class=n>b</span> <span class=o>=</span> <span class=p>(</span><span class=n>String</span><span class=p>)</span><span class=n>stream</span><span class=p>.</span><span class=na>readObject</span><span class=p>();</span>
    <span class=p>}</span>
    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=p>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=p>)</span> <span class=p>{</span>
        <span class=n>SerialCtl</span> <span class=n>sc</span> <span class=o>=</span> <span class=k>new</span> <span class=n>SerialCtl</span><span class=p>(</span><span class=s>&quot;Test1&quot;</span><span class=p>,</span> <span class=s>&quot;Test2&quot;</span><span class=p>);</span>
        <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&quot;Before:\n&quot;</span> <span class=o>+</span> <span class=n>sc</span><span class=p>);</span>
        <span class=k>try</span> <span class=p>(</span>
                <span class=n>ByteArrayOutputStream</span> <span class=n>buf</span> <span class=o>=</span>
                        <span class=k>new</span> <span class=n>ByteArrayOutputStream</span><span class=p>();</span>
                <span class=n>ObjectOutputStream</span> <span class=n>o</span> <span class=o>=</span>
                        <span class=k>new</span> <span class=n>ObjectOutputStream</span><span class=p>(</span><span class=n>buf</span><span class=p>);</span>
        <span class=p>)</span> <span class=p>{</span>
            <span class=n>o</span><span class=p>.</span><span class=na>writeObject</span><span class=p>(</span><span class=n>sc</span><span class=p>);</span>
<span class=c1>// Now get it back:</span>
            <span class=k>try</span> <span class=p>(</span>
                    <span class=n>ObjectInputStream</span> <span class=n>in</span> <span class=o>=</span>
                            <span class=k>new</span> <span class=n>ObjectInputStream</span><span class=p>(</span>
                                    <span class=k>new</span> <span class=n>ByteArrayInputStream</span><span class=p>(</span>
                                            <span class=n>buf</span><span class=p>.</span><span class=na>toByteArray</span><span class=p>()));</span>
            <span class=p>)</span> <span class=p>{</span>
                <span class=n>SerialCtl</span> <span class=n>sc2</span> <span class=o>=</span> <span class=p>(</span><span class=n>SerialCtl</span><span class=p>)</span><span class=n>in</span><span class=p>.</span><span class=na>readObject</span><span class=p>();</span>
                <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&quot;After:\n&quot;</span> <span class=o>+</span> <span class=n>sc2</span><span class=p>);</span>
            <span class=p>}</span>
        <span class=p>}</span> <span class=k>catch</span><span class=p>(</span><span class=n>IOException</span> <span class=o>|</span> <span class=n>ClassNotFoundException</span> <span class=n>e</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>throw</span> <span class=k>new</span> <span class=n>RuntimeException</span><span class=p>(</span><span class=n>e</span><span class=p>);</span>
        <span class=p>}</span>
    <span class=p>}</span>
<span class=p>}</span>
</code></pre></div> <p>输出为：</p> <div class=highlight><pre><span></span><code>Before:
Not Transient: Test1
Transient: Test2
After:
Not Transient: Test1
Transient: Test2
</code></pre></div> <p>在这个例子中，有一个 String 字段是普通字段，而另一个是 transient 字段，用来证明非 transient 字段由 defaultWriteObject() 方法保存，而 transient 字段必须在程序中明确保存和恢复。字段是在构造器内部而不是在定义处进行初始化的，以此可以证实它们在反序列化还原期间没有被一些自动化机制初始化。</p> <p>如果我们打算使用默认机制写入对象的非 transient 部分，那么必须调用 defaultwriteObject() 作为 writeObject() 中的第一个操作，并让 defaultReadObject() 作为 readObject() 中的第一个操作。这些都是奇怪的方法调用。例如，如果我们正在为 ObjectOutputStream 调用 defaultWriteObject() 且没有传递任何参数，然而不知何故它却可以运行，并且知道对象的引用以及如何写入非 transient 部分。真是奇怪之极。</p> <p>对 transient 对象的存储和恢复使用了我们比较熟悉的代码。请再考虑一下在这里所发生的事情。在 main0）中，创建 SerialCtl 对象，然后将其序列化到 ObjectOutputStream（注意在这种情况下，使用的是缓冲区而不是文件-这对于 ObjectOutputStream 来说是完全一样的）。序列化发生在下面这行代码当中</p> <div class=highlight><pre><span></span><code><span class=n>o</span><span class=p>.</span><span class=na>writeObject</span><span class=p>(</span><span class=n>sc</span><span class=p>);</span>
</code></pre></div> <p>writeObject() 方法必须检查 sc，判断它是否拥有自己的 writeObject() 方法（不是检查接口——这里根本就没有接口，也不是检查类的类型，而是利用反射来真正地搜索方法）。如果有，那么就会使用它。对 readObject() 也采用了类似的方法。或许这是解决这个问题的唯一切实可行的方法，但它确实有点古怪。</p> <h3 id=_4>版本控制<a class=headerlink href=#_4 title="Permanent link">#</a></h3> <p>有时可能想要改变可序列化类的版本（比如源类的对象可能保存在数据库中）。虽然 Java 支持这种做法，但是你可能只在特殊的情况下才这样做，此外，还需要对它有相当深程度的了解（在这里我们就不再试图达到这一点）。从 <a href=http://java.oracle.com>http://java.oracle.com</a> 下的 JDK 文档中对这一主题进行了非常彻底的论述。</p> <!-- Using Persistence --> <h2 id=_5>使用持久化<a class=headerlink href=#_5 title="Permanent link">#</a></h2> <p>个比较诱人的使用序列化技术的想法是：存储程序的一些状态，以便我们随后可以很容易地将程序恢复到当前状态。但是在我们能够这样做之前，必须回答几个问题。如果我们将两个对象-它们都具有指向第三个对象的引用-进行序列化，会发生什么情况？当我们从它们的序列化状态恢复这两个对象时，第三个对象会只出现一次吗？如果将这两个对象序列化成独立的文件，然后在代码的不同部分对它们进行反序列化还原，又会怎样呢？</p> <p>下面这个例子说明了上述问题：</p> <div class=highlight><pre><span></span><code><span class=c1>// serialization/MyWorld.java</span>
<span class=kn>import</span> <span class=nn>java.io.*</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>java.util.*</span><span class=p>;</span>
<span class=kd>class</span> <span class=nc>House</span> <span class=kd>implements</span> <span class=n>Serializable</span> <span class=p>{}</span>
<span class=kd>class</span> <span class=nc>Animal</span> <span class=kd>implements</span> <span class=n>Serializable</span> <span class=p>{</span>
    <span class=kd>private</span> <span class=n>String</span> <span class=n>name</span><span class=p>;</span>
    <span class=kd>private</span> <span class=n>House</span> <span class=n>preferredHouse</span><span class=p>;</span>
    <span class=n>Animal</span><span class=p>(</span><span class=n>String</span> <span class=n>nm</span><span class=p>,</span> <span class=n>House</span> <span class=n>h</span><span class=p>)</span> <span class=p>{</span>
        <span class=n>name</span> <span class=o>=</span> <span class=n>nm</span><span class=p>;</span>
        <span class=n>preferredHouse</span> <span class=o>=</span> <span class=n>h</span><span class=p>;</span>
    <span class=p>}</span>
    <span class=nd>@Override</span>
    <span class=kd>public</span> <span class=n>String</span> <span class=nf>toString</span><span class=p>()</span> <span class=p>{</span>
        <span class=k>return</span> <span class=n>name</span> <span class=o>+</span> <span class=s>&quot;[&quot;</span> <span class=o>+</span> <span class=kd>super</span><span class=p>.</span><span class=na>toString</span><span class=p>()</span> <span class=o>+</span>
                <span class=s>&quot;], &quot;</span> <span class=o>+</span> <span class=n>preferredHouse</span> <span class=o>+</span> <span class=s>&quot;\n&quot;</span><span class=p>;</span>
    <span class=p>}</span>
<span class=p>}</span>
<span class=kd>public</span> <span class=kd>class</span> <span class=nc>MyWorld</span> <span class=p>{</span>
    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=p>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=p>)</span> <span class=p>{</span>
        <span class=n>House</span> <span class=n>house</span> <span class=o>=</span> <span class=k>new</span> <span class=n>House</span><span class=p>();</span>
        <span class=n>List</span><span class=o>&lt;</span><span class=n>Animal</span><span class=o>&gt;</span> <span class=n>animals</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ArrayList</span><span class=o>&lt;&gt;</span><span class=p>();</span>
        <span class=n>animals</span><span class=p>.</span><span class=na>add</span><span class=p>(</span>
                <span class=k>new</span> <span class=n>Animal</span><span class=p>(</span><span class=s>&quot;Bosco the dog&quot;</span><span class=p>,</span> <span class=n>house</span><span class=p>));</span>
        <span class=n>animals</span><span class=p>.</span><span class=na>add</span><span class=p>(</span>
                <span class=k>new</span> <span class=n>Animal</span><span class=p>(</span><span class=s>&quot;Ralph the hamster&quot;</span><span class=p>,</span> <span class=n>house</span><span class=p>));</span>
        <span class=n>animals</span><span class=p>.</span><span class=na>add</span><span class=p>(</span>
                <span class=k>new</span> <span class=n>Animal</span><span class=p>(</span><span class=s>&quot;Molly the cat&quot;</span><span class=p>,</span> <span class=n>house</span><span class=p>));</span>
        <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&quot;animals: &quot;</span> <span class=o>+</span> <span class=n>animals</span><span class=p>);</span>
        <span class=k>try</span><span class=p>(</span>
                <span class=n>ByteArrayOutputStream</span> <span class=n>buf1</span> <span class=o>=</span>
                        <span class=k>new</span> <span class=n>ByteArrayOutputStream</span><span class=p>();</span>
                <span class=n>ObjectOutputStream</span> <span class=n>o1</span> <span class=o>=</span>
                        <span class=k>new</span> <span class=n>ObjectOutputStream</span><span class=p>(</span><span class=n>buf1</span><span class=p>)</span>
        <span class=p>)</span> <span class=p>{</span>
            <span class=n>o1</span><span class=p>.</span><span class=na>writeObject</span><span class=p>(</span><span class=n>animals</span><span class=p>);</span>
            <span class=n>o1</span><span class=p>.</span><span class=na>writeObject</span><span class=p>(</span><span class=n>animals</span><span class=p>);</span> <span class=c1>// Write a 2nd set</span>
<span class=c1>// Write to a different stream:</span>
            <span class=k>try</span><span class=p>(</span>
                    <span class=n>ByteArrayOutputStream</span> <span class=n>buf2</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ByteArrayOutputStream</span><span class=p>();</span>
                    <span class=n>ObjectOutputStream</span> <span class=n>o2</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ObjectOutputStream</span><span class=p>(</span><span class=n>buf2</span><span class=p>)</span>
            <span class=p>)</span> <span class=p>{</span>
                <span class=n>o2</span><span class=p>.</span><span class=na>writeObject</span><span class=p>(</span><span class=n>animals</span><span class=p>);</span>
<span class=c1>// Now get them back:</span>
                <span class=k>try</span><span class=p>(</span>
                        <span class=n>ObjectInputStream</span> <span class=n>in1</span> <span class=o>=</span>
                                <span class=k>new</span> <span class=n>ObjectInputStream</span><span class=p>(</span>
                                        <span class=k>new</span> <span class=n>ByteArrayInputStream</span><span class=p>(</span>
                                                <span class=n>buf1</span><span class=p>.</span><span class=na>toByteArray</span><span class=p>()));</span>
                        <span class=n>ObjectInputStream</span> <span class=n>in2</span> <span class=o>=</span>
                                <span class=k>new</span> <span class=n>ObjectInputStream</span><span class=p>(</span>
                                        <span class=k>new</span> <span class=n>ByteArrayInputStream</span><span class=p>(</span>
                                                <span class=n>buf2</span><span class=p>.</span><span class=na>toByteArray</span><span class=p>()))</span>
                <span class=p>)</span> <span class=p>{</span>
                    <span class=n>List</span>
                            <span class=n>animals1</span> <span class=o>=</span> <span class=p>(</span><span class=n>List</span><span class=p>)</span><span class=n>in1</span><span class=p>.</span><span class=na>readObject</span><span class=p>(),</span>
                            <span class=n>animals2</span> <span class=o>=</span> <span class=p>(</span><span class=n>List</span><span class=p>)</span><span class=n>in1</span><span class=p>.</span><span class=na>readObject</span><span class=p>(),</span>
                            <span class=n>animals3</span> <span class=o>=</span> <span class=p>(</span><span class=n>List</span><span class=p>)</span><span class=n>in2</span><span class=p>.</span><span class=na>readObject</span><span class=p>();</span>
                    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span>
                            <span class=s>&quot;animals1: &quot;</span> <span class=o>+</span> <span class=n>animals1</span><span class=p>);</span>
                    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span>
                            <span class=s>&quot;animals2: &quot;</span> <span class=o>+</span> <span class=n>animals2</span><span class=p>);</span>
                    <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span>
                            <span class=s>&quot;animals3: &quot;</span> <span class=o>+</span> <span class=n>animals3</span><span class=p>);</span>
                <span class=p>}</span>
            <span class=p>}</span>
        <span class=p>}</span> <span class=k>catch</span><span class=p>(</span><span class=n>IOException</span> <span class=o>|</span> <span class=n>ClassNotFoundException</span> <span class=n>e</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>throw</span> <span class=k>new</span> <span class=n>RuntimeException</span><span class=p>(</span><span class=n>e</span><span class=p>);</span>
        <span class=p>}</span>
    <span class=p>}</span>
<span class=p>}</span>
</code></pre></div> <p>输出为：</p> <div class=highlight><pre><span></span><code>animals: [Bosco the dog[Animal@15db9742],
House@6d06d69c
, Ralph the hamster[Animal@7852e922], House@6d06d69c
, Molly the cat[Animal@4e25154f], House@6d06d69c
]
animals1: [Bosco the dog[Animal@7ba4f24f],
House@3b9a45b3
, Ralph the hamster[Animal@7699a589], House@3b9a45b3
, Molly the cat[Animal@58372a00], House@3b9a45b3
]
animals2: [Bosco the dog[Animal@7ba4f24f],
House@3b9a45b3
, Ralph the hamster[Animal@7699a589], House@3b9a45b3
, Molly the cat[Animal@58372a00], House@3b9a45b3
]
animals3: [Bosco the dog[Animal@4dd8dc3],
House@6d03e736
, Ralph the hamster[Animal@568db2f2], House@6d03e736
, Molly the cat[Animal@378bf509], House@6d03e736
]
</code></pre></div> <p>这里有一件有趣的事：我们可以通过一个字节数组来使用对象序列化，从而实现对任何可 Serializable 对象的“深度复制"（deep copy）—— 深度复制意味着我们复制的是整个对象网，而不仅仅是基本对象及其引用。复制对象将在本书的 <a href>附录：传递和返回对象 </a> 一章中进行深入地探讨。</p> <p>在这个例子中，Animal 对象包含有 House 类型的字段。在 main() 方法中，创建了一个 Animal 列表并将其两次序列化，分别送至不同的流。当其被反序列化还原并被打印时，我们可以看到所示的执行某次运行后的结果（每次运行时，对象将会处在不同的内存地址）。</p> <p>当然，我们期望这些反序列化还原后的对象地址与原来的地址不同。但请注意，在 animals1 和 animals2 中却出现了相同的地址，包括二者共享的那个指向 House 对象的引用。另一方面，当恢复 animals3 时，系统无法知道另一个流内的对象是第一个流内的对象的别名，因此它会产生出完全不同的对象网。</p> <p>只要将任何对象序列化到单一流中，就可以恢复出与我们写出时一样的对象网，并且没有任何意外重复复制出的对象。当然，我们可以在写出第一个对象和写出最后一个对象期间改变这些对象的状态，但是这是我们自己的事，无论对象在被序列化时处于什么状态（无论它们和其他对象有什么样的连接关系），它们都可以被写出。</p> <p>最安全的做法是将其作为“原子”操作进行序列化。如果我们序列化了某些东西，再去做其他一些工作，再来序列化更多的东西，如此等等，那么将无法安全地保存系统状态。取而代之的是，将构成系统状态的所有对象都置入单一容器内，并在一个操作中将该容器直接写出。然后同样只需一次方法调用，即可以将其恢复。</p> <p>下面这个例子是一个想象的计算机辅助设计（CAD）系统，该例演示了这一方法。此外，它还引入了 static 字段的问题：如果我们查看 JDK 文档，就会发现 Class 是 Serializable 的，因此只需直接对 Class 对象序列化，就可以很容易地保存 static 字段。在任何情况下，这都是一种明智的做法。</p> <div class=highlight><pre><span></span><code><span class=c1>// serialization/AStoreCADState.java</span>
<span class=c1>// Saving the state of a fictitious CAD system</span>
<span class=kn>import</span> <span class=nn>java.io.*</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>java.util.*</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>java.util.stream.*</span><span class=p>;</span>
<span class=kd>enum</span> <span class=n>Color</span> <span class=p>{</span> <span class=n>RED</span><span class=p>,</span> <span class=n>BLUE</span><span class=p>,</span> <span class=n>GREEN</span> <span class=p>}</span>
<span class=kd>abstract</span> <span class=kd>class</span> <span class=nc>Shape</span> <span class=kd>implements</span> <span class=n>Serializable</span> <span class=p>{</span>
    <span class=kd>private</span> <span class=kt>int</span> <span class=n>xPos</span><span class=p>,</span> <span class=n>yPos</span><span class=p>,</span> <span class=n>dimension</span><span class=p>;</span>
    <span class=kd>private</span> <span class=kd>static</span> <span class=n>Random</span> <span class=n>rand</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Random</span><span class=p>(</span><span class=mi>47</span><span class=p>);</span>
    <span class=kd>private</span> <span class=kd>static</span> <span class=kt>int</span> <span class=n>counter</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
    <span class=kd>public</span> <span class=kd>abstract</span> <span class=kt>void</span> <span class=nf>setColor</span><span class=p>(</span><span class=n>Color</span> <span class=n>newColor</span><span class=p>);</span>
    <span class=kd>public</span> <span class=kd>abstract</span> <span class=n>Color</span> <span class=nf>getColor</span><span class=p>();</span>
    <span class=n>Shape</span><span class=p>(</span><span class=kt>int</span> <span class=n>xVal</span><span class=p>,</span> <span class=kt>int</span> <span class=n>yVal</span><span class=p>,</span> <span class=kt>int</span> <span class=n>dim</span><span class=p>)</span> <span class=p>{</span>
        <span class=n>xPos</span> <span class=o>=</span> <span class=n>xVal</span><span class=p>;</span>
        <span class=n>yPos</span> <span class=o>=</span> <span class=n>yVal</span><span class=p>;</span>
        <span class=n>dimension</span> <span class=o>=</span> <span class=n>dim</span><span class=p>;</span>
    <span class=p>}</span>
    <span class=kd>public</span> <span class=n>String</span> <span class=nf>toString</span><span class=p>()</span> <span class=p>{</span>
        <span class=k>return</span> <span class=n>getClass</span><span class=p>()</span> <span class=o>+</span> <span class=s>&quot;color[&quot;</span> <span class=o>+</span> <span class=n>getColor</span><span class=p>()</span> <span class=o>+</span>
                <span class=s>&quot;] xPos[&quot;</span> <span class=o>+</span> <span class=n>xPos</span> <span class=o>+</span> <span class=s>&quot;] yPos[&quot;</span> <span class=o>+</span> <span class=n>yPos</span> <span class=o>+</span>
                <span class=s>&quot;] dim[&quot;</span> <span class=o>+</span> <span class=n>dimension</span> <span class=o>+</span> <span class=s>&quot;]\n&quot;</span><span class=p>;</span>
    <span class=p>}</span>
    <span class=kd>public</span> <span class=kd>static</span> <span class=n>Shape</span> <span class=nf>randomFactory</span><span class=p>()</span> <span class=p>{</span>
        <span class=kt>int</span> <span class=n>xVal</span> <span class=o>=</span> <span class=n>rand</span><span class=p>.</span><span class=na>nextInt</span><span class=p>(</span><span class=mi>100</span><span class=p>);</span>
        <span class=kt>int</span> <span class=n>yVal</span> <span class=o>=</span> <span class=n>rand</span><span class=p>.</span><span class=na>nextInt</span><span class=p>(</span><span class=mi>100</span><span class=p>);</span>
        <span class=kt>int</span> <span class=n>dim</span> <span class=o>=</span> <span class=n>rand</span><span class=p>.</span><span class=na>nextInt</span><span class=p>(</span><span class=mi>100</span><span class=p>);</span>
        <span class=k>switch</span><span class=p>(</span><span class=n>counter</span><span class=o>++</span> <span class=o>%</span> <span class=mi>3</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>default</span><span class=p>:</span>
            <span class=k>case</span> <span class=mi>0</span><span class=p>:</span> <span class=k>return</span> <span class=k>new</span> <span class=n>Circle</span><span class=p>(</span><span class=n>xVal</span><span class=p>,</span> <span class=n>yVal</span><span class=p>,</span> <span class=n>dim</span><span class=p>);</span>
            <span class=k>case</span> <span class=mi>1</span><span class=p>:</span> <span class=k>return</span> <span class=k>new</span> <span class=n>Square</span><span class=p>(</span><span class=n>xVal</span><span class=p>,</span> <span class=n>yVal</span><span class=p>,</span> <span class=n>dim</span><span class=p>);</span>
            <span class=k>case</span> <span class=mi>2</span><span class=p>:</span> <span class=k>return</span> <span class=k>new</span> <span class=n>Line</span><span class=p>(</span><span class=n>xVal</span><span class=p>,</span> <span class=n>yVal</span><span class=p>,</span> <span class=n>dim</span><span class=p>);</span>
        <span class=p>}</span>
    <span class=p>}</span>
<span class=p>}</span>
<span class=kd>class</span> <span class=nc>Circle</span> <span class=kd>extends</span> <span class=n>Shape</span> <span class=p>{</span>
    <span class=kd>private</span> <span class=kd>static</span> <span class=n>Color</span> <span class=n>color</span> <span class=o>=</span> <span class=n>Color</span><span class=p>.</span><span class=na>RED</span><span class=p>;</span>
    <span class=n>Circle</span><span class=p>(</span><span class=kt>int</span> <span class=n>xVal</span><span class=p>,</span> <span class=kt>int</span> <span class=n>yVal</span><span class=p>,</span> <span class=kt>int</span> <span class=n>dim</span><span class=p>)</span> <span class=p>{</span>
        <span class=kd>super</span><span class=p>(</span><span class=n>xVal</span><span class=p>,</span> <span class=n>yVal</span><span class=p>,</span> <span class=n>dim</span><span class=p>);</span>
    <span class=p>}</span>
    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>setColor</span><span class=p>(</span><span class=n>Color</span> <span class=n>newColor</span><span class=p>)</span> <span class=p>{</span>
        <span class=n>color</span> <span class=o>=</span> <span class=n>newColor</span><span class=p>;</span>
    <span class=p>}</span>
    <span class=kd>public</span> <span class=n>Color</span> <span class=nf>getColor</span><span class=p>()</span> <span class=p>{</span> <span class=k>return</span> <span class=n>color</span><span class=p>;</span> <span class=p>}</span>
<span class=p>}</span>
<span class=kd>class</span> <span class=nc>Square</span> <span class=kd>extends</span> <span class=n>Shape</span> <span class=p>{</span>
    <span class=kd>private</span> <span class=kd>static</span> <span class=n>Color</span> <span class=n>color</span> <span class=o>=</span> <span class=n>Color</span><span class=p>.</span><span class=na>RED</span><span class=p>;</span>
    <span class=n>Square</span><span class=p>(</span><span class=kt>int</span> <span class=n>xVal</span><span class=p>,</span> <span class=kt>int</span> <span class=n>yVal</span><span class=p>,</span> <span class=kt>int</span> <span class=n>dim</span><span class=p>)</span> <span class=p>{</span>
        <span class=kd>super</span><span class=p>(</span><span class=n>xVal</span><span class=p>,</span> <span class=n>yVal</span><span class=p>,</span> <span class=n>dim</span><span class=p>);</span>
    <span class=p>}</span>
    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>setColor</span><span class=p>(</span><span class=n>Color</span> <span class=n>newColor</span><span class=p>)</span> <span class=p>{</span>
        <span class=n>color</span> <span class=o>=</span> <span class=n>newColor</span><span class=p>;</span>
    <span class=p>}</span>
    <span class=kd>public</span> <span class=n>Color</span> <span class=nf>getColor</span><span class=p>()</span> <span class=p>{</span> <span class=k>return</span> <span class=n>color</span><span class=p>;</span> <span class=p>}</span>
<span class=p>}</span>
<span class=kd>class</span> <span class=nc>Line</span> <span class=kd>extends</span> <span class=n>Shape</span> <span class=p>{</span>
    <span class=kd>private</span> <span class=kd>static</span> <span class=n>Color</span> <span class=n>color</span> <span class=o>=</span> <span class=n>Color</span><span class=p>.</span><span class=na>RED</span><span class=p>;</span>
    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span>
    <span class=nf>serializeStaticState</span><span class=p>(</span><span class=n>ObjectOutputStream</span> <span class=n>os</span><span class=p>)</span>
            <span class=kd>throws</span> <span class=n>IOException</span> <span class=p>{</span> <span class=n>os</span><span class=p>.</span><span class=na>writeObject</span><span class=p>(</span><span class=n>color</span><span class=p>);</span> <span class=p>}</span>
    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span>
    <span class=nf>deserializeStaticState</span><span class=p>(</span><span class=n>ObjectInputStream</span> <span class=n>os</span><span class=p>)</span>
            <span class=kd>throws</span> <span class=n>IOException</span><span class=p>,</span> <span class=n>ClassNotFoundException</span> <span class=p>{</span>
        <span class=n>color</span> <span class=o>=</span> <span class=p>(</span><span class=n>Color</span><span class=p>)</span><span class=n>os</span><span class=p>.</span><span class=na>readObject</span><span class=p>();</span>
    <span class=p>}</span>
    <span class=n>Line</span><span class=p>(</span><span class=kt>int</span> <span class=n>xVal</span><span class=p>,</span> <span class=kt>int</span> <span class=n>yVal</span><span class=p>,</span> <span class=kt>int</span> <span class=n>dim</span><span class=p>)</span> <span class=p>{</span>
        <span class=kd>super</span><span class=p>(</span><span class=n>xVal</span><span class=p>,</span> <span class=n>yVal</span><span class=p>,</span> <span class=n>dim</span><span class=p>);</span>
    <span class=p>}</span>
    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>setColor</span><span class=p>(</span><span class=n>Color</span> <span class=n>newColor</span><span class=p>)</span> <span class=p>{</span>
        <span class=n>color</span> <span class=o>=</span> <span class=n>newColor</span><span class=p>;</span>
    <span class=p>}</span>
    <span class=kd>public</span> <span class=n>Color</span> <span class=nf>getColor</span><span class=p>()</span> <span class=p>{</span> <span class=k>return</span> <span class=n>color</span><span class=p>;</span> <span class=p>}</span>
<span class=p>}</span>
<span class=kd>public</span> <span class=kd>class</span> <span class=nc>AStoreCADState</span> <span class=p>{</span>
    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=p>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=p>)</span> <span class=p>{</span>
        <span class=n>List</span><span class=o>&lt;</span><span class=n>Class</span><span class=o>&lt;?</span> <span class=kd>extends</span> <span class=n>Shape</span><span class=o>&gt;&gt;</span> <span class=n>shapeTypes</span> <span class=o>=</span>
                <span class=n>Arrays</span><span class=p>.</span><span class=na>asList</span><span class=p>(</span>
                        <span class=n>Circle</span><span class=p>.</span><span class=na>class</span><span class=p>,</span> <span class=n>Square</span><span class=p>.</span><span class=na>class</span><span class=p>,</span> <span class=n>Line</span><span class=p>.</span><span class=na>class</span><span class=p>);</span>
        <span class=n>List</span><span class=o>&lt;</span><span class=n>Shape</span><span class=o>&gt;</span> <span class=n>shapes</span> <span class=o>=</span> <span class=n>IntStream</span><span class=p>.</span><span class=na>range</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>10</span><span class=p>)</span>
                <span class=p>.</span><span class=na>mapToObj</span><span class=p>(</span><span class=n>i</span> <span class=o>-&gt;</span> <span class=n>Shape</span><span class=p>.</span><span class=na>randomFactory</span><span class=p>())</span>
                <span class=p>.</span><span class=na>collect</span><span class=p>(</span><span class=n>Collectors</span><span class=p>.</span><span class=na>toList</span><span class=p>());</span>
        <span class=c1>// Set all the static colors to GREEN:</span>
        <span class=n>shapes</span><span class=p>.</span><span class=na>forEach</span><span class=p>(</span><span class=n>s</span> <span class=o>-&gt;</span> <span class=n>s</span><span class=p>.</span><span class=na>setColor</span><span class=p>(</span><span class=n>Color</span><span class=p>.</span><span class=na>GREEN</span><span class=p>));</span>
        <span class=c1>// Save the state vector:</span>
        <span class=k>try</span><span class=p>(</span>
                <span class=n>ObjectOutputStream</span> <span class=n>out</span> <span class=o>=</span>
                        <span class=k>new</span> <span class=n>ObjectOutputStream</span><span class=p>(</span>
                                <span class=k>new</span> <span class=n>FileOutputStream</span><span class=p>(</span><span class=s>&quot;CADState.dat&quot;</span><span class=p>))</span>
        <span class=p>)</span> <span class=p>{</span>
            <span class=n>out</span><span class=p>.</span><span class=na>writeObject</span><span class=p>(</span><span class=n>shapeTypes</span><span class=p>);</span>
            <span class=n>Line</span><span class=p>.</span><span class=na>serializeStaticState</span><span class=p>(</span><span class=n>out</span><span class=p>);</span>
            <span class=n>out</span><span class=p>.</span><span class=na>writeObject</span><span class=p>(</span><span class=n>shapes</span><span class=p>);</span>
        <span class=p>}</span> <span class=k>catch</span><span class=p>(</span><span class=n>IOException</span> <span class=n>e</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>throw</span> <span class=k>new</span> <span class=n>RuntimeException</span><span class=p>(</span><span class=n>e</span><span class=p>);</span>
        <span class=p>}</span>
        <span class=c1>// Display the shapes:</span>
        <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>shapes</span><span class=p>);</span>
    <span class=p>}</span>
<span class=p>}</span>
</code></pre></div> <p>输出为：</p> <div class=highlight><pre><span></span><code><span class=o>[</span><span class=kd>class</span> <span class=nc>Circlecolor</span><span class=o>[</span><span class=n>GREEN</span><span class=o>]</span> <span class=n>xPos</span><span class=o>[</span><span class=mi>58</span><span class=o>]</span> <span class=n>yPos</span><span class=o>[</span><span class=mi>55</span><span class=o>]</span> <span class=n>dim</span><span class=o>[</span><span class=mi>93</span><span class=o>]</span>
<span class=p>,</span> <span class=kd>class</span> <span class=nc>Squarecolor</span><span class=o>[</span><span class=n>GREEN</span><span class=o>]</span> <span class=n>xPos</span><span class=o>[</span><span class=mi>61</span><span class=o>]</span> <span class=n>yPos</span><span class=o>[</span><span class=mi>61</span><span class=o>]</span> <span class=n>dim</span><span class=o>[</span><span class=mi>29</span><span class=o>]</span>
<span class=p>,</span> <span class=kd>class</span> <span class=nc>Linecolor</span><span class=o>[</span><span class=n>GREEN</span><span class=o>]</span> <span class=n>xPos</span><span class=o>[</span><span class=mi>68</span><span class=o>]</span> <span class=n>yPos</span><span class=o>[</span><span class=mi>0</span><span class=o>]</span> <span class=n>dim</span><span class=o>[</span><span class=mi>22</span><span class=o>]</span>
<span class=p>,</span> <span class=kd>class</span> <span class=nc>Circlecolor</span><span class=o>[</span><span class=n>GREEN</span><span class=o>]</span> <span class=n>xPos</span><span class=o>[</span><span class=mi>7</span><span class=o>]</span> <span class=n>yPos</span><span class=o>[</span><span class=mi>88</span><span class=o>]</span> <span class=n>dim</span><span class=o>[</span><span class=mi>28</span><span class=o>]</span>
<span class=p>,</span> <span class=kd>class</span> <span class=nc>Squarecolor</span><span class=o>[</span><span class=n>GREEN</span><span class=o>]</span> <span class=n>xPos</span><span class=o>[</span><span class=mi>51</span><span class=o>]</span> <span class=n>yPos</span><span class=o>[</span><span class=mi>89</span><span class=o>]</span> <span class=n>dim</span><span class=o>[</span><span class=mi>9</span><span class=o>]</span>
<span class=p>,</span> <span class=kd>class</span> <span class=nc>Linecolor</span><span class=o>[</span><span class=n>GREEN</span><span class=o>]</span> <span class=n>xPos</span><span class=o>[</span><span class=mi>78</span><span class=o>]</span> <span class=n>yPos</span><span class=o>[</span><span class=mi>98</span><span class=o>]</span> <span class=n>dim</span><span class=o>[</span><span class=mi>61</span><span class=o>]</span>
<span class=p>,</span> <span class=kd>class</span> <span class=nc>Circlecolor</span><span class=o>[</span><span class=n>GREEN</span><span class=o>]</span> <span class=n>xPos</span><span class=o>[</span><span class=mi>20</span><span class=o>]</span> <span class=n>yPos</span><span class=o>[</span><span class=mi>58</span><span class=o>]</span> <span class=n>dim</span><span class=o>[</span><span class=mi>16</span><span class=o>]</span>
<span class=p>,</span> <span class=kd>class</span> <span class=nc>Squarecolor</span><span class=o>[</span><span class=n>GREEN</span><span class=o>]</span> <span class=n>xPos</span><span class=o>[</span><span class=mi>40</span><span class=o>]</span> <span class=n>yPos</span><span class=o>[</span><span class=mi>11</span><span class=o>]</span> <span class=n>dim</span><span class=o>[</span><span class=mi>22</span><span class=o>]</span>
<span class=p>,</span> <span class=kd>class</span> <span class=nc>Linecolor</span><span class=o>[</span><span class=n>GREEN</span><span class=o>]</span> <span class=n>xPos</span><span class=o>[</span><span class=mi>4</span><span class=o>]</span> <span class=n>yPos</span><span class=o>[</span><span class=mi>83</span><span class=o>]</span> <span class=n>dim</span><span class=o>[</span><span class=mi>6</span><span class=o>]</span>
<span class=p>,</span> <span class=kd>class</span> <span class=nc>Circlecolor</span><span class=o>[</span><span class=n>GREEN</span><span class=o>]</span> <span class=n>xPos</span><span class=o>[</span><span class=mi>75</span><span class=o>]</span> <span class=n>yPos</span><span class=o>[</span><span class=mi>10</span><span class=o>]</span> <span class=n>dim</span><span class=o>[</span><span class=mi>42</span><span class=o>]</span>
<span class=o>]</span>
</code></pre></div> <p>Shape 类实现了 Serializable，所以任何自 Shape 继承的类也都会自动是 Serializable 的。每个 Shape 都含有数据，而且每个派生自 Shape 的类都包含一个 static 字段，用来确定各种 Shape 类型的颜色（如果将 static 字段置入基类，只会产生一个 static 字段，因为 static 字段不能在派生类中复制）。可对基类中的方法进行重载，以便为不同的类型设置颜色（static 方法不会动态绑定，所以这些都是普通的方法）。每次调用 randomFactory() 方法时，它都会使用不同的随机数作为 Shape 的数据，从而创建不同的 Shape。</p> <p>在 main() 中，一个 ArrayList 用于保存 Class 对象，而另一个用于保存几何形状。</p> <p>恢复对象相当直观：</p> <div class=highlight><pre><span></span><code><span class=c1>// serialization/RecoverCADState.java</span>
<span class=c1>// Restoring the state of the fictitious CAD system</span>
<span class=c1>// {RunFirst: AStoreCADState}</span>
<span class=kn>import</span> <span class=nn>java.io.*</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>java.util.*</span><span class=p>;</span>
<span class=kd>public</span> <span class=kd>class</span> <span class=nc>RecoverCADState</span> <span class=p>{</span>
    <span class=nd>@SuppressWarnings</span><span class=p>(</span><span class=s>&quot;unchecked&quot;</span><span class=p>)</span>
    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=p>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=p>)</span> <span class=p>{</span>
        <span class=k>try</span><span class=p>(</span>
                <span class=n>ObjectInputStream</span> <span class=n>in</span> <span class=o>=</span>
                        <span class=k>new</span> <span class=n>ObjectInputStream</span><span class=p>(</span>
                                <span class=k>new</span> <span class=n>FileInputStream</span><span class=p>(</span><span class=s>&quot;CADState.dat&quot;</span><span class=p>))</span>
        <span class=p>)</span> <span class=p>{</span>
<span class=c1>// Read in the same order they were written:</span>
            <span class=n>List</span><span class=o>&lt;</span><span class=n>Class</span><span class=o>&lt;?</span> <span class=kd>extends</span> <span class=n>Shape</span><span class=o>&gt;&gt;</span> <span class=n>shapeTypes</span> <span class=o>=</span>
                    <span class=p>(</span><span class=n>List</span><span class=o>&lt;</span><span class=n>Class</span><span class=o>&lt;?</span> <span class=kd>extends</span> <span class=n>Shape</span><span class=o>&gt;&gt;</span><span class=p>)</span><span class=n>in</span><span class=p>.</span><span class=na>readObject</span><span class=p>();</span>
            <span class=n>Line</span><span class=p>.</span><span class=na>deserializeStaticState</span><span class=p>(</span><span class=n>in</span><span class=p>);</span>
            <span class=n>List</span><span class=o>&lt;</span><span class=n>Shape</span><span class=o>&gt;</span> <span class=n>shapes</span> <span class=o>=</span>
                    <span class=p>(</span><span class=n>List</span><span class=o>&lt;</span><span class=n>Shape</span><span class=o>&gt;</span><span class=p>)</span><span class=n>in</span><span class=p>.</span><span class=na>readObject</span><span class=p>();</span>
            <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>shapes</span><span class=p>);</span>
        <span class=p>}</span> <span class=k>catch</span><span class=p>(</span><span class=n>IOException</span> <span class=o>|</span> <span class=n>ClassNotFoundException</span> <span class=n>e</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>throw</span> <span class=k>new</span> <span class=n>RuntimeException</span><span class=p>(</span><span class=n>e</span><span class=p>);</span>
        <span class=p>}</span>
    <span class=p>}</span>
<span class=p>}</span>
</code></pre></div> <p>输出为：</p> <div class=highlight><pre><span></span><code><span class=o>[</span><span class=kd>class</span> <span class=nc>Circlecolor</span><span class=o>[</span><span class=n>RED</span><span class=o>]</span> <span class=n>xPos</span><span class=o>[</span><span class=mi>58</span><span class=o>]</span> <span class=n>yPos</span><span class=o>[</span><span class=mi>55</span><span class=o>]</span> <span class=n>dim</span><span class=o>[</span><span class=mi>93</span><span class=o>]</span>
<span class=p>,</span> <span class=kd>class</span> <span class=nc>Squarecolor</span><span class=o>[</span><span class=n>RED</span><span class=o>]</span> <span class=n>xPos</span><span class=o>[</span><span class=mi>61</span><span class=o>]</span> <span class=n>yPos</span><span class=o>[</span><span class=mi>61</span><span class=o>]</span> <span class=n>dim</span><span class=o>[</span><span class=mi>29</span><span class=o>]</span>
<span class=p>,</span> <span class=kd>class</span> <span class=nc>Linecolor</span><span class=o>[</span><span class=n>GREEN</span><span class=o>]</span> <span class=n>xPos</span><span class=o>[</span><span class=mi>68</span><span class=o>]</span> <span class=n>yPos</span><span class=o>[</span><span class=mi>0</span><span class=o>]</span> <span class=n>dim</span><span class=o>[</span><span class=mi>22</span><span class=o>]</span>
<span class=p>,</span> <span class=kd>class</span> <span class=nc>Circlecolor</span><span class=o>[</span><span class=n>RED</span><span class=o>]</span> <span class=n>xPos</span><span class=o>[</span><span class=mi>7</span><span class=o>]</span> <span class=n>yPos</span><span class=o>[</span><span class=mi>88</span><span class=o>]</span> <span class=n>dim</span><span class=o>[</span><span class=mi>28</span><span class=o>]</span>
<span class=p>,</span> <span class=kd>class</span> <span class=nc>Squarecolor</span><span class=o>[</span><span class=n>RED</span><span class=o>]</span> <span class=n>xPos</span><span class=o>[</span><span class=mi>51</span><span class=o>]</span> <span class=n>yPos</span><span class=o>[</span><span class=mi>89</span><span class=o>]</span> <span class=n>dim</span><span class=o>[</span><span class=mi>9</span><span class=o>]</span>
<span class=p>,</span> <span class=kd>class</span> <span class=nc>Linecolor</span><span class=o>[</span><span class=n>GREEN</span><span class=o>]</span> <span class=n>xPos</span><span class=o>[</span><span class=mi>78</span><span class=o>]</span> <span class=n>yPos</span><span class=o>[</span><span class=mi>98</span><span class=o>]</span> <span class=n>dim</span><span class=o>[</span><span class=mi>61</span><span class=o>]</span>
<span class=p>,</span> <span class=kd>class</span> <span class=nc>Circlecolor</span><span class=o>[</span><span class=n>RED</span><span class=o>]</span> <span class=n>xPos</span><span class=o>[</span><span class=mi>20</span><span class=o>]</span> <span class=n>yPos</span><span class=o>[</span><span class=mi>58</span><span class=o>]</span> <span class=n>dim</span><span class=o>[</span><span class=mi>16</span><span class=o>]</span>
<span class=p>,</span> <span class=kd>class</span> <span class=nc>Squarecolor</span><span class=o>[</span><span class=n>RED</span><span class=o>]</span> <span class=n>xPos</span><span class=o>[</span><span class=mi>40</span><span class=o>]</span> <span class=n>yPos</span><span class=o>[</span><span class=mi>11</span><span class=o>]</span> <span class=n>dim</span><span class=o>[</span><span class=mi>22</span><span class=o>]</span>
<span class=p>,</span> <span class=kd>class</span> <span class=nc>Linecolor</span><span class=o>[</span><span class=n>GREEN</span><span class=o>]</span> <span class=n>xPos</span><span class=o>[</span><span class=mi>4</span><span class=o>]</span> <span class=n>yPos</span><span class=o>[</span><span class=mi>83</span><span class=o>]</span> <span class=n>dim</span><span class=o>[</span><span class=mi>6</span><span class=o>]</span>
<span class=p>,</span> <span class=kd>class</span> <span class=nc>Circlecolor</span><span class=o>[</span><span class=n>RED</span><span class=o>]</span> <span class=n>xPos</span><span class=o>[</span><span class=mi>75</span><span class=o>]</span> <span class=n>yPos</span><span class=o>[</span><span class=mi>10</span><span class=o>]</span> <span class=n>dim</span><span class=o>[</span><span class=mi>42</span><span class=o>]</span>
<span class=o>]</span>
</code></pre></div> <p>可以看到，xPos，yPos 以及 dim 的值都被成功地保存和恢复了，但是对 static 信息的读取却出现了问题。所有读回的颜色应该都是“3”，但是真实情况却并非如此。Circle 的值为 1（定义为 RED），而 Square 的值为 0（记住，它们是在构造器中被初始化的）。看上去似乎 static 数据根本没有被序列化！确实如此——尽管 Class 类是 Serializable 的，但它却不能按我们所期望的方式运行。所以假如想序列化 static 值，必须自己动手去实现。</p> <p>这正是 Line 中的 serializeStaticState() 和 deserializeStaticState() 两个 static 方法的用途。可以看到，它们是作为存储和读取过程的一部分被显式地调用的。（注意必须维护写入序列化文件和从该文件中读回的顺序。）因此，为了使 CADStatejava 正确运转起来，你必须：</p> <ol> <li>为几何形状添加 serializeStaticState() 和 deserializeStaticState()</li> <li>移除 ArrayList shapeTypes 以及与之有关的所有代码。</li> <li>在几何形状内添加对新的序列化和反序列化还原静态方法的调用。</li> </ol> <p>另一个要注意的问题是安全，因为序列化也会将 private 数据保存下来。如果你关心安全问题，那么应将其标记成 transient，但是这之后，还必须设计一种安全的保存信息的方法，以便在执行恢复时可以复位那些 private 变量。</p> <h2 id=xml>XML<a class=headerlink href=#xml title="Permanent link">#</a></h2> <p>对象序列化的一个重要限制是它只是 Java 的解决方案：只有 Java 程序才能反序列化这种对象。一种更具互操作性的解决方案是将数据转换为 XML 格式，这可以使其被各种各样的平台和语言使用。</p> <p>因为 XML 十分流行，所以用它来编程时的各种选择不胜枚举，包括随 JDK 发布的 javax.xml.*类库。我选择使用 Elliotte Rusty Harold 的开源 XOM 类库（可从 <a href=http://www.xom.nu>www.xom.nu</a> 下载并获得文档），因为它看起来最简单，同时也是最直观的用 Java 产生和修改 XML 的方式。另外，XOM 还强调了 XML 的正确性。</p> <p>作为一个示例，假设有一个 APerson 对象，它包含姓和名，你想将它们序列化到 XML 中。下面的 APerson 类有一个 getXML() 方法，它使用 XOM 来产生被转换为 XML 的 Element 对象的 APerson 数据；还有一个构造器，接受 Element 并从中抽取恰当的 APerson 数据（注意，XML 示例都在它们自己的子目录中）：</p> <div class=highlight><pre><span></span><code><span class=c1>// serialization/APerson.java</span>
<span class=c1>// Use the XOM library to write and read XML</span>
<span class=c1>// nu.xom.Node comes from http://www.xom.nu</span>
<span class=kn>import</span> <span class=nn>nu.xom.*</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>java.io.*</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>java.util.*</span><span class=p>;</span>
<span class=kd>public</span> <span class=kd>class</span> <span class=nc>APerson</span> <span class=p>{</span>
    <span class=kd>private</span> <span class=n>String</span> <span class=n>first</span><span class=p>,</span> <span class=n>last</span><span class=p>;</span>
    <span class=kd>public</span> <span class=nf>APerson</span><span class=p>(</span><span class=n>String</span> <span class=n>first</span><span class=p>,</span> <span class=n>String</span> <span class=n>last</span><span class=p>)</span> <span class=p>{</span>
        <span class=k>this</span><span class=p>.</span><span class=na>first</span> <span class=o>=</span> <span class=n>first</span><span class=p>;</span>
        <span class=k>this</span><span class=p>.</span><span class=na>last</span> <span class=o>=</span> <span class=n>last</span><span class=p>;</span>
    <span class=p>}</span>
    <span class=c1>// Produce an XML Element from this APerson object:</span>
    <span class=kd>public</span> <span class=n>Element</span> <span class=nf>getXML</span><span class=p>()</span> <span class=p>{</span>
        <span class=n>Element</span> <span class=n>person</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Element</span><span class=p>(</span><span class=s>&quot;person&quot;</span><span class=p>);</span>
        <span class=n>Element</span> <span class=n>firstName</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Element</span><span class=p>(</span><span class=s>&quot;first&quot;</span><span class=p>);</span>
        <span class=n>firstName</span><span class=p>.</span><span class=na>appendChild</span><span class=p>(</span><span class=n>first</span><span class=p>);</span>
        <span class=n>Element</span> <span class=n>lastName</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Element</span><span class=p>(</span><span class=s>&quot;last&quot;</span><span class=p>);</span>
        <span class=n>lastName</span><span class=p>.</span><span class=na>appendChild</span><span class=p>(</span><span class=n>last</span><span class=p>);</span>
        <span class=n>person</span><span class=p>.</span><span class=na>appendChild</span><span class=p>(</span><span class=n>firstName</span><span class=p>);</span>
        <span class=n>person</span><span class=p>.</span><span class=na>appendChild</span><span class=p>(</span><span class=n>lastName</span><span class=p>);</span>
        <span class=k>return</span> <span class=n>person</span><span class=p>;</span>
    <span class=p>}</span>
    <span class=c1>// Constructor restores a APerson from XML:</span>
    <span class=kd>public</span> <span class=nf>APerson</span><span class=p>(</span><span class=n>Element</span> <span class=n>person</span><span class=p>)</span> <span class=p>{</span>
        <span class=n>first</span> <span class=o>=</span> <span class=n>person</span>
                <span class=p>.</span><span class=na>getFirstChildElement</span><span class=p>(</span><span class=s>&quot;first&quot;</span><span class=p>).</span><span class=na>getValue</span><span class=p>();</span>
        <span class=n>last</span> <span class=o>=</span> <span class=n>person</span>
                <span class=p>.</span><span class=na>getFirstChildElement</span><span class=p>(</span><span class=s>&quot;last&quot;</span><span class=p>).</span><span class=na>getValue</span><span class=p>();</span>
    <span class=p>}</span>
    <span class=nd>@Override</span>
    <span class=kd>public</span> <span class=n>String</span> <span class=nf>toString</span><span class=p>()</span> <span class=p>{</span>
        <span class=k>return</span> <span class=n>first</span> <span class=o>+</span> <span class=s>&quot; &quot;</span> <span class=o>+</span> <span class=n>last</span><span class=p>;</span>
    <span class=p>}</span>
    <span class=c1>// Make it human-readable:</span>
    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span>
    <span class=nf>format</span><span class=p>(</span><span class=n>OutputStream</span> <span class=n>os</span><span class=p>,</span> <span class=n>Document</span> <span class=n>doc</span><span class=p>)</span>
            <span class=kd>throws</span> <span class=n>Exception</span> <span class=p>{</span>
        <span class=n>Serializer</span> <span class=n>serializer</span> <span class=o>=</span>
                <span class=k>new</span> <span class=n>Serializer</span><span class=p>(</span><span class=n>os</span><span class=p>,</span><span class=s>&quot;ISO-8859-1&quot;</span><span class=p>);</span>
        <span class=n>serializer</span><span class=p>.</span><span class=na>setIndent</span><span class=p>(</span><span class=mi>4</span><span class=p>);</span>
        <span class=n>serializer</span><span class=p>.</span><span class=na>setMaxLength</span><span class=p>(</span><span class=mi>60</span><span class=p>);</span>
        <span class=n>serializer</span><span class=p>.</span><span class=na>write</span><span class=p>(</span><span class=n>doc</span><span class=p>);</span>
        <span class=n>serializer</span><span class=p>.</span><span class=na>flush</span><span class=p>();</span>
    <span class=p>}</span>
    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=p>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=p>)</span> <span class=kd>throws</span> <span class=n>Exception</span> <span class=p>{</span>
        <span class=n>List</span><span class=o>&lt;</span><span class=n>APerson</span><span class=o>&gt;</span> <span class=n>people</span> <span class=o>=</span> <span class=n>Arrays</span><span class=p>.</span><span class=na>asList</span><span class=p>(</span>
                <span class=k>new</span> <span class=n>APerson</span><span class=p>(</span><span class=s>&quot;Dr. Bunsen&quot;</span><span class=p>,</span> <span class=s>&quot;Honeydew&quot;</span><span class=p>),</span>
                <span class=k>new</span> <span class=n>APerson</span><span class=p>(</span><span class=s>&quot;Gonzo&quot;</span><span class=p>,</span> <span class=s>&quot;The Great&quot;</span><span class=p>),</span>
                <span class=k>new</span> <span class=n>APerson</span><span class=p>(</span><span class=s>&quot;Phillip J.&quot;</span><span class=p>,</span> <span class=s>&quot;Fry&quot;</span><span class=p>));</span>
        <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>people</span><span class=p>);</span>
        <span class=n>Element</span> <span class=n>root</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Element</span><span class=p>(</span><span class=s>&quot;people&quot;</span><span class=p>);</span>
        <span class=k>for</span><span class=p>(</span><span class=n>APerson</span> <span class=n>p</span> <span class=p>:</span> <span class=n>people</span><span class=p>)</span>
            <span class=n>root</span><span class=p>.</span><span class=na>appendChild</span><span class=p>(</span><span class=n>p</span><span class=p>.</span><span class=na>getXML</span><span class=p>());</span>
        <span class=n>Document</span> <span class=n>doc</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Document</span><span class=p>(</span><span class=n>root</span><span class=p>);</span>
        <span class=n>format</span><span class=p>(</span><span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>,</span> <span class=n>doc</span><span class=p>);</span>
        <span class=n>format</span><span class=p>(</span><span class=k>new</span> <span class=n>BufferedOutputStream</span><span class=p>(</span>
                <span class=k>new</span> <span class=n>FileOutputStream</span><span class=p>(</span><span class=s>&quot;People.xml&quot;</span><span class=p>)),</span> <span class=n>doc</span><span class=p>);</span>
    <span class=p>}</span>
<span class=p>}</span>
</code></pre></div> <p>输出为：</p> <div class=highlight><pre><span></span><code>[Dr. Bunsen Honeydew, Gonzo The Great, Phillip J. Fry]
<span class=cp>&lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt;</span>
<span class=nt>&lt;people&gt;</span>
    <span class=nt>&lt;person&gt;</span>
        <span class=nt>&lt;first&gt;</span>Dr. Bunsen<span class=nt>&lt;/first&gt;</span>
        <span class=nt>&lt;last&gt;</span>Honeydew<span class=nt>&lt;/last&gt;</span>
    <span class=nt>&lt;/person&gt;</span>
    <span class=nt>&lt;person&gt;</span>
        <span class=nt>&lt;first&gt;</span>Gonzo<span class=nt>&lt;/first&gt;</span>
        <span class=nt>&lt;last&gt;</span>The Great<span class=nt>&lt;/last&gt;</span>
    <span class=nt>&lt;/person&gt;</span>
    <span class=nt>&lt;person&gt;</span>
        <span class=nt>&lt;first&gt;</span>Phillip J.<span class=nt>&lt;/first&gt;</span>
        <span class=nt>&lt;last&gt;</span>Fry<span class=nt>&lt;/last&gt;</span>
    <span class=nt>&lt;/person&gt;</span>
<span class=nt>&lt;/people&gt;</span>
</code></pre></div> <p>XOM 的方法都具有相当的自解释性，可以在 XOM 文档中找到它们。XOM 还包含一个 Serializer 类，你可以在 format() 方法中看到它被用来将 XML 转换为更具可读性的格式。如果只调用 toXML()，那么所有东西都会混在一起，因此 Serializer 是一种便利工具。</p> <p>从 XML 文件中反序列化 Person 对象也很简单：</p> <div class=highlight><pre><span></span><code><span class=c1>// serialization/People.java</span>
<span class=c1>// nu.xom.Node comes from http://www.xom.nu</span>
<span class=c1>// {RunFirst: APerson}</span>
<span class=kn>import</span> <span class=nn>nu.xom.*</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>java.io.File</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>java.util.*</span><span class=p>;</span>
<span class=kd>public</span> <span class=kd>class</span> <span class=nc>People</span> <span class=kd>extends</span> <span class=n>ArrayList</span><span class=o>&lt;</span><span class=n>APerson</span><span class=o>&gt;</span> <span class=p>{</span>
    <span class=kd>public</span> <span class=nf>People</span><span class=p>(</span><span class=n>String</span> <span class=n>fileName</span><span class=p>)</span> <span class=kd>throws</span> <span class=n>Exception</span> <span class=p>{</span>
        <span class=n>Document</span> <span class=n>doc</span> <span class=o>=</span>
                <span class=k>new</span> <span class=n>Builder</span><span class=p>().</span><span class=na>build</span><span class=p>(</span><span class=k>new</span> <span class=n>File</span><span class=p>(</span><span class=n>fileName</span><span class=p>));</span>
        <span class=n>Elements</span> <span class=n>elements</span> <span class=o>=</span>
                <span class=n>doc</span><span class=p>.</span><span class=na>getRootElement</span><span class=p>().</span><span class=na>getChildElements</span><span class=p>();</span>
        <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>elements</span><span class=p>.</span><span class=na>size</span><span class=p>();</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span>
            <span class=n>add</span><span class=p>(</span><span class=k>new</span> <span class=n>APerson</span><span class=p>(</span><span class=n>elements</span><span class=p>.</span><span class=na>get</span><span class=p>(</span><span class=n>i</span><span class=p>)));</span>
    <span class=p>}</span>
    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=p>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=p>)</span> <span class=kd>throws</span> <span class=n>Exception</span> <span class=p>{</span>
        <span class=n>People</span> <span class=n>p</span> <span class=o>=</span> <span class=k>new</span> <span class=n>People</span><span class=p>(</span><span class=s>&quot;People.xml&quot;</span><span class=p>);</span>
        <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>p</span><span class=p>);</span>
    <span class=p>}</span>
<span class=p>}</span>
<span class=cm>/* Output:</span>
<span class=cm>[Dr. Bunsen Honeydew, Gonzo The Great, Phillip J. Fry]</span>
<span class=cm>*/</span>
</code></pre></div> <p>People 构造器使用 XOM 的 Builder.build() 方法打开并读取一个文件，而 getChildElements() 方法产生了一个 Elements 列表（不是标准的 Java List，只是一个拥有 size() 和 get() 方法的对象，因为 Harold 不想强制人们使用特定版本的 Java，但是仍旧希望使用类型安全的容器）。在这个列表中的每个 Element 都表示一个 Person 对象，因此它可以传递给第二个 Person 构造器。注意，这要求你提前知道 XML 文件的确切结构，但是这经常会有些问题。如果文件结构与你预期的结构不匹配，那么 XOM 将抛出异常。对你来说，如果你缺乏有关将来的 XML 结构的信息，那么就有可能会编写更复杂的代码去探测 XML 文档，而不是只对其做出假设。</p> <p>为了获取这些示例去编译它们，你必须将 XOM 发布包中的 JAR 文件放置到你的类路径中。</p> <p>这里只给出了用 Java 和 XOM 类库进行 XML 编程的简介，更详细的信息可以浏览 <a href=http://www.xom.nu>www.xom.nu</a> 。</p> <!-- 分页 --> <div style="page-break-after: always;"></div> </article> </div> </div> </main> <footer class=md-footer> <div class=md-footer-nav> <nav class="md-footer-nav__inner md-grid"> <a href=../Appendix-New-IO/ title="Appendix New IO" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel=prev> <div class="md-flex__cell md-flex__cell--shrink"> <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i> </div> <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"> <span class=md-flex__ellipsis> <span class=md-footer-nav__direction> 上一页 </span> Appendix New IO </span> </div> </a> <a href=../Appendix-Passing-and-Returning-Objects/ title="Appendix Passing and Returning Objects" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel=next> <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"> <span class=md-flex__ellipsis> <span class=md-footer-nav__direction> 下一页 </span> Appendix Passing and Returning Objects </span> </div> <div class="md-flex__cell md-flex__cell--shrink"> <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i> </div> </a> </nav> </div> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-copyright> powered by <a href=https://www.mkdocs.org target=_blank rel=noopener>MkDocs</a> and <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs</a> </div> <div class=md-footer-social> <link rel=stylesheet href=../../../../../assets/fonts/font-awesome.css> <a href=https://leay.net target=_blank rel=noopener title=home class="md-footer-social__link fa fa-home"></a> <a href=https://github.com/hqweay target=_blank rel=noopener title=github class="md-footer-social__link fa fa-github"></a> </div> </div> </div> </footer> </div> <script src=../../../../../assets/javascripts/application.c33a9706.js></script> <script src=../../../../../assets/javascripts/lunr/lunr.stemmer.support.js></script> <script src=../../../../../assets/javascripts/lunr/tinyseg.js></script> <script src=../../../../../assets/javascripts/lunr/lunr.ja.js></script> <script src=../../../../../assets/javascripts/lunr/lunr.multi.js></script> <script>app.initialize({version:"1.1",url:{base:"../../../../.."}})</script> </body> </html>